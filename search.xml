<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AWS - AMIs 授權給其他帳號</title>
    <url>/blog.github.io/2022/08/05/AWS-AMIs%E6%8E%88%E6%AC%8A%E7%B5%A6%E5%85%B6%E4%BB%96%E5%B8%B3%E8%99%9F/</url>
    <content><![CDATA[
“把原帳號的 AMIs 授權給新帳號，分享 Images 給新帳號使用”
AWS 控制台選擇AMIs &gt; 點選 Modify Image Permissions   
輸入 新帳號的 Account Id &gt;&gt; Add Permission &gt;&gt; 下面的勾勾打勾 &gt; save   
再到新帳號的 AWS 控制台 &gt;&gt; EC2 &gt;&gt; AMIs &gt;&gt; private images 即可看到剛剛授權的 AMIs   
   官方文件

]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - Codecommit SSH 金鑰上傳及設置</title>
    <url>/blog.github.io/2022/09/30/AWS-Codecommit-SSH%E9%87%91%E9%91%B0%E4%B8%8A%E5%82%B3%E5%8F%8A%E8%A8%AD%E7%BD%AE/</url>
    <content><![CDATA[
“建立 AWS CodeCommit SSH KEY 來管理 Source Code”
先到個人帳號家目錄下的.ssh 製作金鑰   
   製作完後會有兩支檔案   
   製作完後將id_rsa.pub 上傳至AWS-IAM個人帳號   
   上傳後會得到SSH密鑰 ID將ID複製下來   
   再回到機器帳號跟目錄下的.ssh編輯金鑰設定檔vim config    Host git-codecommit.ap-northeast-2.amazonaws.com &lt; --只需要地區，目錄不用    User SSH密鑰 ID    IdentityFile ~/.ssh/id_rsa &lt;--私鑰檔案路徑

   
Codecommit 的位置取得   
新增完成後將檔案權限改為 600chmod 600 config

   
完成設定
]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - 如何將 AMI 轉出地區 &amp; 帳號</title>
    <url>/blog.github.io/2022/09/08/AWS-EC2-ami%E8%BD%89%E5%9C%B0%E5%8D%80%E5%8F%8A%E5%B8%B3%E8%99%9F/</url>
    <content><![CDATA[
“紀錄一下如何將 AMI 轉出到其他帳號”
在 ec2 頁面 → 底下 AMI 找到 Actions 點選 copy AMI   

在Destination region 選擇要移轉的地區   

在 Pemissions 底下按 edit   
   

在AWS Account Number 輸入要移轉的帳號   


]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - Cloudfront CDN 快取清除</title>
    <url>/blog.github.io/2022/09/08/AWS-Cloudfront-CDN%E5%BF%AB%E5%8F%96%E6%B8%85%E9%99%A4/</url>
    <content><![CDATA[
“紀錄一下如何清除 Cloudfront CDN Cache”
到 AWS-Cloudfront 後台 選取要清除暫存的 SITE   
選取 Invalidations   
“ &#x2F;* “ 表示清除所有 再點選Create invalidation即可   

]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - EC2 mysql-slave 跟隨 RDS</title>
    <url>/blog.github.io/2022/09/08/AWS-EC2-mysql-slave%E8%B7%9F%E9%9A%A8RDS%E6%95%99%E5%AD%B8/</url>
    <content><![CDATA[
“紀錄一下 EC2 使用 Mysql 跟隨 RDS 的語法”
CALL mysql.rds_set_configuration(&#x27;binlog retention hours&#x27;, 12);    show master status\G;    CALL mysql.rds_stop_replication;show slave status\G;    mysql -e &quot;show databases;&quot; -uroot -p -hRDS-master連結位置 | grep -Ev &quot;Database|XXX_mariadb|information_schema|innodb|mysql|performance_schema&quot; | xargs mysqldump -uroot -p -hRDS-master連結位置 --databases &gt; db.sql     mysqldump -uroot -p mysql rds_configuration rds_global_status_history rds_global_status_history_old rds_heartbeat2 rds_history rds_replication_status rds_sysinfo slow_log_template &gt; RDS_mysql.sql    rm -f /var/lib/mysql/mysql/rds*rm -f [大寫英文字母開頭的目錄] [白字檔]mysqld_save&amp;    mysql -uking -p &lt; db.sql    mysql -uking -p mysql &lt; RDS_mysql.sql    CHANGE MASTER TO MASTER_HOST=&#x27;RDS-master連結位置&#x27;, MASTER_USER=&#x27;主從帳號&#x27;, MASTER_PASSWORD=&#x27;主從密碼&#x27;;  ----跟隨RDS-masterCHANGE MASTER TO MASTER_LOG_FILE: &#x27;bin-log檔名&#x27;,MASTER_LOG_POS:進度;start slave;show slave status\G;

]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - How to enable MFA for AWS Root user</title>
    <url>/blog.github.io/2022/08/05/AWS-How-to-enable-MFA-for-AWS-Root-user/</url>
    <content><![CDATA[
“建立 MFA 二階段驗證來做 root 登入”
設置 AWS-MFA - 二階段認證 Authy搜尋 IAM 服務

選擇 Add MFA 添加 MFA

在選單 Multi-factor authentication (MFA) 中新增設備 Assign MFA device

選擇要驗證MFA的方式 ( 這邊選擇使用APP )

點擊 show QR code 並使用手機APP (Authy) 掃描驗證 &amp; 並將驗證碼依序填入 MFA code1 , MFA code2

添加成功


]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - VPC 建置</title>
    <url>/blog.github.io/2022/08/05/AWS-VPC%E5%BB%BA%E7%BD%AE/</url>
    <content><![CDATA[
“紀錄一下建立 VPC 的流程”
1. 建立 VPC點選 Create VPC   
   輸入名稱及網段 , 這邊設置為 172.25.0.0&#x2F;16   
   2. 新增4個subnets (2個Public、2個private)用途:預防AZ出現故障無法切換點選 Create subnet   
   確認 CIDR 為目前設置網段 &amp;&amp; 遮罩為 &#x2F;16   
   建立 public-a 為 172.25.1.0&#x2F;24   
   建立 public-c 為 172.25.2.0&#x2F;24   
   建立 private-a 為 172.25.3.0&#x2F;24   
   建立 private-c 為 172.25.4.0&#x2F;24   
 3. 新增Internet gateways，並將IGW掛上VPC新增Internet gateways (此步驟要先做完，才能新增 NAT GW)   
   輸入名稱 &gt; Create internet gateway   
   選取剛剛建立的 internet gateway 右鍵點選 attach   
   選擇剛剛建立好的 VPC   
   4.新增NAT gateways，選擇Public subnet，並給一個外網IP新增 NAT Gateways   
   設定名稱,subnet,Elastic IP 點選 Create   
   5.新增2個route table，1個叫igw、1個叫nat新增 route table   
   建立1個 route for NAT gateway   
   點選剛剛建立的 private-route-nat 設定 route 規則   
   設定 NAT - route 目的為全通   
   建立1個 route for Internet gateway   
   點選剛剛建立的 public-route-igw 設定 route 規則   
   設定 IGW - route 目的為全通   
   6.subnets 套用route talbe，Public套用igw，private套用nat回到 subnet 選擇 public-a 點選設置 route table   
   public-a 套用 public-route-igw 規則   
   回到 subnet 選擇 public-c 點選設置 route table   
   public-c 套用 public-route-igw 規則   
   回到 subnet 選擇 pricate-a 點選設置 route table   
   private-a 套用 private-route-nat 規則   
   回到 subnet 選擇 pricate-c 點選設置 route table   
   private-c 套用 private-route-nat 規則   
   VPC 設置完成

]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - LC 替換及設置 Auto-Scaling</title>
    <url>/blog.github.io/2022/09/08/AWS-LC%E5%BB%BA%E7%BD%AE%E5%8F%8A%E8%A8%AD%E7%BD%AEAuto-Scaling/</url>
    <content><![CDATA[

將要自動擴展的 EC2 做 SnapShot




用快照建立 AMI




建完 AMI 後 , 到 LC 介面去 COPY 一份配置檔注意 security Group 配置






最後到 Auto Scaling Group 替換剛建置好的 LC






]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - Use update-ip-set to block based IP address for WAF</title>
    <url>/blog.github.io/2022/09/08/AWS-update-ip-set-to-block-based-IP-address-for-WAF/</url>
    <content><![CDATA[
“建立 ip-set 封鎖 IP ，並上傳至 WAF”
獲取  操作WAF  規則的  Token對 WAF 進行操作時 , 需要有一個 Token 以防止衝突的請求 
/usr/bin/aws waf get-change-token|jq -r &#x27;.ChangeToken&#x27;


這時會返回可操作 WAF規則的 TOKEN (可將這串亂碼存成變數 $Token)
$Token: c93e119c-607e-43b5-98e3-66d3XXXXXXX

AWS 後台 WAF 規則中找到  IP address ID 並取得該 ID 
可將這串亂碼存成變數 $addressID
$addressID: XXXXXXXXX791cd453-01ba-46ed-8863

將要封鎖的 IP 上傳至該 WAF 規則中 ::/usr/bin/aws waf update-ip-set --ip-set-id  $addressID  --change-token $Token --updates Action=&quot;INSERT&quot;,IPSetDescriptor=&#x27;&#123;Type=&quot;IPV4&quot;,Value=&quot; XX.XX.XX.XX/32&quot;&#125;&#x27;


參考: https://docs.aws.amazon.com/cli/latest/reference/waf/update-ip-set.html

]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - WAF &amp; Rules 建置</title>
    <url>/blog.github.io/2022/09/08/AWS-%E6%B7%BB%E5%8A%A0Rules%E4%B8%A6%E6%8E%9B%E9%80%B2WAF%E4%B8%AD/</url>
    <content><![CDATA[
“建立 AWS-WAF 封鎖 IP 的規則政策”
封鎖規則設置建立 IP match conditions
 
輸入名稱 , 區域 , 要封鎖的 IP
   
建立 Rules
 
輸入名稱 , 規則 , 掛進剛建立的 IP match conditions
 
編輯 Web ACL  將剛建立的 Rules 掛入
  

Web ACL 建置點選 Create web ACL 區域選 Global CloudFront 
 輸入名稱 , Cloudwatch metric 名稱 (這兩個名稱之後無法更改) 

選擇該 WAF 政策 

選擇該 WAF 規則  

點選建立 


]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - 下載 aws-cli &amp;&amp; aws configure 設定</title>
    <url>/blog.github.io/2022/08/05/AWS-%E8%A8%AD%E7%BD%AEaws-cli/</url>
    <content><![CDATA[
“使用 AWS comaand 工具 ‘aws-cli’ 與設定 ‘aws configure’ “
AWS CLI 安裝及更新[ 官網: https://docs.aws.amazon.com/zh_tw/cli/latest/userguide/getting-started-install.html ]
curl &quot;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip&quot; -o &quot;awscliv2.zip&quot;unzip awscliv2.zipsudo ./aws/installaws --version


AWS CONFIGURE 設定檔設定需要先建立 IAM USER 並 create access key
設定步驟: ( IAM download accesskey.csv )AWS Access Key ID [None]: XXXXXXXXXXXXXXXXXXX    AWS Secret Access Key [None]: XXXXXXXXXXXXXXXXXXX    Default region name [None]: ap-northeast-1    Default output format [None]: 


設定檔路徑 :cat ~/.aws/credentials[default]    aws_access_key_id=XXXXXXXXXXXXXXXXXXXXXXXXXXX    aws_secret_access_key=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX


cat ~/.aws/config[default]    region=us-west-2    output=json


AWS 憑證原理:
當您使用指定 AWS Identity and Access Management (IAM) 角色的共用設定檔時，
AWS CLI 會呼叫 AWS STS AssumeRole 操作來擷取臨時憑證。然後會存放這些憑證 (在 ~&#x2F;.aws&#x2F;cli&#x2F;cache 中)。
後續的 AWS CLI 命令會使用快取的臨時憑證，直到過期為止，此時 AWS CLI 會自動重新整理憑證

]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - 撈出 RDS 的 binlog</title>
    <url>/blog.github.io/2022/08/05/AWS-%E6%92%88%E5%87%BARDS%E7%9A%84binlog/</url>
    <content><![CDATA[
“紀錄一下使用 mysql 工具 撈出 RDS 的 binlog”
撈出 RDS binlog
cd /home/mariadb/binlogmysqlbinlog --base64-output=decode-rows -v --set-charset=&quot;utf8&quot; --start-datetime=&quot;2021-11-04 14:06:00&quot; --stop-datetime=&quot;2021-11-04 14:09:00&quot;   mysql-bin-changelog.450599 &gt; /home/laurance/RDS-1104-1405-1410.sql

傳至其他機器
scp RDS-1005-1330-1430.sql laurance@admin:~ 



]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - 變更 Management Console 的語言</title>
    <url>/blog.github.io/2022/09/08/AWS-%E8%AE%8A%E6%9B%B4Management-Console%E7%9A%84%E8%AA%9E%E8%A8%80/</url>
    <content><![CDATA[
“紀錄一下如何更改 AWS 預設語言”
登入 AWS Management Console在導覽列上選擇您的帳戶名稱選擇 Settings (設定)，開啟 Unified Settings (統一設定) 頁面   

在 Unified Settings (統一設定) 中，選擇位於 Localization and default Region (本地化和預設區域) 旁的 Edit (編輯)選取您想在主控台使用的語言，然後選擇 Save changes (儲存變更)   


]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - 連線至 windows-ec2</title>
    <url>/blog.github.io/2022/10/18/AWS-%E9%80%A3%E6%8E%A5%E8%87%B3windows-ec2/</url>
    <content><![CDATA[
“如何使用RDP協議遠端桌面連線至 EC2-Windows”
在新建立的 Instances 右鍵選擇 Connect   

選擇 RDP client 並點選 Get password   

選擇 Browse (瀏覽) 並選取製作 instance 的金鑰 (.pem) 並選擇 Decrypt Password (解密密碼)   

使用後台給的亂數密碼建立遠端桌面連線 (帳號預設都是 Administrator)   

   官方文件連結

]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache - 透過 apxs 添加 proxy 模块</title>
    <url>/blog.github.io/2022/12/03/Apache-%E9%80%8F%E9%81%8Eapxs%E6%B7%BB%E5%8A%A0proxy%E6%A8%A1%E5%9D%97/</url>
    <content><![CDATA[
必須內建了 mod_so 模塊，當初編譯時有編 –enable-so
查看所有模塊/usr/local/web/apache2/bin/httpd -l

   
進入proxy moudle 編碼目錄cd /root/dbmonitor-case/dbmonitor/httpd-2.2.27/modules/proxy````       ![](https://s2.loli.net/2024/04/25/PNzUeSEtFsqiZwR.png)   ## 使用apxs進行編譯安裝```sql/usr/local/web/apache2/bin/apxs -i -c -a mod_proxy.c proxy_util.c

   

]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Apache</tag>
        <tag>Rsyslog</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS - configure 設置</title>
    <url>/blog.github.io/2022/08/05/AWS-%E9%85%8D%E7%BD%AE%E9%87%91%E9%91%B0%E5%9C%A8linux%E7%99%BB%E5%85%A5/</url>
    <content><![CDATA[aws configureAWS Access Key ID [None]: XXXXXXXXXXXXXXXXXXXAWS Secret Access Key [None]: XXXXXXXXXXXXXXXXXXXDefault region name [None]: ap-northeast-1Default output format [None]: json




]]></content>
      <categories>
        <category>AWS</category>
      </categories>
      <tags>
        <tag>AWS</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache - 如何透過 rsyslog 服務同步寫 log</title>
    <url>/blog.github.io/2022/08/03/Apache-%E9%80%8F%E9%81%8Ersyslog%E5%90%8C%E6%AD%A5log/</url>
    <content><![CDATA[
“Apache 透過 rsyslog 同步寫 LOG 到其他台機器”
編輯 Apache 設定檔vim /etc/httpd/conf/httpd.conf


ErrorLogFormat &quot;[%{u}t] [%-m:%l] [pid %P:tid %T] %7F: %E: [client\ %a] %M% ,\ referer\ %{Referer}i&quot;
&lt;IfModule logio_module&gt;
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %O %I %T %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; nreporter
&lt;/IfModule&gt;
CustomLog &quot;logs/access-NReporter_log&quot; nreporter

重啟 Apache 服務和確認 Apache 服務狀態systemctl restart httpd &amp;&amp; systemctl status httpd
編輯 rsyslog 設定檔vim /etc/rsyslog.conf```               ###MODULES###    $ModLoad imfile # provides support for file logging    # Send Apache log to N-Reporter    input(type=&quot;imfile&quot; File=&quot;/var/log/httpd/access-NReporter_log&quot; Tag=&quot;apache&quot; Severity=&quot;info&quot; Facility=&quot;local6&quot;    Ruleset=&quot;nreporter&quot;)    input(type=&quot;imfile&quot; File=&quot;/var/log/httpd/error_log&quot; Tag=&quot;apache&quot; Severity=&quot;warning&quot; Facility=&quot;local6&quot;    Ruleset=&quot;nreporter&quot;)    ruleset(name=&quot;nreporter&quot;)&#123;action(type=&quot;omfwd&quot; Target=&quot;192.168.2.69&quot; Port=&quot;514&quot; Protocol=&quot;udp&quot;)&#125;## 重啟 Rsyslog 服務和確認 Rsyslog 服務正常    ```sqlsystemctl restart rsyslog &amp;&amp; systemctl status rsyslog



]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Apache</tag>
      </tags>
  </entry>
  <entry>
    <title>Cacti - 安裝方法</title>
    <url>/blog.github.io/2022/08/07/Cacti-%E5%AE%89%E8%A3%9D%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[
“紀錄一下建立 CACTI 語法，包含建立前置作業 LAMP”
rpm -qa | grep mariadbrpm -qa | grep mysql yum install mysql-community-server mysql-devel./configure --prefix=/usr/local/web/apache2 --enable-ssl --enable-so  --enable-vhost-alias  --with-mpm=prefork&#x27;./configure&#x27; &#x27;--prefix=/usr/local/web/php&#x27; &#x27;--with-apxs2=/usr/local/web/apache2/bin/apxs&#x27; &#x27;--with-mysql&#x27; &#x27;--with-mysqli&#x27; &#x27;--disable-cgi&#x27; &#x27;--with-iconv&#x27; &#x27;--disable-inline-optimization&#x27; &#x27;--enable-mbstring=tw&#x27; &#x27;--enable-sysvshm&#x27; &#x27;--enable-sysvsem&#x27; &#x27;--enable-sockets&#x27; &#x27;--with-jpeg-dir&#x27; &#x27;--with-png-dir&#x27; &#x27;--with-gd&#x27; &#x27;--with-zlib&#x27; &#x27;--with-curl&#x27; &#x27;--enable-zip&#x27; &#x27;--with-openssl-dir=/usr/lib/openssl&#x27; &#x27;--with-openssl&#x27; &#x27;--enable-opcache&#x27;tar zxvf cacti-0.8.7g.tar.gzmv cacti-0.8.7g /home/cactiyum install -y net-snmp  net-snmp-utilstar zxvf rrdtool-1.0.50.tar.gzcd rrdtool-1.0.50./configure --prefix=/usr/local/rrdtool makemake install#ln -s /usr/local/libpng/lib/libpng.so /usr/lib/ #ln -s /usr/local/freetype/lib/libfreetype.so /usr/lib/#yum -y install freetype-devel#yum -y install libpng-devel#yum -y install libart_lgpl-develmysqld_safe &amp; mysqladmin -u root password &#x27;密碼&#x27; mysqladmin --user=root -p create cacticd    /home/cacti/ mysql -u root -p cacti &lt; cacti.sql mysql    -u    root    -p mysql&gt; grant all on cacti.* to cactiuser@localhost identified by &#x27;123456&#x27;; mysql&gt; flush privileges; mysql&gt; exit vim /home/cacti/include/config.php   26 $database_type: &quot;mysql&quot;;   27 $database_default: &quot;cacti&quot;;   28 $database_hostname: &quot;localhost&quot;;   29 $database_username: &quot;cactiuser&quot;;   30 $database_password: &quot;kiwi888&quot;;   31 $database_port: &quot;3306&quot;;  useradd cactiusersu - cactiusercrontab -e*/1 * * * * /usr/local/bin/php  /home/cacti/poller.php &gt; /dev/null 2&gt;&amp;1exit

]]></content>
      <categories>
        <category>Cacti</category>
      </categories>
      <tags>
        <tag>Cacti</tag>
      </tags>
  </entry>
  <entry>
    <title>Cacti - 新增機器監控及圖表</title>
    <url>/blog.github.io/2022/09/14/Cacti-%E6%96%B0%E5%A2%9E%E6%A9%9F%E5%99%A8%E5%8F%8A%E5%9C%96%E8%A1%A8/</url>
    <content><![CDATA[
“如何將新建的 EC2 加入 Cacti 監控”
1. 新建機器上面先安裝SNMP，並確保火牆有通 UDP 161 portyum install -y net-snmp  net-snmp-utils

2. Cacti 頁面新增 Device &gt;&gt; Add   
   3. Device 填入機器的 hostname 及監控協議   
   4. Datasource 新增要撈取的資料   
   5. Graph Management 新增監控圖表   
   6. Graph Trees 分類圖表群   
   
]]></content>
      <categories>
        <category>Cacti</category>
      </categories>
      <tags>
        <tag>Cacti</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS - 如何將安裝包及其依賴包下載到本地</title>
    <url>/blog.github.io/2023/01/26/CentOS-%E5%A6%82%E4%BD%95%E5%B0%87%E5%AE%89%E8%A3%9D%E5%8C%85%E5%8F%8A%E5%85%B6%E4%BE%9D%E8%B3%B4%E5%8C%85%E4%B8%8B%E8%BC%89%E5%88%B0%E6%9C%AC%E5%9C%B0/</url>
    <content><![CDATA[
“紀錄一下 如何將 RPM依賴包 下載到本地保存”
通過 yum 命令的 Downloadonly 插件下載 RPM 軟件包及其所有依賴包安裝工具包yum install yum-plugin-downloadonly yum-utils -y
將 *.repo 安裝到指定目錄下yum install --downloadonly + --downloaddir=軟件包位置[可選] + 軟件包名(可加上版本號，指定版本)    yum install --downloadonly --downloaddir=/root/mysql517_repo/ mysql-server mysql-client mysql-devel*
 

]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS - 安装 speedtest-cli</title>
    <url>/blog.github.io/2022/08/03/CentOS-%E5%AE%89%E8%A3%85speedtest-cli/</url>
    <content><![CDATA[
“(紀錄一下 Centos 安装 speedtest-cli 網速測試)”
 wget https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.pyvim speedtest.py &gt;&gt; (第一行#改python3)chmod a+rx speedtest.pymv speedtest.py /usr/local/bin/speedtest-clichown root:root /usr/local/bin/speedtest-cli


命令後追加 –share 可以得到測試信息圖片speedtest-cli –share追加 –list 可以得到所有的測試服務器speedtest-cli –list使用 – server 測試指定服務器的下載或上傳速度speedtest-cli –server 41009 (站点ID可通過 –list 獲取)
]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS - 根目錄磁區擴充</title>
    <url>/blog.github.io/2022/08/03/CentOS-%E6%A0%B9%E7%9B%AE%E9%8C%84%E7%A3%81%E5%8D%80%E6%93%B4%E5%85%85/</url>
    <content><![CDATA[
“(將home磁區分割為50G並將其餘空間擴充到根目錄底下)”
安裝xfsdump工具yum install xfsdump -y



備份&#x2F;home磁區的掛載內容 (一路按ENTER)xfsdump -f /home.xfsdump /home

   
這時候會再跟目錄出現剛剛備份的 &#x2F;home &gt;&gt; home.xfsdump   
成功備份後，將&#x2F;home磁區移除掛載 (必須以root身分登入才能執行) umount /home
   
將&#x2F;home磁區大小定義為50Glvreduce -L 50G /dev/mapper/centos-home
   
將其餘空間擴充到根目錄底下lvextend -l +100%FREE /dev/mapper/centos-root

   
使根目錄擴充生效xfs_growfs /dev/mapper/centos-root
   
格式化&#x2F;home掛載對應的磁區mkfs.xfs -f /dev/mapper/centos-home
   
重新掛載&#x2F;homemount /home
   
將原本備份的內容寫入&#x2F;homexfsrestore -f /home.xfsdump /home
   
可以看倒已將磁區容量擴充   

]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS - 目錄沒顯示顏色</title>
    <url>/blog.github.io/2022/08/03/CentOS-%E7%9B%AE%E9%8C%84%E6%B2%92%E9%A1%AF%E7%A4%BA%E9%A1%8F%E8%89%B2/</url>
    <content><![CDATA[
“紀錄一下如何更改 Linux 系統目錄顏色”
語法:yum install coreutils --allowerasing &amp;&amp; or dnf install    scp DIR_COLORS root@172.17.0.2:~    mv DIR_COLORS ~/.dir_colors    reboot


]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS 6 - 修改 yum 源</title>
    <url>/blog.github.io/2022/08/03/CentOS6-%E4%BF%AE%E6%94%B9yum%E6%BA%90/</url>
    <content><![CDATA[
“使用 ‘sed’ 更改 ‘yum 源’ “
sed -i -e &quot;s/^mirrorlist=http:\/\/mirrorlist.centos.org/#mirrorlist=http:\/\/mirrorlist.centos.org/g&quot; /etc/yum.repos.d/CentOS-Base.reposed -i -e &quot;s/^#baseurl=http:\/\/mirror.centos.org/baseurl=http:\/\/vault.centos.org/g&quot; /etc/yum.repos.d/CentOS-Base.repo


]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS 6 - 安裝socks5代理</title>
    <url>/blog.github.io/2022/08/03/CentOS6-%E5%AE%89%E8%A3%9Dsocks5%E4%BB%A3%E7%90%86/</url>
    <content><![CDATA[
“紀錄一下 安裝 SS5代理 語法”
wget https://nchc.dl.sourceforge.net/project/ss5/ss5/3.8.9-8/ss5-3.8.9-8.tar.gz    yum -y install gcc automake makeyum -y install pam-devel openldap-devel cyrus-sasl-devel openssl-develtar xvf ss5-3.8.9-8.tar.gzcd ss5-3.8.9./configure &amp;&amp; make &amp;&amp; make install    vi /etc/opt/ss5/ss5.confauth    0.0.0.0/0               -              -permit -        0.0.0.0/0       -       0.0.0.0/0


加入用戶名及密碼 &#x2F;etc&#x2F;opt&#x2F;ss5&#x2F;ss5.passwd修改 ss5 啟動的 port ( 默認是 1080 )vi /etc/sysconfig/ss5    #SS5_OPTS=” -u root”    註解新增    SS5_OPTS=&quot; -u root -b 0.0.0.0:8080&quot;
給予 bash 檔增執行權限 &#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;ss5chmod 755 /etc/rc.d/init.d/ss5service ss5 start # 重啟



]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>Socket 5</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS 7 - 使用 certbot 半自動更新 SSL 憑證</title>
    <url>/blog.github.io/2022/12/10/CentOS7-%E4%BD%BF%E7%94%A8certbot%E5%8D%8A%E8%87%AA%E5%8B%95%E6%9B%B4%E6%96%B0SSL%E6%86%91%E8%AD%89/</url>
    <content><![CDATA[下載 certbot 腳本wget https://raw.githubusercontent.com/certbot/certbot/7f0fa18c570942238a7de73ed99945c3710408b4/letsencrypt-auto-source/letsencrypt-auto -O /root/certbot-auto




給予權限chmod 755 /root/certbot-auto



使用 certbot-auto 簽發三個月憑證(保護 domain 及 sub domain)./certbot-auto certonly -d “*.域名”-d “域名” --manual --preferred-challenges dns
(只保護 sub domain)./certbot-auto certonly -d *.域名 --manual --preferred-challenges dns



驗證解析nslookup -type=TXT _acme-challenge.XXXXX.net 8.8.8.8
驗證過後會有4隻pem 路徑: &#x2F;etc&#x2F;letsencrypt&#x2F;archive&#x2F;cp fullchain1.pem /usr/local/web/nginx/conf/key/las/XXXXX.net.crt    cp privkey1.pem /usr/local/web/nginx/conf/key/las/XXXXX.net.key



NGINX 重啟/usr/local/web/nginx/sbin/nginx  -t    /usr/local/web/nginx/sbin/nginx  -s reload

]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS 7 - 更改 Yum 源 (HiNet)</title>
    <url>/blog.github.io/2022/08/10/CentOS7-%E6%9B%B4%E6%94%B9Yum%E6%BA%90(HiNet)/</url>
    <content><![CDATA[
“Hinet yum源 紀錄”
# CentOS-Base.repo## The mirror system uses the connecting IP address of the client and the# update status of each mirror to pick mirrors that are updated to and# geographically close to the client. You should use this for CentOS updates# unless you are manually picking other mirrors.## If the mirrorlist= does not work for you, as a fall back you can try the # remarked out baseurl= line instead.##[base]name=CentOS-$releasever – Base#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=osbaseurl=http://mirror01.idc.hinet.net/CentOS/$releasever/os/$basearch/gpgcheck=1gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#released updates [updates]name=CentOS-$releasever – Updates#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updatesbaseurl=http://mirror01.idc.hinet.net/CentOS/$releasever/updates/$basearch/gpgcheck=1gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#additional packages that may be useful[extras]name=CentOS-$releasever – Extras#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extrasbaseurl=http://mirror01.idc.hinet.net/CentOS/$releasever/extras/$basearch/gpgcheck=1gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#additional packages that extend functionality of existing packages[centosplus]name=CentOS-$releasever – Plus#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplusbaseurl=http://mirror01.idc.hinet.net/CentOS/$releasever/centosplus/$basearch/gpgcheck=1enabled=0gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7#contrib – packages by Centos Users[contrib]name=CentOS-$releasever – Contrib#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=contribbaseurl=http://mirror01.idc.hinet.net/CentOS/$releasever/contrib/$basearch/gpgcheck=1enabled=0gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7



清理 yum 快取 &amp;&amp; 更新yum clean all

yum update -y


]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS - 更改系統語言</title>
    <url>/blog.github.io/2022/08/07/Centos-%E6%9B%B4%E6%94%B9%E7%B3%BB%E7%B5%B1%E8%AA%9E%E8%A8%80/</url>
    <content><![CDATA[
“如何更改 CentOS 系統語言”
更改系統引數
vim /etc/locale.conf		# CentOS 7
LANG=“zh_CN.UTF-8”
source  /etc/locale.conf

---

    
vim /etc/sysconfig/i18n	        # CentOS6
LANG=“zh_CN.UTF-8”
source /etc/sysconfig/i18n

重啟系統reboot


]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS 8 - 找不到源解決方式</title>
    <url>/blog.github.io/2022/08/19/CentOS8-%E6%89%BE%E4%B8%8D%E5%88%B0%E6%BA%90/</url>
    <content><![CDATA[dnf --disablerepo &#x27;*&#x27; --enablerepo=extras swap centos-linux-repos centos-stream-reposdnf distro-sync


]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS - 啟動網路時出現 bring up interface ip address is already in use for device eth0</title>
    <url>/blog.github.io/2022/10/07/Centos-%E5%95%9F%E5%8B%95%E7%B6%B2%E8%B7%AF%E6%99%82%E5%87%BA%E7%8F%BEbring-up-interface-ip-address-is-already-in-use-for-device-eth0/</url>
    <content><![CDATA[
“CentOS ERROR : bring up interface ip address is already in use for device eth0 解決方案”
重啟網路報錯Bringing up interface eth0:  Determining if ip address 172.16.0.224 is already in use for device eth0…加上 ARPCHECK&#x3D;no 重啟網路就好了vim /etc/sysconfig/network-scripts/ifcfg-eth0    DEVICE=eth0HWADDR=XX:XX:XX:XX:XX:XXTYPE=EthernetUUID=5248d5f6-7d7b-42ee-9443-e2f627c73677ONBOOT=yesNM_CONTROLLED=yesBOOTPROTO=staticIPADDR=172.16.0.224GATEWAY=172.16.0.1NETMASK=255.255.0.0DNS1=8.8.8.8DNS2=9.9.9.9ARPCHECK=no

]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
      </tags>
  </entry>
  <entry>
    <title>DNS_SERVER - MyDNS 服務器的可視化管理 by CentOS6</title>
    <url>/blog.github.io/2022/12/30/DNS-MyDNS%E6%9C%8D%E5%8B%99%E5%99%A8%E7%9A%84%E5%8F%AF%E8%A6%96%E5%8C%96%E7%AE%A1%E7%90%86-CentOS6/</url>
    <content><![CDATA[
“(MySQL -5.0.77 + Apache-2.2.27 + PHP-5.2.5 + MyDNSConfig-1.1.0 + mydns-1.2.8.31)”
安裝順序為 MySQL &gt; Apache &gt; PHP &gt; MyDNSConfig &gt; mydns安裝以下套件所需依賴包yum -y install gcc gcc-c++  make cmake automake autoconf kernel-devel ncurses-devel libxml2-devel openssl-devel curl-devel libjpeg-devel libpng-devel  pcre-devel libtool libtool-libs freetype-devel gd zlib-devel file bison patch mlocate flex diffutils   readline-devel glibc-devel glib2-devel bzip2-devel gettext-devel libcap-devel openldap openldap-devel libxslt-devel sqlite-devel  libevent libevent-devel



MySQL -5.0.77 :[MySQL官網安裝包] https://downloads.mysql.com/archives/community/
移除原本的版本 (否則會衝突)rpm -qa |grep mysqlrpm -e --nodeps mysql-libs-5.1.73-7.el6.x86_64

下載安裝包wget https://downloads.mysql.com/archives/get/p/23/file/MySQL-server-community-5.0.77-0.rhel5.x86_64.rpm    wget https://downloads.mysql.com/archives/get/p/23/file/MySQL-client-community-5.0.77-0.rhel5.x86_64.rpm    wget https://downloads.mysql.com/archives/get/p/23/file/MySQL-devel-community-5.0.77-0.rhel5.x86_64.rpm    wget https://downloads.mysql.com/archives/get/p/23/file/MySQL-shared-compat-5.0.77-0.rhel5.x86_64.rpm

解壓rpm -ivh MySQL-devel-community-5.0.77-0.rhel5.x86_64.rpm    rpm -ivh MySQL-shared-compat-5.0.77-0.rhel5.x86_64.rpm    rpm -ivh MySQL-server-community-5.0.77-0.rhel5.x86_64.rpm    rpm -ivh MySQL-client-community-5.0.77-0.rhel5.x86_64.rpm
查看版本mysql -V
啟動服務mysqld_safe &amp;

設置root密碼mysqladmin -u root password &#x27;123456&#x27;

在 MySQL 介面 : 建立使用者及權限mysql&gt;  GRANT all privileges ON mydns.* TO mydns@localhost IDENTIFIED BY &#x27;123456&#x27;;mysql&gt;  flush privileges;

在 MySQL 介面 : 建立database存放mydnsmysql&gt; create database mydns;


Apache-2.2.27 :下載依賴包wget http://archive.apache.org/dist/apr/apr-1.4.5.tar.gz      tar -zxf apr-1.4.5.tar.gz      cd  apr-1.4.5      ./configure --prefix=/usr/local/apr      make &amp;&amp; make install        ***   wget http://archive.apache.org/dist/apr/apr-util-1.3.12.tar.gz      tar -zxf apr-util-1.3.12.tar.gz      cd apr-util-1.3.12      ./configure --prefix=/usr/local/apr-util -with-apr=/usr/local/apr/bin/apr-1-config      make &amp;&amp; make install       ***   wget http://jaist.dl.sourceforge.net/project/pcre/pcre/8.10/pcre-8.10.zip      unzip -o pcre-8.10.zip      cd pcre-8.10      ./configure --prefix=/usr/local/pcre      make &amp;&amp; make install
解壓 Apachewget http://archive.apache.org/dist/httpd/httpd-2.2.27.tar.gztar zxvf httpd-2.2.27.tar.gz    cd httpd-2.2.27/    ./configure --prefix=/usr/local/web/apache2 --enable-ssl --enable-so  --enable-vhost-alias  --with-mpm=prefork --with-apr=/usr/local/apr/ --with-apr-util=/usr/local/apr-util/ --with-z --enable-proxy --enable-rewrite --with-pcre    make &amp;&amp; make install
查看版本/usr/local/web/apache2/bin/apachectl -v
更改 apache 主設定檔mv /usr/local/web/apache2/conf/httpd.conf /usr/local/web/apache2/conf/httpd.conf.bak    vim /usr/local/web/apache2/conf/httpd.conf


## This is the main Apache HTTP server configuration file.  It contains the# configuration directives that give the server its instructions.# See &lt;URL:http://httpd.apache.org/docs/2.2&gt; for detailed information.# In particular, see # &lt;URL:http://httpd.apache.org/docs/2.2/mod/directives.html&gt;# for a discussion of each configuration directive.## Do NOT simply read the instructions in here without understanding# what they do.  They&#x27;re here only as hints or reminders.  If you are unsure# consult the online docs. You have been warned.  ## Configuration and logfile names: If the filenames you specify for many# of the server&#x27;s control files begin with &quot;/&quot; (or &quot;drive:/&quot; for Win32), the# server will use that explicit path.  If the filenames do *not* begin# with &quot;/&quot;, the value of ServerRoot is prepended -- so &quot;logs/foo_log&quot;# with ServerRoot set to &quot;/usr/local/web/apache2&quot; will be interpreted by the# server as &quot;/usr/local/web/apache2/logs/foo_log&quot;.## ServerRoot: The top of the directory tree under which the server&#x27;s# configuration, error, and log files are kept.## Do not add a slash at the end of the directory path.  If you point# ServerRoot at a non-local disk, be sure to point the LockFile directive# at a local disk.  If you wish to share the same ServerRoot for multiple# httpd daemons, you will need to change at least LockFile and PidFile.#ServerRoot &quot;/usr/local/web/apache2&quot;## Listen: Allows you to bind Apache to specific IP addresses and/or# ports, instead of the default. See also the &lt;VirtualHost&gt;# directive.## Change this to Listen on specific IP addresses as shown below to # prevent Apache from glomming onto all bound IP addresses.##Listen 12.34.56.78:80Listen 80## Dynamic Shared Object (DSO) Support## To be able to use the functionality of a module which was built as a DSO you# have to place corresponding `LoadModule&#x27; lines at this location so the# directives contained in it are actually available _before_ they are used.# Statically compiled modules (those listed by `httpd -l&#x27;) do not need# to be loaded here.## Example:# LoadModule foo_module modules/mod_foo.soLoadModule php5_module        modules/libphp5.so#&lt;IfModule !mpm_netware_module&gt;&lt;IfModule !mpm_winnt_module&gt;## If you wish httpd to run as a different user or group, you must run# httpd as root initially and it will switch.  ## User/Group: The name (or #number) of the user/group to run httpd as.# It is usually good practice to create a dedicated user and group for# running httpd, as with most system services.#User daemonGroup daemon&lt;/IfModule&gt;&lt;/IfModule&gt;# &#x27;Main&#x27; server configuration## The directives in this section set up the values used by the &#x27;main&#x27;# server, which responds to any requests that aren&#x27;t handled by a# &lt;VirtualHost&gt; definition.  These values also provide defaults for# any &lt;VirtualHost&gt; containers you may define later in the file.## All of these directives may appear inside &lt;VirtualHost&gt; containers,# in which case these default settings will be overridden for the# virtual host being defined.### ServerAdmin: Your address, where problems with the server should be# e-mailed.  This address appears on some server-generated pages, such# as error documents.  e.g. admin@your-domain.com#ServerAdmin you@example.com## ServerName gives the name and port that the server uses to identify itself.# This can often be determined automatically, but we recommend you specify# it explicitly to prevent problems during startup.## If your host doesn&#x27;t have a registered DNS name, enter its IP address here.#ServerName www.example.com:80## DocumentRoot: The directory out of which you will serve your# documents. By default, all requests are taken from this directory, but# symbolic links and aliases may be used to point to other locations.#DocumentRoot &quot;/usr/local/web/apache2//htdocs&quot;## Each directory to which Apache has access can be configured with respect# to which services and features are allowed and/or disabled in that# directory (and its subdirectories). ## First, we configure the &quot;default&quot; to be a very restrictive set of # features.  #&lt;Directory /&gt;    Options FollowSymLinks    AllowOverride None    Order allow,deny    allow from all&lt;/Directory&gt;## Note that from this point forward you must specifically allow# particular features to be enabled - so if something&#x27;s not working as# you might expect, make sure that you have specifically enabled it# below.### This should be changed to whatever you set DocumentRoot to.#&lt;Directory &quot;/usr/local/web/apache2//htdocs&quot;&gt;    #    # Possible values for the Options directive are &quot;None&quot;, &quot;All&quot;,    # or any combination of:    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews    #    # Note that &quot;MultiViews&quot; must be named *explicitly* --- &quot;Options All&quot;    # doesn&#x27;t give it to you.    #    # The Options directive is both complicated and important.  Please see    # http://httpd.apache.org/docs/2.2/mod/core.html#options    # for more information.    #    Options Indexes FollowSymLinks    #    # AllowOverride controls what directives may be placed in .htaccess files.    # It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:    #   Options FileInfo AuthConfig Limit    #    AllowOverride None    #    # Controls who can get stuff from this server.    #    Order allow,deny    Allow from all&lt;/Directory&gt;## DirectoryIndex: sets the file that Apache will serve if a directory# is requested.#&lt;IfModule dir_module&gt;    DirectoryIndex index.html index.php indexs.php&lt;/IfModule&gt;## The following lines prevent .htaccess and .htpasswd files from being # viewed by Web clients. #&lt;FilesMatch &quot;^\.ht&quot;&gt;    Order allow,deny    Deny from all    Satisfy All&lt;/FilesMatch&gt;## ErrorLog: The location of the error log file.# If you do not specify an ErrorLog directive within a &lt;VirtualHost&gt;# container, error messages relating to that virtual host will be# logged here.  If you *do* define an error logfile for a &lt;VirtualHost&gt;# container, that host&#x27;s errors will be logged there and not here.#ErrorLog &quot;logs/error_log&quot;## LogLevel: Control the number of messages logged to the error_log.# Possible values include: debug, info, notice, warn, error, crit,# alert, emerg.#LogLevel warn&lt;IfModule log_config_module&gt;    #    # The following directives define some format nicknames for use with    # a CustomLog directive (see below).    #    LogFormat &quot;%h \&quot;%&#123;x-forwarded-for&#125;i\&quot; %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot;&quot; combined    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common    &lt;IfModule logio_module&gt;      # You need to enable mod_logio.c to use %I and %O      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot; %I %O&quot; combinedio    &lt;/IfModule&gt;    #    # The location and format of the access logfile (Common Logfile Format).    # If you do not define any access logfiles within a &lt;VirtualHost&gt;    # container, they will be logged here.  Contrariwise, if you *do*    # define per-&lt;VirtualHost&gt; access logfiles, transactions will be    # logged therein and *not* in this file.    #    CustomLog &quot;logs/access_log&quot; common    #    # If you prefer a logfile with access, agent, and referer information    # (Combined Logfile Format) you can use the following directive.    #    #CustomLog &quot;logs/access_log&quot; combined&lt;/IfModule&gt;&lt;IfModule alias_module&gt;    #    # Redirect: Allows you to tell clients about documents that used to     # exist in your server&#x27;s namespace, but do not anymore. The client     # will make a new request for the document at its new location.    # Example:    # Redirect permanent /foo http://www.example.com/bar    #    # Alias: Maps web paths into filesystem paths and is used to    # access content that does not live under the DocumentRoot.    # Example:    # Alias /webpath /full/filesystem/path    #    # If you include a trailing / on /webpath then the server will    # require it to be present in the URL.  You will also likely    # need to provide a &lt;Directory&gt; section to allow access to    # the filesystem path.    #    # ScriptAlias: This controls which directories contain server scripts.     # ScriptAliases are essentially the same as Aliases, except that    # documents in the target directory are treated as applications and    # run by the server when requested rather than as documents sent to the    # client.  The same rules about trailing &quot;/&quot; apply to ScriptAlias    # directives as to Alias.    #    ScriptAlias /cgi-bin/ &quot;/usr/local/web/apache2//cgi-bin/&quot;&lt;/IfModule&gt;&lt;IfModule cgid_module&gt;    #    # ScriptSock: On threaded servers, designate the path to the UNIX    # socket used to communicate with the CGI daemon of mod_cgid.    #    #Scriptsock logs/cgisock&lt;/IfModule&gt;## &quot;/usr/local/web/apache2/cgi-bin&quot; should be changed to whatever your ScriptAliased# CGI directory exists, if you have that configured.#&lt;Directory &quot;/usr/local/web/apache2//cgi-bin&quot;&gt;    AllowOverride None    Options None    Order allow,deny    Allow from all&lt;/Directory&gt;## DefaultType: the default MIME type the server will use for a document# if it cannot otherwise determine one, such as from filename extensions.# If your server contains mostly text or HTML documents, &quot;text/plain&quot; is# a good value.  If most of your content is binary, such as applications# or images, you may want to use &quot;application/octet-stream&quot; instead to# keep browsers from trying to display binary files as though they are# text.#DefaultType text/plain&lt;IfModule mime_module&gt;    #    # TypesConfig points to the file containing the list of mappings from    # filename extension to MIME-type.    #    TypesConfig conf/mime.types    #    # AddType allows you to add to or override the MIME configuration    # file specified in TypesConfig for specific file types.    #    #AddType application/x-gzip .tgz    #    # AddEncoding allows you to have certain browsers uncompress    # information on the fly. Note: Not all browsers support this.    #    #AddEncoding x-compress .Z    #AddEncoding x-gzip .gz .tgz    #    # If the AddEncoding directives above are commented-out, then you    # probably should define those extensions to indicate media types:    #    AddType application/x-compress .Z    AddType application/x-gzip .gz .tgz    AddType application/x-httpd-php .php .phtml    AddType application/x-httpd-php-source .phps    #    # AddHandler allows you to map certain file extensions to &quot;handlers&quot;:    # actions unrelated to filetype. These can be either built into the server    # or added with the Action directive (see below)    #    # To use CGI scripts outside of ScriptAliased directories:    # (You will also need to add &quot;ExecCGI&quot; to the &quot;Options&quot; directive.)    #    #AddHandler cgi-script .cgi    # For type maps (negotiated resources):    #AddHandler type-map var    #    # Filters allow you to process content before it is sent to the client.    #    # To parse .shtml files for server-side includes (SSI):    # (You will also need to add &quot;Includes&quot; to the &quot;Options&quot; directive.)    #    #AddType text/html .shtml    #AddOutputFilter INCLUDES .shtml&lt;/IfModule&gt;## The mod_mime_magic module allows the server to use various hints from the# contents of the file itself to determine its type.  The MIMEMagicFile# directive tells the module where the hint definitions are located.##MIMEMagicFile conf/magic## Customizable error responses come in three flavors:# 1) plain text 2) local redirects 3) external redirects## Some examples:#ErrorDocument 500 &quot;The server made a boo boo.&quot;#ErrorDocument 404 /missing.html#ErrorDocument 404 &quot;/cgi-bin/missing_handler.pl&quot;#ErrorDocument 402 http://www.example.com/subscription_info.html### MaxRanges: Maximum number of Ranges in a request before# returning the entire resource, or one of the special# values &#x27;default&#x27;, &#x27;none&#x27; or &#x27;unlimited&#x27;.# Default setting is to accept 200 Ranges.#MaxRanges unlimited## EnableMMAP and EnableSendfile: On systems that support it, # memory-mapping or the sendfile syscall is used to deliver# files.  This usually improves server performance, but must# be turned off when serving from networked-mounted # filesystems or if support for these functions is otherwise# broken on your system.##EnableMMAP off#EnableSendfile off# Supplemental configuration## The configuration files in the conf/extra/ directory can be # included to add extra features or to modify the default configuration of # the server, or you may simply copy their contents here and change as # necessary.# Server-pool management (MPM specific)Include conf/extra/httpd-mpm.conf# Multi-language error messagesInclude conf/extra/httpd-multilang-errordoc.conf# Fancy directory listings#Include conf/extra/httpd-autoindex.conf# Language settingsInclude conf/extra/httpd-languages.conf# User home directories#Include conf/extra/httpd-userdir.conf# Real-time info on requests and configuration#Include conf/extra/httpd-info.conf# Virtual hostsInclude conf/extra/httpd-vhosts.conf# Local access to the Apache HTTP Server ManualInclude conf/extra/httpd-manual.conf# Distributed authoring and versioning (WebDAV)#Include conf/extra/httpd-dav.conf# Various default settingsInclude conf/extra/httpd-default.conf# Secure (SSL/TLS) connections#Include conf/extra/httpd-ssl.conf## Note: The following must must be present to support#       starting without SSL on platforms with no /dev/random equivalent#       but a statically compiled-in mod_ssl.#&lt;IfModule ssl_module&gt;SSLRandomSeed startup builtinSSLRandomSeed connect builtin&lt;/IfModule&gt;# Virtual dir for programmer use#Include conf/httpd-vdir.confAddDefaultCharset utf-8

建立 Apache vhost 設定mv httpd-vhosts.conf httpd-vhosts.convim httpd-vhosts.conf

## Virtual Hosts## If you want to maintain multiple domains/hostnames on your# machine you can setup VirtualHost containers for them. Most configurations# use only name-based virtual hosts so the server doesn&#x27;t need to worry about# IP addresses. This is indicated by the asterisks in the directives below.## Please see the documentation at # &lt;URL:http://httpd.apache.org/docs/2.2/vhosts/&gt;# for further details before you try to setup virtual hosts.## You may use the command line option &#x27;-S&#x27; to verify your virtual host# configuration.## Use name-based virtual hosting.##NameVirtualHost *:80## VirtualHost example:# Almost any Apache directive may go into a VirtualHost container.# The first VirtualHost section is used for all requests that do not# match a ServerName or ServerAlias in any &lt;VirtualHost&gt; block.##&lt;VirtualHost *:80&gt;#    ServerAdmin root@localhost#    DocumentRoot &quot;/home/null/&quot;#    ServerName 127.0.0.1#    ErrorLog &quot;logs/null.err&quot;#    CustomLog &quot;logs/null.acc&quot;  combined#&lt;/VirtualHost&gt;Include conf/extra/vhost/*.conf



建立 vhost 目錄mkdir /usr/local/web/apache2/conf/extra/vhost

建立 mydns 設定檔vim /usr/local/web/apache2/conf/extra/vhost/mydns.conf

## Virtual Hosts## If you want to maintain multiple domains/hostnames on your# machine you can setup VirtualHost containers for them. Most configurations# use only name-based virtual hosts so the server doesn&#x27;t need to worry about# IP addresses. This is indicated by the asterisks in the directives below.## Please see the documentation at # &lt;URL:http://httpd.apache.org/docs/2.2/vhosts/&gt;# for further details before you try to setup virtual hosts.## You may use the command line option &#x27;-S&#x27; to verify your virtual host# configuration.## Use name-based virtual hosting.#NameVirtualHost *:80## VirtualHost example:# Almost any Apache directive may go into a VirtualHost container.# The first VirtualHost section is used for all requests that do not# match a ServerName or ServerAlias in any &lt;VirtualHost&gt; block.#&lt;VirtualHost *:80&gt;    ServerAdmin root@localhost    DocumentRoot &quot;/usr/share/mydnsconfig/web/&quot;    ServerName mydns    ServerAlias mydns2022.mis    ServerAlias mydns2022.mis    ErrorLog &quot;logs/mydns.err&quot;    CustomLog &quot;logs/mydns.acc&quot; common&lt;/VirtualHost&gt;



PHP-5.2.5 :建立 lib linkecho &quot;/usr/local/lib&quot; &gt; /home/local.conf    echo &quot;/usr/local/lib64&quot; &gt;&gt; /home/local.conf    ldconfig -v    ln -s /usr/lib64/libpng.so* /usr/libln -s /usr/lib64/libjpeg.so* /usr/libln -s /usr/lib64/mysql/libmysqlclient* /usr/lib

解壓 &amp;&amp; 編譯wget http://museum.php.net/php5/php-5.2.5.tar.gztar zxvf php-5.2.5.tar.gz    cd php-5.2.5/    &#x27;./configure&#x27;  &#x27;--prefix=/usr/local/web/php&#x27; &#x27;--with-apxs2=/usr/local/web/apache2/bin/apxs&#x27; &#x27;--with-mysql&#x27; &#x27;--with-mysqli=/usr/bin/mysql_config&#x27; &#x27;--disable-cgi&#x27; &#x27;--with-iconv&#x27; &#x27;--disable-inline-optimization&#x27; &#x27;--enable-mbstring=tw&#x27; &#x27;--enable-sysvshm&#x27; &#x27;--enable-sysvsem&#x27; &#x27;--enable-sockets&#x27; &#x27;--with-jpeg-dir&#x27; &#x27;--with-png-dir&#x27; &#x27;--with-gd&#x27; &#x27;--with-zlib&#x27; &#x27;--with-curl&#x27; &#x27;--enable-zip&#x27; &#x27;--enable-opcache&#x27;    make &amp;&amp; make install


啟動 ApacheApache 啟動命令/usr/local/web/apache2/bin/apachectl start
Apache 重啟命令/usr/local/web/apache2/bin/apachectl graceful


MyDNSConfig-1.1.0:建立資料夾存放 mydnsconfig datamkdir  /usr/share/mydnsconfig/```   ## 下載 `mydns-1.1.0` , `mydns-1.2.8.31````sqlwget https://github.com/dingbangli/installation/archive/refs/heads/master.zipunzip master.zip cd installation-master/

解壓至 mydnsconfig 下並給予權限777tar zxvf MyDNSConfig-1.1.0.tar.gz    cp -r MyDNSConfig-1.1.0/interface/* /usr/share/mydnsconfig/    chmod 777  /usr/share/mydnsconfig/* -R
把 table 資料灌到 mydnscd MyDNSConfig-1.1.0/installmysql -uroot -p mydns &lt; mydnsconfig.sql```   ## 更改設定```sqlvim /usr/share/mydnsconfig/lib/config.inc.php

$conf[&quot;db_type&quot;]               : &#x27;mysql&#x27;;$conf[&quot;db_host&quot;]               : &#x27;localhost&#x27;;$conf[&quot;db_database&quot;]           : &#x27;mydns&#x27;;$conf[&quot;db_user&quot;]               : &#x27;mydns&#x27;;$conf[&quot;db_password&quot;]           : &#x27;123456&#x27;;


Mydns-1.2.8.31:解壓 &amp;&amp; 編譯tar zxvf mydns-1.2.8.31.tar.gzcd mydns-1.2.8.31./configure --prefix=/usr/local/mydns --with-mysql-lib=/usr/lib64/mysql --with-zlib=/usr/lib64    make &amp;&amp; make install
建立 linkcp mydns.conf /etc/mydns.conf    ln -s /usr/local/mydns/sbin/mydns  /usr/sbin/mydns

更改 MyDNS 設定vim /etc/mydns.conf

db-host: localhost             # SQL server hostnamedb-user: mydns                 # SQL server usernamedb-password: 123456            # SQL server passworddatabase: mydns                # MyDNS database namerecursive:                     # Location of recursive resolverallow-axfr: yes                # Should AXFR be enabled?allow-tcp: yes                 # Should TCP be enabled?

啟動服務mydns -c /etc/mydns.conf -b```   ***# 驗證## WINDOWS 綁本機 HOSTS```sql172.16.0.224	mydns2022.mis
本機打開網址 http://mydns2022.mis/ 
預設帳密為: admin&#x2F;admin
]]></content>
      <categories>
        <category>DNS</category>
      </categories>
      <tags>
        <tag>mydns</tag>
      </tags>
  </entry>
  <entry>
    <title>DNS_SERVER - BIND 安裝與設定</title>
    <url>/blog.github.io/2022/12/03/DNS-BIND%E5%AE%89%E8%A3%9D%E8%88%87%E8%A8%AD%E5%AE%9A/</url>
    <content><![CDATA[安裝相關依賴及Serveryum -y install bind bind-chroot bind-utils bind-libs caching-nameserver
複製必要檔案至新路徑並給予權限cp /var/named/named.*  /var/named/chroot/var/named/    chown root.named /var/named/chroot/var/named/named.*cp -r /var/named/data/ /var/named/chroot/var/named/    chown named.named /var/named/chroot/var/named/data/ -R

更改主設定檔vim /etc/named/named.conf    //// named.conf//// Provided by Red Hat bind package to configure the ISC BIND named(8) DNS// server as a caching only nameserver (as a localhost DNS resolver only).//// See /usr/share/doc/bind*/sample/ for example named configuration files.//// See the BIND Administrator&#x27;s Reference Manual (ARM) for details about the// configuration located in /usr/share/doc/bind-&#123;version&#125;/Bv9ARM.htmloptions &#123;	listen-on port 53 &#123; any; &#125;; //監聽多個介面的port53#	listen-on-v6 port 53 &#123; ::1; &#125;; //關閉IPV6	directory 	&quot;/var/named/chroot/var/named&quot;; //位置改為/chroot/var/named	dump-file 	&quot;/var/named/data/cache_dump.db&quot;; //統計資料存放路徑	statistics-file &quot;/var/named/data/named_stats.txt&quot;; //統計資料存放路徑	memstatistics-file &quot;/var/named/data/named_mem_stats.txt&quot;; //統計資料存放路徑#	recursing-file  &quot;/var/named/data/named.recursing&quot;;#	secroots-file   &quot;/var/named/data/named.secroots&quot;;	allow-query     &#123; any; &#125;; //限制有那些用戶可以使用此台DNS	forwarders 	&#123;8.8.8.8;&#125;; //dns伺服器無法解析時，會由8.8.8.8解析	/* 	 - If you are building an AUTHORITATIVE DNS server, do NOT enable recursion.	 - If you are building a RECURSIVE (caching) DNS server, you need to enable 	   recursion. 	 - If your recursive DNS server has a public IP address, you MUST enable access 	   control to limit queries to your legitimate users. Failing to do so will	   cause your server to become part of large scale DNS amplification 	   attacks. Implementing BCP38 within your network would greatly	   reduce such attack surface 	*/	recursion yes; //遞迴式，如果本 DNS server 查不到，會往上層查	dnssec-enable no; //設定不回傳 DNS Security Extensions ( DNSSEC ) 相關的 RR	dnssec-validation no; //設定RR 不經由 DNSSEC 認證	/* Path to ISC DLV key */	bindkeys-file &quot;/etc/named.root.key&quot;;	managed-keys-directory &quot;/var/named/dynamic&quot;;#	pid-file &quot;/run/named/named.pid&quot;;#	session-keyfile &quot;/run/named/session.key&quot;;&#125;;logging &#123;        channel default_debug &#123;                file &quot;data/named.run&quot;;                severity dynamic;        &#125;;	category lame-servers &#123; null; &#125;;&#125;;zone &quot;.&quot; IN &#123;	type hint;	file &quot;named.ca&quot;;&#125;;include &quot;/etc/named.rfc1912.zones&quot;;include &quot;/etc/named.root.key&quot;;```        ## 重啟服務    systemctl restart named    # [BIND 新增 zone及解析] ## 在主設定檔新增zone   ```sqlvim /etc/named.conf   zone &quot;orz&quot; IN &#123;        type master;        file &quot;orz.zone&quot;;&#125;;

在新路徑中新增zone紀錄   vim /var/named/chroot/var/named/orz.zone    $TTL 86400@       IN      SOA     @ rname.invalid. (                        2017030903                        1D                        1H                        1W                        3H )                        NS      localhost.note


[WINDOWS 驗證:]將windows 網卡DNS設定為 DNS-SERVER 172.16.0.222   
不用綁 hosts 即可訪問   

]]></content>
      <categories>
        <category>DNS</category>
      </categories>
      <tags>
        <tag>bind</tag>
      </tags>
  </entry>
  <entry>
    <title>DNS - 正解與反解 紀錄</title>
    <url>/blog.github.io/2022/08/03/DNS-%E6%AD%A3%E8%A7%A3%E8%88%87%E5%8F%8D%E8%A7%A3/</url>
    <content><![CDATA[DNS正解／反解 ：主要是來說明〝IP位置〞與〝網址〞之間關連的狀況。

●DNS正解：是指〝網址〞對應到〝主機IP〞的關連狀況，亦為使用者在DNS Server上，透過A 指向、MX 指向、TXT指向、NS指向的設定，用來表示連結網址時會通到的IP位置的主機；或是寄信時該投遞到主機位置

●DNS反解：是指 IP 位址對映到主機的關連狀況，亦為IP透過PTR指向設定，用來表示IP對應到的網址，這個通常是設定伺服器名稱hostname，一般搭配正解的設定來達到驗證效果，如：MAIL的收信方會檢查發信IP 之反解設定是否與正解的NS指向一致；或系統有驗證到反解的訊息才會寄出系統通知信件…等

正解／反解 的設定對象為何&gt;&gt;

●正解需求的設定對象：為網址的擁有者。
●反解需求的設定對象：有ROOT權限的主機商。


]]></content>
      <categories>
        <category>DNS</category>
      </categories>
      <tags>
        <tag>DNS</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian - 火牆設定</title>
    <url>/blog.github.io/2022/12/03/Debian-%E7%81%AB%E7%89%86%E8%A8%AD%E5%AE%9A/</url>
    <content><![CDATA[
“紀錄一下 因火牆設定 導致無法建立 ssh 連線”
安裝 UFWapt install ufw

關閉 UFWufw disable

開啟 UFWufw enable

參考:   https://itw01.com/UOT99EH.html

]]></content>
      <categories>
        <category>Debian</category>
      </categories>
      <tags>
        <tag>Debian</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian - 網卡設定</title>
    <url>/blog.github.io/2022/12/03/Debian-%E7%B6%B2%E5%8D%A1%E8%A8%AD%E5%AE%9A/</url>
    <content><![CDATA[編輯網卡設定檔vi /etc/network/interfaces    auot eth0        iface eth0 inet static        address 192.168.2.66        netmask 255.255.255.0        gateway 192.168.2.254



重啟網卡/etc/init.d/networking restart

查看 IPip a

ifconfig


]]></content>
      <categories>
        <category>Debian</category>
      </categories>
      <tags>
        <tag>Debian</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian - 編輯模式下無法使用刪除鍵 (backspace)</title>
    <url>/blog.github.io/2022/12/03/Debian-%E7%B7%A8%E8%BC%AF%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%84%A1%E6%B3%95%E4%BD%BF%E7%94%A8%E5%88%AA%E9%99%A4%E9%8D%B5_backspace/</url>
    <content><![CDATA[編輯以下文件vim /etc/vim/vimrc.tiny


    set nocompatible
    
    set backspace=2


]]></content>
      <categories>
        <category>Debian</category>
      </categories>
      <tags>
        <tag>Debian</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - Install docker-compose</title>
    <url>/blog.github.io/2022/10/06/Docker-Install-docker-compose/</url>
    <content><![CDATA[下載安裝包sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.27.1/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose



對二進製文件應用可執行權限sudo chmod +x /usr/local/bin/docker-compose




創建指向 &#x2F;usr&#x2F;bin 或路徑中任何其他目錄的符號鏈接sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose



測試 docker-composedocker-compose --version





]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - overlay2佔用大量磁碟空間處理方法</title>
    <url>/blog.github.io/2022/09/13/Docker-overlay2%E4%BD%94%E7%94%A8%E5%A4%A7%E9%87%8F%E7%A3%81%E7%A2%9F%E7%A9%BA%E9%96%93%E8%99%95%E7%90%86%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[docker system命令docker system df        整體磁區使用狀況

docker system events    獲取系統即時LOG

docker system info      查看整體系統基本信息

docker system prune     清理不常用的docker資源 (包括: 容器 鏡像 磁區 網路)


]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 官方 yum 源安裝指定版本流程</title>
    <url>/blog.github.io/2022/08/19/Docker-%E5%AE%98%E6%96%B9yum%E6%BA%90%E5%AE%89%E8%A3%9D%E6%8C%87%E5%AE%9A%E7%89%88%E6%9C%AC%E6%B5%81%E7%A8%8B/</url>
    <content><![CDATA[

卸載舊版本  yum remove docker \docker-client \docker-client-latest \docker-common \docker-latest \docker-latest-logrotate \docker-logrotate \docker-selinux \docker-engine-selinux \docker-engine
rpm -qa |grep docker &amp;&amp; rpm -e --nodeps



安裝最新版 Dockerwget -qO- get.docker.com | bash 



配置官方yum源echo &#x27;[docker-ce-stable]    name=Docker CE Stable - $basearch    baseurl=https://download.docker.com/linux/centos/7/$basearch/stable    enabled=1    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-stable-debuginfo]    name=Docker CE Stable - Debuginfo $basearch    baseurl=https://download.docker.com/linux/centos/7/debug-$basearch/stable    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-stable-source]    name=Docker CE Stable - Sources    baseurl=https://download.docker.com/linux/centos/7/source/stable    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-edge]    name=Docker CE Edge - $basearch    baseurl=https://download.docker.com/linux/centos/7/$basearch/edge    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-edge-debuginfo]    name=Docker CE Edge - Debuginfo $basearch    baseurl=https://download.docker.com/linux/centos/7/debug-$basearch/edge    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-edge-source]    name=Docker CE Edge - Sources    baseurl=https://download.docker.com/linux/centos/7/source/edge    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-test]    name=Docker CE Test - $basearch    baseurl=https://download.docker.com/linux/centos/7/$basearch/test    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-test-debuginfo]    name=Docker CE Test - Debuginfo $basearch    baseurl=https://download.docker.com/linux/centos/7/debug-$basearch/test    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-test-source]    name=Docker CE Test - Sources    baseurl=https://download.docker.com/linux/centos/7/source/test    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-nightly]    name=Docker CE Nightly - $basearch    baseurl=https://download.docker.com/linux/centos/7/$basearch/nightly    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-nightly-debuginfo]    name=Docker CE Nightly - Debuginfo $basearch    baseurl=https://download.docker.com/linux/centos/7/debug-$basearch/nightly    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg        [docker-ce-nightly-source]    name=Docker CE Nightly - Sources    baseurl=https://download.docker.com/linux/centos/7/source/nightly    enabled=0    gpgcheck=1    gpgkey=https://download.docker.com/linux/centos/gpg&#x27;&gt;/etc/yum.repos.d/docker-ce.repo


要啟用哪個版本的源就將其下的 enable 值設為 1，其餘設為 0查看當前源的可用版本yum list docker-ce --showduplicates|grep &quot;^doc&quot;|sort -r  yum list docker-ce-cli --showduplicates|grep &quot;^doc&quot;|sort -r
指定安裝 client 跟 server 一樣的版本 ( 不指定版本會自動安裝最新版 )yum install docker-ce-20.10.2-3.el7 docker-ce-cli-20.10.2-3.el7 containerd.io
查看版本docker version
設置開機啟動systemctl enable docker


安裝 docker-composeyum list docker-compose-plugin --showduplicates|grep &quot;^doc&quot;|sort -r    yum install docker-compose-plugin-2.6.0-3.el7    ln -s /usr/libexec/docker/cli-plugins/docker-compose /usr/bin/docker-compose    docker-compose version


]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 常用指令 &amp;&amp; 參數</title>
    <url>/blog.github.io/2022/08/03/Docker-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E5%8F%8A%E5%8F%83%E6%95%B8/</url>
    <content><![CDATA[查看目前使用的服務docker system df
Docker passwd存放位置/root/.docker/config.json

設定docker啟動，容器自動啟動docker run 容器  --restart=always 
使用update參數修改配置docker update --restart=always ***(容器名)  

重啟Docker後，不啟動該容器docker update --restart=no mysqld-exporter
使用root權限進入容器 exec -u 0docker  exec -ti -u 0 779afa4111c2 /bin/bash
完全停止容器docker stop $(docker ps -a -q)
完全刪除容器docker rm $(docker ps -a -q)

docker 預設網段位置&quot;/etc/docker/daemon.json&quot; &gt;&gt;   &#123;  &quot;bip&quot;:&quot;192.168.0.1/24&quot;  &#125;





docker network :
創建 networkdocker network create influxdb

建立自訂義 Networkdocker network create --driver bridge --subnet 172.16.50.0/24 --gateway=172.16.50.1 --ip-range 172.16.50.0/24 &lt;network name&gt;

查看network細節docker network inspect influxdb

拉取container設定檔docker run --rm telegraf telegraf config &gt; telegraf.conf

運行容器docker run -di

使得 Container 裡面的檔案路徑Mapping 到實體主機的檔案路徑docker -v XXX

搜尋鏡像docker search mariadb 
拉取鏡像docker pull mariadb 
啟動容器docker run -d --name prometheus2022 prom/prometheus 
複製容器內檔掛載到本機目錄docker cp -a prometheus2022:/etc/prometheus/ /root/docker-service/prometheus 
砍掉容器docker rm -f prometheus2020 
清理掉所有的containerdocker rm -fv $(docker ps -a -q)
刪除imagesdocker stop containerID    docker rm containerID    docker rmi imageID

重新命名容器名稱docker rename &lt;my_container&gt; &lt;my_new_container&gt;



#############################################################


]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - Error-requested access to the resource is denied</title>
    <url>/blog.github.io/2022/09/13/Docker-Error-requested-access-to-the-resource-is-denied/</url>
    <content><![CDATA[
“上傳鏡像被拒絕 Denied ERROR: requested access to the resource is denied”
上傳 image 報錯docker push laurance/green    denied: requested access to the resource is denied
   
解决方案docker tag laurance/green ihatemis/green    ihatemis 為 Docker hub 用戶名
   
後台查看已上傳   

]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 建立 Grafana 監控並掛載在本機 語法紀錄</title>
    <url>/blog.github.io/2022/08/03/Docker-%E5%BB%BA%E7%AB%8BGrafana%E7%9B%A3%E6%8E%A7/</url>
    <content><![CDATA[搜尋鏡像docker search mariadb

拉取鏡像docker pull mariadb

本地建立目錄掛載進docker來管理mkdir -p /root/docker-service/mysql/conf/ &amp;&amp; mkdir -p /root/docker-service/mysql/data/

跑起服務docker run -d -p 3307:3306 -e MARIADB_ROOT_PASSWORD=123456 -v /root/docker-service/mysql/data/:/var/lib/mysql/ -v /root/docker-service/mysql/conf/:/etc/mysql/ --name mariadb mariadb:latest


]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 建立 MariaDB 語法紀錄</title>
    <url>/blog.github.io/2022/08/03/Docker-%E5%BB%BA%E7%AB%8BMariaDB/</url>
    <content><![CDATA[建立本機須掛載的目錄mkdir -p /root/docker-service/grafana/etc    mkdir -p /root/docker-service/grafana/share



拉取映象docker pull grafana



執行映象docker run -d --name grafana -p 3000:3000 grafana/grafana




複製docker裡的設定檔到本機docker cp -a 594649e64f24:/etc/grafana /root/docker-service/grafana/etc/  docker cp -a 594649e64f24:/usr/share/grafana /root/docker-service/grafana/share/



刪除containerdocker stop container_id    docker rm container_id




重跑設定檔 重跑掛載docker run -d -i -p 3000:3000 \      -e &quot;GF_SERVER_ROOT_URL=http://grafana.server.name&quot;  \      -e &quot;GF_SECURITY_ADMIN_PASSWORD=admin&quot;  \      -v /root/docker-service/grafana/etc/grafana/grafana.ini:/etc/grafana/grafana.ini \      -v /root/docker-service/grafana/share/grafana/conf/defaults.ini:/usr/share/grafana/conf/defaults.ini \      --net=host \      grafana/grafana





]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>MariaDB</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 建立 Zabbix 分散式監控 語法紀錄</title>
    <url>/blog.github.io/2022/08/03/Docker-%E5%BB%BA%E7%AB%8BZabbix%E5%88%86%E6%95%A3%E5%BC%8F%E7%9B%A3%E6%8E%A7/</url>
    <content><![CDATA[建立 Namesppace &gt;&gt; zabbix-netdocker network create --subnet 172.20.0.0/16 --ip-range 172.20.240.0/20 zabbix-net




建立 docker 容器工作目錄mkdir -p /usr/local/docker/mysql




建立 mysql 容器docker run --name mysql-server --hostname=mysql-server -t \          -e MYSQL_DATABASE=&quot;zabbix&quot; \          -e MYSQL_USER=&quot;zabbix&quot; \          -e MYSQL_PASSWORD=&quot;zabbix&quot; \          -e MYSQL_ROOT_PASSWORD=&quot;123456&quot; \          --network=zabbix-net \          -v /usr/local/docker/mysql:/var/lib/mysql \          -v /etc/localtime:/etc/localtime \          -d mysql:5.7




建立 zabbix-server-mysql 容器docker run --name zabbix-server-mysql --hostname=zabbix-server-mysql -t \          -e DB_SERVER_HOST=&quot;mysql-server&quot; \          -e MYSQL_DATABASE=&quot;zabbix&quot; \          -e MYSQL_USER=&quot;zabbix&quot; \          -e MYSQL_PASSWORD=&quot;zabbix&quot; \          -e MYSQL_ROOT_PASSWORD=&quot;123456&quot; \          --network=zabbix-net \          --link mysql-server:mysql \          -p 10051:10051 \          -d zabbix/zabbix-server-mysql:alpine-4.0.24




建立前端 zabbix-web-nginx-mysql容器docker run --name zabbix-web-nginx-mysql --hostname=zabbix-web-nginx-mysql -t \          -e DB_SERVER_HOST=&quot;mysql-server&quot; \          -e MYSQL_DATABASE=&quot;zabbix&quot; \          -e MYSQL_USER=&quot;zabbix&quot; \          -e MYSQL_PASSWORD=&quot;zabbix&quot; \          -e MYSQL_ROOT_PASSWORD=&quot;123456&quot; \          --network=zabbix-net \          --link mysql-server:mysql \          --link zabbix-server-mysql:zabbix-server \          -p 85:8080 \          -d zabbix/zabbix-web-nginx-mysql:alpine-4.0.24




建立Client端的控制元件docker run --name some-zabbix-agent --hostname=some-zabbix-agent \    	   -e ZBX_HOSTNAME=&quot;zabbix-server-agent&quot; \    	   -e ZBX_SERVER_HOST=&quot;zabbix-server-mysql&quot; \           -e ZBX_METADATA=&quot;zabbix-server-agent&quot; \    	   --network=zabbix-net \    	   --restart=always \    	   -p 10050:10050 \    	   -d zabbix/zabbix-agent





登入檢測 預設:賬號：Admin   密碼：zabbixConfiguration &gt; Hosts &gt; Create host         &gt; Host name : some-zabbix-agent    &gt; Groups : Linux servers    &gt; IP : 172.20.240.4    &gt; Port : 10050





]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Zabbix</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 建立 exporter 語法紀錄</title>
    <url>/blog.github.io/2022/08/03/Docker-%E5%BB%BA%E7%AB%8Bagent-exporter/</url>
    <content><![CDATA[[Node-exporter]docker run -d -p 9100:9100 \  -v &quot;/proc:/host/proc&quot; \  -v &quot;/sys:/host/sys&quot; \  -v &quot;/:/rootfs&quot; \  --net=host \  prom/node-exporter \  --path.procfs /host/proc \  --path.sysfs /host/sys \  --collector.filesystem.ignored-mount-points &quot;^/(sys|proc|dev|host|etc)($|/)&quot;  [Mysql-exporter] docker run -d  --restart=always  --name mysqld-exporter -p 9104:9104   --net=host  --pid=&quot;host&quot; -e DATA_SOURCE_NAME=&quot;exporter:123456@(172.16.0.222:3307)/&quot;   bitnami/mysqld-exporter



]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>exporter</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 建立 Prometheus 語法紀錄</title>
    <url>/blog.github.io/2022/08/03/Docker-%E5%BB%BA%E7%AB%8Bagent-prometheus/</url>
    <content><![CDATA[[prometheus]docker run -d -p 9090:9090 \  -v /root/docker-service/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml \  --name prometheus \  --net=host \  prom/prometheus



]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Prometheus</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 建立 telegraf 語法紀錄</title>
    <url>/blog.github.io/2022/08/03/Docker-%E5%BB%BA%E7%AB%8Bagent-telegraf/</url>
    <content><![CDATA[[prometheus]docker run -d -p 9090:9090 \  -v /root/docker-service/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml \  --name prometheus \  --net=host \  prom/prometheus


]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>telegraf</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker - 透過image傳輸至另一台內網機器</title>
    <url>/blog.github.io/2022/08/10/Docker-%E9%80%8F%E9%81%8Eimage%E5%82%B3%E8%BC%B8%E8%87%B3%E5%8F%A6%E4%B8%80%E5%8F%B0%E5%85%A7%E7%B6%B2%E6%A9%9F%E5%99%A8/</url>
    <content><![CDATA[首先將image包成 .tar檔docker save blazingdb/blazingsql &gt; blazingsql.tar





再執行docker load指令docker load -i blazingsql.tar





]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Fortinet - FortiGate60E SSL匯入自簽3個月憑證</title>
    <url>/blog.github.io/2022/09/20/Fortinet-FortiGate60E-SSL%E5%8C%AF%E5%85%A53%E5%80%8B%E6%9C%88%E6%86%91%E8%AD%89/</url>
    <content><![CDATA[
“( SSL-VPN 匯入 PKCS12 憑證 )”
使用certbot-auto簽發三個月憑證,並驗證TXT   

將兩隻key丟到nginx目錄測試(fullchain1.pem &gt;&gt; XXX.crt , privkey1.pem &gt;&gt; XXX.key)   

Nginx重啟reload   

將解析綁到本機hosts   
  開啟剛剛設置的域名,查看憑證是否設定正確   

使用openssl將兩隻key合併生成XXX.pfx (fortigate支援的格式) ps.會強制設定密碼   

將剛剛製作的憑證XXX.pfx上傳至fortigate後台,並輸入剛剛設置的密碼   

Fotigate後台,SSL-VPN設定這邊的伺服器憑證選單裡就會出現剛剛設置的三個月憑證   

驗證查看 &gt;&gt; 已出現剛剛製作的憑證   


]]></content>
      <categories>
        <category>FortiGate</category>
      </categories>
      <tags>
        <tag>FortiGate</tag>
      </tags>
  </entry>
  <entry>
    <title>Fortinet - FortiGate 60E SSL-VPN 設置</title>
    <url>/blog.github.io/2022/09/18/Fortinet-FortiGate60E-VPN%E8%A8%AD%E7%BD%AE/</url>
    <content><![CDATA[
“( 實現分群連接 SSL-VPN )”
1. 網路 &gt;&gt; 介面切 WAN1 對應外網 (設定成VPN入口)(Group1: 172.16.198.50-172.16.198.100 &gt;&gt; ADDR1)(Group2: 172.16.198.101-172.16.198.150 &gt;&gt; ADDR2)其餘port設定為LAN口 (internal:port1-7) IP&#x2F;遮罩 172.16.0.55&#x2F;16 關閉DHCP 默認會無法解放LAN-Port,因為被其他位置占用,解除之後就可以了
   
2. 設置辦公室內部DNS   
3. 開啟進階功能開關 &gt;&gt; 系統管理 Feature Visibility (其餘依照環境設置)   
4. 新增位址 &gt;&gt; 內部 Internal-IP   
5. 新增位址 &gt;&gt; SSLVPN_TUNNEL_ADDR1 , SSLVPN_TUNNEL_ADDR2 (做2個VPN通道)   
   
6. SSL-VPN入口頁面 &gt;&gt; 新建 VPN-GROUP1 , VPN-GROUP2 對應 ADDR1 , ADDR2   
       
7. 設置靜態路由 WAN1 (VPN入口)   
8. 設置政策路由 (設置WAN1出口,來源分兩個 Group)   
   
   
9. IP Pool &gt;&gt; 新建IP池 (外部IP設置自己到自己)   
10. 新增用戶群組   
11. SSL-VPN設定 &gt;&gt; 監聽走WAN1 , 4826Port , IP範圍:ADDR1,ADDR2 , 認證入口對應群組   
12. 新增IPV4政策(internal-wan1) (SSLVPN-LAN) (SSLVPN-WAN1)   
   
   
   

]]></content>
      <categories>
        <category>FortiGate</category>
      </categories>
      <tags>
        <tag>FortiGate</tag>
      </tags>
  </entry>
  <entry>
    <title>Fortinet - FortiGate 60E 延遲自動登出設定</title>
    <url>/blog.github.io/2022/09/20/Fortinet-FortiGate60E%E5%BB%B6%E9%81%B2%E8%87%AA%E5%8B%95%E7%99%BB%E5%87%BA%E8%A8%AD%E5%AE%9A/</url>
    <content><![CDATA[
“(解決延遲登出時間過短)”
1. 修改閒置時間   

]]></content>
      <categories>
        <category>FortiGate</category>
      </categories>
      <tags>
        <tag>FortiGate</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - ChatGPT 串接 Firebase 及 Linebot</title>
    <url>/blog.github.io/2023/03/22/GCP-ChatGPT%E4%B8%B2%E6%8E%A5Firebase%E5%8F%8ALinebot/</url>
    <content><![CDATA[建立與設定線上即時性資料庫 Firebase Realtime database
https://console.firebase.google.com/u/0/



點選 Go to console






點選 建立專案






輸入 專案名稱及打勾協議






取消勾選與 Google Analytics 建立關聯，可以直接建立專案建立關聯可以透過 Google Analytics  進行數據分析統計，但如果只是要單純使用資料庫，可以不必建立關聯






建立 Realtime Database 資料庫


專案建立完成後就會進入專案畫面，從左側選擇 建構 &gt; Realtime Database






選擇後，點擊建立資料庫






資料庫的位置選擇美國 繼續下一步






使用鎖定模式啟用 ( 鎖定模式表示這個資料庫禁止存取，啟用後會再修改設定使資料庫可以存取資料 )






建立好的畫面






修改 Realtime Database 存取權限


進入規則頁籤，將規則從 false 修改為 ture 點擊發布，就能將資料庫改成所有人都可以存取的狀態






建立 GCP-Cloud Functions# requirements.txt# Function dependencies, for example:# package&gt;=versionline-bot-sdkrequestsopenaigit+https://github.com/ozgur/python-firebase

# main.pyfrom linebot import LineBotApi, WebhookHandlerfrom linebot.models import TextSendMessage, StickerSendMessage, ImageSendMessage, LocationSendMessageimport requests, jsonimport openaiopenai.api_key: &#x27;XXXXXXXXXXXXXXXXXXXX&#x27;from firebase import firebasetoken: &#x27;XXXXXXXXX&#x27;secret: &#x27;XXXXXXXXX&#x27;def linebot(request):    body: request.get_data(as_text=True)    json_data: json.loads(body)    try:        line_bot_api: LineBotApi(token)        handler: WebhookHandler(secret)        signature: request.headers[&#x27;X-Line-Signature&#x27;]        handler.handle(body, signature)        tk: json_data[&#x27;events&#x27;][0][&#x27;replyToken&#x27;]        timestamp: json_data[&#x27;events&#x27;][0][&#x27;timestamp&#x27;]        msg_type: json_data[&#x27;events&#x27;][0][&#x27;message&#x27;][&#x27;type&#x27;]        if msg_type:= &#x27;text&#x27;:            msg: json_data[&#x27;events&#x27;][0][&#x27;message&#x27;][&#x27;text&#x27;]            url: &#x27;XXXXXXXXXXXXXX.firebaseio.com&#x27;            fdb: firebase.FirebaseApplication(url, None)                        chatgpt: fdb.get(&#x27;/&#x27;,&#x27;chatgpt&#x27;)                                    if chatgpt:= None:                            messages: []                        else:                            messages: chatgpt                                    if msg:= &#x27;!reset&#x27;:                            reply_msg: TextSendMessage(text=&#x27;對話歷史紀錄已經清空！&#x27;)                            line_bot_api.reply_message(tk,reply_msg)                            fdb.delete(&#x27;/&#x27;,&#x27;chatgpt&#x27;)                        else:                            messages.append(&#123;&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:msg&#125;)                            response: openai.ChatCompletion.create(                                model=&quot;gpt-3.5-turbo&quot;,                                max_tokens=640,                                temperature=0.5,                                messages=messages                            )                            ai_msg: response.choices[0].message.content.replace(&#x27;\n&#x27;,&#x27;&#x27;)                            messages.append(&#123;&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:ai_msg&#125;)                            reply_msg: TextSendMessage(text=ai_msg)                            line_bot_api.reply_message(tk,reply_msg)                            fdb.put_async(&#x27;/&#x27;,&#x27;chatgpt&#x27;,messages)                    else:                        reply_msg: TextSendMessage(text=&#x27;你傳的不是文字訊息啦&#x27;)                        line_bot_api.reply_message(tk,reply_msg)                except Exception as e:                    detail: e.args[0]                    print(detail)                return &#x27;OK&#x27;




建立好 Function 後 , 將 觸發網址 貼入 Line Developers Webhook URL 並點選 Verify 驗證






進入 Firebase Realtime database 也能看到歷史紀錄的資料




]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>Firebase</tag>
      </tags>
  </entry>
  <entry>
    <title>Fortinet - FortiGate 常用防火牆 CLI 指令</title>
    <url>/blog.github.io/2022/09/13/Fortinet-FortiGate%E5%B8%B8%E7%94%A8%E9%98%B2%E7%81%AB%E7%89%86CLI%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[常用防火牆 CLI 指令查看設定檔show full-configuration

備份設定檔exe backup config/allconfig/ipsuserdefsigfilename xx.x.x(tftp server)

還原設定檔exe restore config/allconfig/ipsuserdefsig/imagefilename x.x.x.x(tftp server)

顯示系統狀態get sys status

顯示系統效能介面get system interface

show system interface

顯示系統效能get system performance

顯示各service utilizationdiag sys top (ctrl-c exit)

格式化硬碟以消除所有記錄exe formatlogdisk

手動同步HA設定exe ha synchronize config

查看HA 狀態diagnose sys ha checksum cluster    

show system ha

get sys ha status

重新啟動execute reboot

關機execute shutdown

查看 arp tableget system arp

清除 arp table cacheexecute clear system arp table

pingexe ping x.x.X.X


]]></content>
      <categories>
        <category>FortiGate</category>
      </categories>
      <tags>
        <tag>FortiGate</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - Google Cloud Monitoring by Grafana</title>
    <url>/blog.github.io/2023/03/06/GCP-Google-Cloud-Monitoring-by-Grafana/</url>
    <content><![CDATA[Grafana 系統搭配 GCP Monitoring 資訊做監控
GCP 設定{STEP 1} 啟用API服務 Stackdriver Monitoring API


 



{STEP 2} 啟用API服務 Cloud Resource Manager API


 



{STEP 3} 點選 API和服務 建立服務帳號憑證


 



{STEP 4} 設定服務帳號名稱及設定該帳號權限


    



{STEP 5} 設定 授權此帳號的使用者


 



{STEP 6} 點選剛建立的監控服務帳號 monitor-grafana 並建立 JSON 金鑰


  



{STEP 7} 添加監控權限 For Monitor


 



添加 授權使用者


 



新增主體: 剛建立的監控服務帳號 XXX.gmail指派角色: 監控檢視者


 



Grafana


{STEP 8} 新增 Data source 資料來源 Google Cloud Monitoring


  



{STEP 9} 將 STEP 6 新增的 JSON 金鑰 上傳 &amp;&amp; Save &amp; test


選擇 Google JWT File點選 Upload service account key file


  



{STEP 10} 成果驗收


 

]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - Cloud Functions 部屬 LINE BOT + OpenAI</title>
    <url>/blog.github.io/2023/02/16/GCP-Cloud-Functions%E9%83%A8%E5%B1%ACLINE-BOT+OpenAI/</url>
    <content><![CDATA[LINE BOT + OpenAI 程式，讓 AI 回覆訊息
讓程式判斷「Hi AI:」開頭的文字，當文字的開頭出現「Hi AI:」的字串時，就讓 OpenAI 進行回覆，否則就仍然回傳相同的字串。

{Step 1} 到 OpenAI 申請一組帳號及API keys


Open AI API KEY : https://platform.openai.com/account/api-keys







{Step 2} 登入GCP選取專案 (這邊使用新專案測試)


右側選取 API和服務 &gt; 程式庫 程式庫搜尋 build api


 






點選 啟用API






點選 建立函式 就能開始建立第一支 Cloud Functions 的程式






點選建立函式後，設定基本資訊，環境選擇 第一代 asia-east1 (台灣)






觸發條件選擇 HTTP 勾選 允許未經驗證的叫用 透過 request POST 或 GET 的方法進行叫用






其他保留預設值即可


編輯 main.py requiements.txt 加入 LINE BOT 和 OpenAI 函式庫







{Step 3} 完成後部署程式，專案名稱前方出現綠色勾勾表示部署完成，複製觸發的網址






將網址填入 LINE BOT 的 Message API 裡 Webhook URL，點擊 Edit 貼上剛剛觸發網址


接者按 Verify 驗證，出現 Success 表示 Webhook URL 已經順利串接






若出現 ERROR-403 則是沒有給予呼叫的權限






解決方法:選取剛建立的 function 編輯權限 選取 新增主體






主體選擇 allUsers 泛指匿名使用者指派角色選擇 Cloud Functions &gt; Cloud Functions 叫用者






{Step 4} 驗收 Line bot






參考: 
https://steam.oxxostudio.tw/category/python/example/line-bot-openai-2.html
https://blog.wawajohn.net/11369.html

]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - ASG 執行範本建立與更新</title>
    <url>/blog.github.io/2022/10/03/GCP-asg%E5%9F%B7%E8%A1%8C%E7%AF%84%E6%9C%AC%E5%BB%BA%E7%AB%8B%E8%88%87%E6%9B%B4%E6%96%B0/</url>
    <content><![CDATA[ASG 執行範本建立與更新
模板機先建立快照 &gt;&gt; 再轉映像檔區域選台灣 &gt;&gt; 按建立


   



建立執行個體範本


   



建立執行個體範本 網路分頁將外部IP 更改成無；勾選允許HTTP、HTTPS流量


   



建立完畢後 編輯執行個體群組 套用新的 執行個體範本 確認有出現後再開始進行web滾動更新


   



GCP ASG-web滾動更新選擇執行各體群組 &gt; 輪動式重新啟動&#x2F;取代


   



點選取代 &gt; 供應過度數量上限填1 &gt; 無法使用的數量寫0  &gt; 取代


   



PS:供應過度的數量上限: 是指滾動時，可超過當下存在的機器數量的上限如果原本上限是8台，填1時，滾動時上限可為9台如果是上班時段，建議填寫目前機器數量，滾動速度會比較快一點如果是維護其間，可填寫1 讓它慢慢替換


無法使用的執行個體數量上限: 是指滾動時，群組裡面能有幾台無法使用這邊不管是上班或是維護期間 都應填寫0
]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - gcloud config 設定配置使用</title>
    <url>/blog.github.io/2023/05/06/GCP-gcloud-config-%E8%A8%AD%E5%AE%9A%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[

安裝 gcloud-cli
參考安裝教學

curl -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-cli-430.0.0-linux-x86_64.tar.gztar -xf google-cloud-cli-430.0.0-linux-x86.tar.gz./google-cloud-sdk/install.sh



查看配置列表gcloud config configurations list



查看本機用戶gcloud auth list



新增配置gcloud config configurations create [name]



帳號登入gcloud auth login


設定專案gcloud config set project [project name]


設定地區gcloud config set compute/zone [zone name]


設定地域gcloud config set compute/region [region name]





切換配置gcloud config configurations activate [name]



刪除配置ps. 要先切換配置才能刪除

gcloud config configurations delete [name]







]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - google 啟用兩步驟驗證 再設定應用程式專用密碼</title>
    <url>/blog.github.io/2022/12/06/GCP-google%E5%95%9F%E7%94%A8%E5%85%A9%E6%AD%A5%E9%A9%9F%E9%A9%97%E8%AD%89/</url>
    <content><![CDATA[


點選右上角頭像，管理你的帳戶左邊 安全性 找到 “登入 Google” 並點選 “兩步驟驗證”






會列出有綁帳號的手機，點選繼續接著輸入 “驗證碼”






都完成後退出到首頁，並點選 “應用程式密碼”






接著系統會產生一組隨機密碼這組應用程式專用密碼只能登入一個地方




]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - GCE 內存過小導致無法編譯 PHP 解決方法</title>
    <url>/blog.github.io/2022/12/06/GCP-%E5%85%A7%E5%AD%98%E9%81%8E%E5%B0%8F%E5%B0%8E%E8%87%B4%E7%84%A1%E6%B3%95%E7%B7%A8%E8%AD%AFPHP/</url>
    <content><![CDATA[


編譯PHP時,秀 ERROR: virtual memory exhausted: Cannot allocate memory


因為用的是免費方案,內存小的可憐,故先調大再縮小GCP後台查看機器內存只有 614M


   



機器上看也是 583M


   



先將機器關機 (要關機才能調)init 0    # Linux 關機語法




到GCP後台調成 g1-small


   



開機後就能看到已調成 1.6G


   

]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - 執行 gcloud components update 報錯 ERROR: &#39;cannot perform this action because the Google Cloud CLI component manager&#39; </title>
    <url>/blog.github.io/2023/05/06/GCP-%E5%9F%B7%E8%A1%8Cgcloud-components-update%E5%A0%B1%E9%8C%AF/</url>
    <content><![CDATA[
ERROR: (gcloud.components.update) 
You cannot perform this action because the Google Cloud CLI component manager 
is disabled for this installation


解決方法 ( 將 google-cloud-sdk 重新安裝 )
yum remove google-cloud-sdkcurl -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-cli-434.0.0-linux-x86_64.tar.gztar zxvf google-cloud-cli-434.0.0-linux-x86_64.tar.gz cd google-cloud-sdk/./install.sh source ~/.bashrc


查看版本 &amp;&amp; 再運行一次 update
gcloud --versiongcloud components update





]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - 安裝內建監控 Ops agent 代理 </title>
    <url>/blog.github.io/2023/05/06/GCP-%E5%AE%89%E8%A3%9DOps-agent%E4%BB%A3%E7%90%86%E7%9B%A3%E6%8E%A7/</url>
    <content><![CDATA[
Ops Agent 是用於從 Compute Engine 實例收集遙測數據的主要代理。通過將日誌記錄和指標組合到單個代理中，Ops Agent 對日誌使用 Fluent Bit（支持高吞吐量日誌記錄），對指標使用 OpenTelemetry 收集器


安裝 beta 組件
gcloud components install betagcloud components listgcloud components update


安裝腳本 &amp;&amp; 執行腳本 --project=帳號 ID
wget https://cloud.google.com/static/stackdriver/docs/set-permissions.shbash set-permissions.sh --project=XXXXX-account ID


建立監控策略
gcloud beta compute instances \ops-agents policies create ops-agents-test-policy \--agent-rules=&quot;type=logging,enable-autoupgrade=false;type=metrics,enable-autoupgrade=false&quot; \--description=&quot;A test policy.&quot; \--os-types=short-name=centos,version=7 \--instances=zones/us-central1-a/instances/test-instance


查看 agent 版本 &amp;&amp; 服務
gcloud --versiongcloud components update





]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - 如何將 MySQL-DB 及 Binlog 備份至 Cloudstorage</title>
    <url>/blog.github.io/2022/09/21/GCP-%E5%B0%87MySQL-DB%E5%8F%8ABINLOG%E5%82%99%E4%BB%BD%E8%87%B3Cloudstorage/</url>
    <content><![CDATA[


1. 使用 nohup+&amp; 背景執行資料庫壓縮 (除掉binlog)


   



2. 取第一支binlog跟最後一隻binlog的日期 (當作到時候壓縮的檔名)


   



3. 使用 nohup+&amp; 背景執行binlog壓縮


   



4. 原本的驗證機制被刪除了 (gcloud auth login)


   
   



5. 將壓縮好的TAR包傳到中繼機 (之前跟GCP驗證過的機器)


   



6. 上傳到GCP對應的目錄


   

]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - 建立 Auto scaling group</title>
    <url>/blog.github.io/2022/12/06/GCP-%E5%BB%BA%E7%AB%8BAuto-scaling-group/</url>
    <content><![CDATA[


架構 : LB -&gt; ASG -&gt; auto scaling

建立需要擴展機器的 Image




點選來源磁碟 &amp; 地區 &amp; 將不關機的選項打勾




製作擴展機器的範本




選擇區域 &amp; 機器規格 區域記得要選全域










若前面有掛LB 可將外網 IP拿掉




建立擴展群組




選擇第一個 無狀態模式 &amp; 範本 &amp; 區域 &amp; 擴展數量




健康狀態檢查 內套 tcp &amp; ( LB ) 外套 http








]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - 無痛轉移帳單免費額度</title>
    <url>/blog.github.io/2022/12/15/GCP-%E7%84%A1%E7%97%9B%E8%BD%89%E7%A7%BB%E5%B8%B3%E5%96%AE%E5%85%8D%E8%B2%BB%E9%A1%8D%E5%BA%A6/</url>
    <content><![CDATA[
“無限試用期教學”



GCP 剩餘時間






在 [帳單 &gt; 帳戶管理] 可以看到有帳單帳戶管理員我們可以先用 新 gmail 註冊一個新 GCP 帳號






將新的 GCP帳號 綁定同一張信用卡,領取300美抵免額






ps. 如果出現卡被扣40塊 , 放心後面會退刷的


在舊 的帳單帳戶ID裡新增剛剛新創立的新 GCP帳號帳單 &gt; 帳戶管理 &gt; 新增主體






將新的 GCP帳號填入並選擇帳單帳戶管理員






儲存後可以看到帳單帳戶管理員多了 新的GCP帳號






接著到新的GCP帳號選擇管理帳單帳戶






在新 的帳單帳戶ID裡新增舊 GCP帳號






將舊的 GCP帳號填入並選擇帳單帳戶管理員






儲存後可以看到帳單帳戶管理員多了 舊的GCP帳號






再來需要將新舊帳單的帳單管理員互換 :將舊GCP 帳單裡 保留新的GCP帳號  ( 將 舊的GCP帳號 砍掉 )將新GCP 帳單裡 保留舊的GCP帳號  ( 將 新的 GCP帳號 砍掉 )新的GCP帳號裡沒有跑機器,不會產生費用用新的抵免額延續舊GCP帳號裡的機器在 計費功能 &gt; 我的專案下 操作 &gt; 變更帳單 &gt; 至我的帳單帳戶


再來將舊專案的ID 改成新的帳單ID


上面都做完後,可以看到舊帳號的帳戶ID已經變成有抵免額的新帳號ID






再來切到我的專案裡面,看到帳單帳戶ID還是舊的






將所有專案點選 變更帳單 切換到新的帳單帳戶 ID














將新帳號裡系統建的專案停用計費功能






之後再將這預設專案關閉即可


















最後重新開啟後可以看到舊帳號已延續新帳號的抵免額及天數







]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GCP - 硬碟擴容</title>
    <url>/blog.github.io/2022/10/06/GCP-%E7%A1%AC%E7%A2%9F%E6%93%B4%E5%AE%B9/</url>
    <content><![CDATA[


在 GCP 上，點選硬盤，直接修改想要的硬盤大小 ( 只能擴大、不能縮小 )這邊測試將容量增加到 1.5T



   



後台增加完硬碟容量後,到機器使用指令 lsblk 看一下目前的硬碟空間

會發現從原本的 1.3T 變成 1.5T，但是用 df -h  卻沒看到空間增加



擴大分割區

以下是針對 sda 的第一個分割區擴大
安裝 growpart 套件
yum install cloud-utils-growpart


使用 growpart  命令擴容該分區
growpart /dev/sda 2




擴大檔案系統空間如果是 ext2 ext3 ext4 的 file system，則用 resize2fs  ,  如果是 xfs 則用 xfs_growfs
xfs 檔案系統
xfs_growfs /dev/sda2


ext4 檔案系統
resize2fs /dev/sda2





]]></content>
      <categories>
        <category>GCP</category>
      </categories>
      <tags>
        <tag>GCP</tag>
      </tags>
  </entry>
  <entry>
    <title>GIT - 常用語法</title>
    <url>/blog.github.io/2022/08/09/GIT-%E5%B8%B8%E7%94%A8%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[查看Git版本git --version

查看Git設定內容git config --list

設定帳戶，讓 Git 知道這台電腦做的修改要連結到哪一個使用者git config --global user.name &quot;&lt;Your Name&gt;&quot;

設定電子郵件git config --global user.email &quot;&lt;your@gmail.com&gt;&quot;
創建一個新的Repository (打開任何一個專案資料夾打上)git init
顯示目前工作環境狀態git status
複製專案git clone XXX
將專案加入追蹤(暫存起來)git add hello.py
將專案 commit 進去 repository (確定存入版本庫)git commit -m &quot;Init hello.py&quot;
比較現在檔案和上次 commit 之間的差異git diff    git diff |cat XXX    git diff 785641bf91c11f25a01c0d48182e810bc8b3bc1c (git log產生的commit代碼)
詳細列出該次commit的修改內容git show 
查看目前所有commit的歷史紀錄git log
檢查更改git fetch
將這些更改應用到我們的本地倉庫git merge
檔案尚未加入過追蹤時使用，即可恢復到檔案尚未加入暫存區 (取消add)git rm --cached hello.py
若檔案已經在 repository 內，則使用以下指令repository 與 stage 的檔案都會被還原到 HEAD，但 working directory 內的檔案不變    git reset HARD

將本地端程式 push 到遠端檔案庫git push -u origin master
切出自己的新分支（使用 -b）git checkout -b happycoder@feature_branch



]]></content>
      <categories>
        <category>GIT</category>
      </categories>
      <tags>
        <tag>GIT</tag>
      </tags>
  </entry>
  <entry>
    <title>GIT - 使用 github 託管個人網站步驟</title>
    <url>/blog.github.io/2022/08/09/GITHUB-%E4%BD%BF%E7%94%A8github%E8%A8%97%E7%AE%A1%E5%80%8B%E4%BA%BA%E7%B6%B2%E7%AB%99%E6%AD%A5%E9%A9%9F/</url>
    <content><![CDATA[

紀錄一下如何建立 blog 並使用 github 託管

點選 Your repositories 建立倉庫




選擇 New 建立一個全新的倉庫來放 code




將倉庫名填寫為 我的名字.github , 並選擇 Public

repo 權限一定要是 public 否則無法訪問&#96;





這邊測試建立 index.html (若已經有代碼可點選 uploading 上傳)




填寫基本的 html 用於測試





點選 settings 設置




點選右側 Pages 可以看到 Github 給的 URL

Github-URL 為 https://XXXXX.github.io
若沒出現可以刷新一下或點去別頁再點回來
設置自訂義域名並設置 NS 指向
添加自訂義域名至後台管理 (root domain)





設置 DNS CNAME &amp;&amp; A records





nslookup XXX..github.io


將四個IP加入NS A records




選擇 custom domain 填入自己的域名並等待驗證 (sub domain)





設定強制使用 https
Cloudflare 上右側選擇 規則





填入URL並設定為一律使用 HTTPS





Github 推送步驟
cd publicgit initgit remote add origin https://github.com/XXX.github.io.gitgit add -Agit commit -m &quot;first commit&quot;git push -u origin master



]]></content>
      <categories>
        <category>GIT</category>
      </categories>
      <tags>
        <tag>GIT</tag>
      </tags>
  </entry>
  <entry>
    <title>Github Action - 實現CI/CD自動部署至 Render</title>
    <url>/blog.github.io/2023/11/09/Github-%E8%87%AA%E5%8B%95%E9%83%A8%E7%BD%B2%E8%87%B3Render/</url>
    <content><![CDATA[

在GIT目錄下新增 .github/workflows/main-pr.yml 執行 action 的腳本
mkdir -p .github/workflowsvim main-pr.yml

name: Main Deployrun-name: $&#123;&#123; github.actor &#125;&#125; Main Beployon:  push:    branches:      - mainjobs:  deploy:    runs-on: ubuntu-latest    steps:      - name: Deploy        run: |          curl -X POST -H &quot;Authorization: Bearer $&#123;&#123; secrets.RENDER_TOKEN &#125;&#125;&quot; \          -H &quot;Content-Type: application/json&quot; \          -d &#x27;&#123;&#125;&#x27; \          $&#123;&#123; secrets.RENDER_DEPLOY_HOOK &#125;&#125;


Render 關閉 Auth Deploy 及記錄 Deploy Hook

******紀錄 API Key

******將剛剛複製的 Deploy Hook 跟 API Key 貼到 GitHub 的 Secrets 裡面

******接著點一下「new repository secret」，然後輸入 RENDER_DEPLOY_HOOK 跟 RENDER_TOKEN 並貼入相對應的值，最後點一下「Add secret」就完成了

最後試一下 git push 後 Render上會自動部署了





參考文件

]]></content>
      <categories>
        <category>GIT</category>
      </categories>
      <tags>
        <tag>RENDER</tag>
      </tags>
  </entry>
  <entry>
    <title>GIT - 如何建立訪問 Token</title>
    <url>/blog.github.io/2022/10/17/Git-%E5%BB%BA%E7%AB%8B%E8%A8%AA%E5%95%8FToken/</url>
    <content><![CDATA[
“密碼登入顯示 ERROR : Authentication failed”



點擊右上角 setting


   



左側欄 點擊 Developer settings


   



左側欄 點擊 Personal access tokens


   



生成新 Tokens


   



新增 Token Name


   



選擇過期時間


   



選擇鑰給予 Token 的權限


   



生成 Tokens


   

]]></content>
      <categories>
        <category>GIT</category>
      </categories>
      <tags>
        <tag>GIT</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - 構建 Linux 效能監控</title>
    <url>/blog.github.io/2022/09/27/Grafana+influxdb+telegraf%E6%A7%8B%E5%BB%BALinux%E6%95%88%E8%83%BD%E7%9B%A3%E6%8E%A7/</url>
    <content><![CDATA[


使用 grafana + influxdb + telegraf 建立監控


Grafana 安裝   Grafana 官方載點
以下用 yum 方式安裝 Grafanae-8.2.3-1
wget https://dl.grafana.com/enterprise/release/grafana-enterprise-8.2.3-1.x86_64.rpm    yum localinstall grafana-enterprise-8.2.3-1.x86_64.rpm    systemctl start grafana-server    systemctl status grafana-server



InfluxDB 、 Telegraf 安裝InfluxDB 官方載點
以下用 yum 方式安裝 InfluxDB v1.8.0 Telegraf v1.24.1
cat &lt;&lt;EOF | tee /etc/yum.repos.d/influxdata.repo[influxdata]name: InfluxData Repository - Stablebaseurl: https://repos.influxdata.com/stable/\$basearch/mainenabled: 1gpgcheck: 1gpgkey: https://repos.influxdata.com/influxdata-archive_compat.keyEOFyum install influxdb telegraf



Step.1 修改 Telegraf 的設定檔並啟動:將 output-influxdb 打開並指向 database-telegraf , 打開 network 跟其他參數 , 新增使用者


[[inputs.net]][[inputs.netstat]][[inputs.interrupts]][[inputs.linux_sysctl_fs]][[inputs.conntrack]][[inputs.nstat]][[inputs.ntpq]][[inputs.logparser]]



[[outputs.influxdb]]  urls: [&quot;http://127.0.0.1:8086&quot;]  database: &quot;telegraf&quot;  username: &quot;telegraf&quot;  password: &quot;telegraf&quot;




啟動服務 telegrafservice telegraf start



Step.2 啟動服務 InfluxDBservice influxdb start



Step.3 進入 InfluxDB 介面建立 telegraf 使用者 , 並給予權限influxcreate user laurance with password [REDACTED]   # 先建立一個 root 身分 , 後續才能使用密碼驗證登入grant all privileges to laurancecreate database telegrafcreate user telegraf with password &#x27;telegraf&#x27;grant all on telegraf to telegrafexit



Step.4 啟動服務 grafanasystemctl start grafana-server



Step.5 開啟後台 http://localhost:3000 並建立資料來源 datasource  
  
  
  


Step.6 匯入 Grafana 官方模板  
  
  


Step.7 驗證: 打開本機 3000port    ex: http://172.16.0.222:3000  



]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
        <tag>telegraf</tag>
        <tag>influxdb</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - CLI 常用指令語法</title>
    <url>/blog.github.io/2023/08/16/Grafana-CLI_%E6%8C%87%E4%BB%A4%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[


Grafana CLI command syntax

查看版本
grafana-cli -v


覆蓋預設插件目錄
grafana-cli --pluginsDir &quot;/var/lib/grafana/devplugins&quot; plugins install &lt;plugin-id&gt;


覆蓋預設插件儲存庫 URL--repo value允許您從預設 Grafana 儲存庫以外的儲存庫下載並安裝或更新外掛程式


grafana-cli --repo &quot;https://example.com/plugins&quot; plugins install &lt;plugin-id&gt;



列出可用的插件
grafana-cli plugins list-remote



安裝最新版本的插件
grafana-cli plugins install &lt;plugin-id&gt;



安裝特定版本的插件
grafana-cli plugins install &lt;plugin-id&gt; &lt;version&gt;



列出已安裝的插件
grafana-cli plugins ls



更新所有已安裝的插件
grafana-cli plugins update-all



更新一個插件
grafana-cli plugins update &lt;plugin-id&gt;



刪除一個插件
grafana-cli plugins remove &lt;plugin-id&gt;



顯示所有管理命令
grafana-cli admin



重置管理者密碼
grafana-cli admin reset-admin-password &lt;new password&gt;



新增 API KEY
curl -X POST -H &quot;Content-Type: application/json&quot; -d &#x27;&#123;&quot;name&quot;: &quot;my-api-key&quot;, &quot;role&quot;: &quot;Viewer&quot;&#125;&#x27; http://admin:admin@localhost:3000/api/auth/keys




參考文件API

]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - Iframe 去除 bar 工具條</title>
    <url>/blog.github.io/2023/02/16/Grafana-Iframe%E5%8E%BB%E9%99%A4bar/</url>
    <content><![CDATA[kiosk 去除全部邊框http://172.17.0.1:3000/d/UDdpyzz7z/prometheus-2-0-stats?orgId=1&amp;refresh=1m`&amp;kiosk`




kiosk&#x3D;tv 去除左側功能欄，頂部不去除http://172.17.0.1:3000/d/UDdpyzz7z/prometheus-2-0-stats?orgId=1&amp;refresh=1m`&amp;kiosk=tv`



]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - Loki 查詢語言 LogQL</title>
    <url>/blog.github.io/2022/12/16/Grafana-Loki%E6%9F%A5%E8%A9%A2%E8%AA%9E%E8%A8%80LogQL/</url>
    <content><![CDATA[查詢關鍵字 “ERROR”&#123;job=&quot;my1log&quot;,filename=&quot;/var/lib/mysql/master01/mysql.err&quot;&#125; |= &quot;ERROR&quot;






   

]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - Polystat panel使用</title>
    <url>/blog.github.io/2022/11/03/Grafana-Polystat-panel%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[
“( 建立 agent 監控並使用 Line-Notify 提醒 )”
安裝Grafana套件grafana-cli plugins install grafana-polystat-panel```    ## 服務重啟   ```sqlservice grafana-server restart
查看 telegraf 的 PIDps aux |grep telegraf |grep -v &#x27;grep&#x27;|awk &#x27;&#123;print $2&#125;&#x27;```    ## 建立監控並寫入 InfluDB 的 Shell，並給予權限   ```sqlvim live.sh &amp;&amp; chmod 755 live.sh




   



建立排程 ( SHELL:每2秒執行一次 )crontab -e    * * * * * sh /home/grafana/crontab-live.sh




Grafana 後台-建立新 panel 並設置


   
   



最後記得要 SAVE，不然得重頭在來


   

]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - 使用 uptime 查詢系統運行時間</title>
    <url>/blog.github.io/2022/12/16/Grafana-%E4%BD%BF%E7%94%A8uptime%E6%9F%A5%E8%A9%A2%E7%B3%BB%E7%B5%B1%E9%81%8B%E8%A1%8C%E6%99%82%E9%96%93/</url>
    <content><![CDATA[建立 panel for uptime點選 uptime 的 panel 選擇 edit


 



旁邊細節設定可參照 :


 
 



InfluxDB查詢語法:select last(uptime_format) as value from system    SELECT last(&quot;uptime_format&quot;) AS &quot;value&quot; FROM &quot;system&quot; WHERE &quot;host&quot;:~ /$server$/ AND $timeFilter GROUP BY time($interval)



]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - 告警報錯 ERROR &#39;webhook_response_status_401&#39;及升級版本至 v10.1.4</title>
    <url>/blog.github.io/2023/08/16/Grafana-%E5%91%8A%E8%AD%A6%E5%A0%B1%E9%8C%AF_ERROR_webhook_response_status_401/</url>
    <content><![CDATA[測試 LINE告警時,出現 ERROR &quot;webhook_response_status_401&quot;




查了好久才發現原來是v10.0版本的問題 所以紀錄一下

升級Grafana至v10.1

備份 (測試後不會不見,可以不備份)

sqlite-DB

cp /var/lib/grafana/grafana.db /root/grafana-bakup/


插件目錄

cp -r /var/lib/grafana/plugins /root/grafana-bakup/


設定檔

cp /etc/grafana/grafana.ini /root/grafana-bakup/



停止服務

service grafana-server stop



升級安裝版本 v10.1.4

yum localinstall https://dl.grafana.com/enterprise/release/grafana-enterprise-10.1.4-1.x86_64.rpm



啟動服務

service grafana-server start



查看版本

grafana-cli -v




]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - 建立 panel for loading</title>
    <url>/blog.github.io/2022/12/16/Grafana-%E5%BB%BA%E7%AB%8Bpanel-for-loading/</url>
    <content><![CDATA[

Add an panel for monitor loading

{step1} 右上角 + &gt; Add an empty panel

{step2} 依需求填寫 Data source Query Visualization

Data source: InfluxDB
Query: SELECT last(“load1”) AS “load” FROM “system” WHERE  “host” !~&#x2F;^$interval$&#x2F; and time &gt; now() -1m group by “host”
Visualization: Table





{step3} 選擇 Transform 建立 Organize fields &amp;&amp; 增加 host load time





{step4} 右側條件選單拉到最底選擇

Add filed override &gt; Fields with name &gt; LastUpdate &gt; + Add override property







Standard options &gt; Unit &gt; Date&amp;time &gt; From Now






Override 1




Override 2




Override 3




Final





]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - 建立 panel for memory</title>
    <url>/blog.github.io/2022/12/16/Grafana-%E5%BB%BA%E7%AB%8Bpanel-for-memory/</url>
    <content><![CDATA[

Add an panel for monitor memory

{step1} 右上角 + &gt; Add an empty panel

{step2} 依需求填寫 Data source Query Visualization

Data source: InfluxDB
Query: 
SELECT last(“used_percent”) AS “percent”, “used” AS “used”, “total” AS “total” FROM “mem” WHERE  “host” !~&#x2F;^$interval$&#x2F; and time &gt; now() -1m group by “host”
Visualization: Table


{step3} 依需求新增 Transform

Transform: Organize fields
host: Host
used: Used
total: Total
percent: Percent
Time: LastUpdate







{step4} 右側條件選單拉到最底選擇 Add filed override

Override 1 &amp; Override 2






Override 3 &amp; Override 4 &amp; Override 5







]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - 建立 panel for storage</title>
    <url>/blog.github.io/2022/12/16/Grafana-%E5%BB%BA%E7%AB%8Bpanel-for-storage/</url>
    <content><![CDATA[

Add an panel for monitor storage

{step1} 右上角 + &gt; Add an empty panel

{step2} 依需求填寫 Data source Query VisualizationData source: InfluxDB
Format as: Table
Visualization: Table
SELECT last(&quot;used_percent&quot;) AS &quot;percent&quot;, &quot;used&quot; AS &quot;used&quot;, &quot;total&quot; AS &quot;total&quot; FROM &quot;disk&quot; WHERE  &quot;host&quot; !~ /^$interval$/ and time &gt; now() -1m group by &quot;host&quot;, &quot;path&quot;






{step3} 選擇 Transform 建立 Organize fields &amp;&amp; 依需求填寫 host,path,used,total,percent,lastupdate





{step4} 右側條件選單拉到最底選擇 Add filed override

Override 1 &amp; Override 2





Override 3 &amp; Override 4





Override 5 &amp; Override 6





FINAL





]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
      </tags>
  </entry>
  <entry>
    <title>Grafana - 搭建紀錄 Loki、Promtail、Grafana 輕量級日誌系統</title>
    <url>/blog.github.io/2022/12/16/Grafana-%E6%90%AD%E5%BB%BALoki,Promtail,Grafana%E8%BC%95%E9%87%8F%E7%B4%9A%E6%97%A5%E8%AA%8C%E7%B3%BB%E7%B5%B1/</url>
    <content><![CDATA[

Grafana 安裝Grafana 官方載點
安裝完啟動 grafana用途:用於視覺化和分析 Log
wget https://dl.grafana.com/enterprise/release/grafana-enterprise-9.3.2-1.x86_64.rpm    yum localinstall grafana-enterprise-9.3.2-1.x86_64.rpm    systemctl start grafana-server &amp;&amp; systemctl status grafana-server



Promtail 、 Loki 安裝Promtail &amp; Loki 官方載點
Promtail 安裝用途:收集 Log 及添加標籤並發送給 Loki
wget https://github.com/grafana/loki/releases/download/v2.7.1/promtail-2.7.1.x86_64.rpm    yum localinstall promtail-2.7.1.x86_64.rpm



Loki 安裝用途:負責儲存 Log 和處理查詢
wget https://github.com/grafana/loki/releases/download/v2.7.1/loki-2.7.1.x86_64.rpm        yum localinstall loki-2.7.1.x86_64.rpm



Promtail &amp; Loki 設定檔配置:vim /etc/loki/config.yml
   
vim /etc/promtail/config.yml
   
啟動服務 Promtail &amp; Lokisystemctl start loki &amp;&amp; systemctl start promtail



訪問 Grafana建立 Datasorce for loki   


選擇 LOKI - Database   


填寫資料來源 之後按 save &amp;&amp; explore   


填寫 Log browser job &amp; filename 即可   


驗證:curl http://172.16.0.222:3100/metrics



Loki 整體架構



]]></content>
      <categories>
        <category>Grafana</category>
      </categories>
      <tags>
        <tag>Grafana</tag>
        <tag>Promtail</tag>
        <tag>Loki</tag>
      </tags>
  </entry>
  <entry>
    <title>HEXO - 解決圖片無法顯示</title>
    <url>/blog.github.io/2023/07/01/HEXO-%E8%A7%A3%E6%B1%BA%E5%9C%96%E7%89%87%E7%84%A1%E6%B3%95%E9%A1%AF%E7%A4%BA/</url>
    <content><![CDATA[

Hexo 已安裝套件 hexo-asset-image 圖片還是無法顯示將以下貼入原本的 index.js
&#x27;use strict&#x27;;var cheerio: require(&#x27;cheerio&#x27;);// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-stringfunction getPosition(str, m, i) &#123;    return str.split(m, i).join(m).length;&#125;var version: String(hexo.version).split(&#x27;.&#x27;);hexo.extend.filter.register(&#x27;after_post_render&#x27;, function (data) &#123;    var config: hexo.config;    if (config.post_asset_folder) &#123;        var link: data.permalink;        if (version.length &gt; 0 &amp;&amp; Number(version[0]):= 3)            var beginPos: getPosition(link, &#x27;/&#x27;, 1) + 1;        else            var beginPos: getPosition(link, &#x27;/&#x27;, 3) + 1;        // In hexo 3.1.1, the permalink of &quot;about&quot; page is like &quot;.../about/index.md&quot;.        var endPos: link.lastIndexOf(&#x27;/&#x27;) + 1;        link: link.substring(beginPos, endPos);        var toprocess: [&#x27;excerpt&#x27;, &#x27;more&#x27;, &#x27;content&#x27;];        for (var i: 0; i &lt; toprocess.length; i++) &#123;            var key: toprocess[i];            var $: cheerio.load(data[key], &#123;                ignoreWhitespace: false,                xmlMode: false,                lowerCaseTags: false,                decodeEntities: false            &#125;);            $(&#x27;img&#x27;).each(function () &#123;                if ($(this).attr(&#x27;src&#x27;)) &#123;                    // For windows style path, we replace &#x27;\&#x27; to &#x27;/&#x27;.                    var src: $(this).attr(&#x27;src&#x27;).replace(&#x27;\\&#x27;, &#x27;/&#x27;);                    if (!/http[s]*.*|\/\/.*/.test(src) &amp;&amp;                        !/^\s*\//.test(src)) &#123;                        // For &quot;about&quot; page, the first part of &quot;src&quot; can&#x27;t be removed.                        // In addition, to support multi-level local directory.                        var linkArray: link.split(&#x27;/&#x27;).filter(function (elem) &#123;                            return elem != &#x27;&#x27;;                        &#125;);                        var srcArray: src.split(&#x27;/&#x27;).filter(function (elem) &#123;                            return elem != &#x27;&#x27; &amp;&amp; elem != &#x27;.&#x27;;                        &#125;);                        if (srcArray.length &gt; 1)                            srcArray.shift();                        src: srcArray.join(&#x27;/&#x27;);                        $(this).attr(&#x27;src&#x27;, config.root + link + src);                        console.info &amp;&amp; console.info(&quot;update link as:--&gt;&quot; + config.root + link + src);                    &#125;                &#125; else &#123;                    console.info &amp;&amp; console.info(&quot;no src attr, skipped...&quot;);                    console.info &amp;&amp; console.info($(this));                &#125;            &#125;);            data[key]: $.html();        &#125;    &#125;&#125;);




]]></content>
      <categories>
        <category>HEXO</category>
      </categories>
      <tags>
        <tag>HEXO</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTP - 常見狀態錯誤碼</title>
    <url>/blog.github.io/2022/08/03/HTTP-%E5%B8%B8%E8%A6%8B%E7%8B%80%E6%85%8B%E9%8C%AF%E8%AA%A4%E7%A2%BC/</url>
    <content><![CDATA[

HTTP-常見狀態錯誤碼




意思代表
狀態碼



資訊回應
100–199


成功回應
200–299


重定向
300–399


用戶端錯誤
400–499


伺服器端錯誤
500–599




100	&#x3D; 此臨時回應表明，目前為止的一切完好，而用戶端應當繼續完成請求
101	&#x3D; 此狀態碼乃為用戶端 Upgrade (en-US) 請求標頭發送之回應、且表明伺服器亦切換中。
102	&#x3D; 此狀態碼表明伺服器收到並處理請求中，但目前未有回應。


200: OK
201	&#x3D; 請求成功且新的資源成功被創建，通常用於 POST 或一些 PUT 請求後的回應。
202	&#x3D; 此請求已經被接受但尚未處理。


300	&#x3D; 請求擁有一個以上的回應。
301	&#x3D; 請求資源的 URI 已被改變。
302	&#x3D; 此響應代碼表示請求資源的 URI 已臨時更改。


400: 此回應意味伺服器因為收到無效語法，而無法理解請求。
401	&#x3D; 需要授權以回應請求。它有點像 403，但這裡的授權，是有可能辦到的。
403	&#x3D; 用戶端並無訪問權限，例如未被授權，所以伺服器拒絕給予應有的回應。不同於 401，伺服端知道用戶端的身份。
404	&#x3D; 伺服器找不到請求的資源。


500	&#x3D; 請求已進入伺服器，可能原因 : 程式錯誤 php-error
501	&#x3D; 伺服器不支援請求的方法，僅有GET與HEAD是伺服器必須支援的方法。
502	&#x3D; 作為閘道的伺服器，在獲取處理請求所需的回應時，得到無效回應。
503	&#x3D; 常見原因是服務器因維護而停機或過載。
504	&#x3D; 伺服器作為閘道器時無法及時得到回應。可能原因 cloudfront 節點未更新
505	&#x3D; 請求使用的 HTTP 版本不被伺服器支援。



]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title>HUGO - error: hugo: /lib64/libstdc++.so.6: version `GLIBCXX_3.4.20&#39; not found (測試機)</title>
    <url>/blog.github.io/2023/05/20/HUGO-error%E6%89%BE%E4%B8%8D%E5%88%B0libstdc-XX-so6-version-GLIBCXX/</url>
    <content><![CDATA[
.&#x2F;hugo: &#x2F;lib64&#x2F;libstdc++.so.6: version GLIBCXX_3.4.20&#39; not found (required by .&#x2F;hugo)  .&#x2F;hugo: &#x2F;lib64&#x2F;libstdc++.so.6: version CXXABI_1.3.8&#39; not found (required by .&#x2F;hugo)  .&#x2F;hugo: &#x2F;lib64&#x2F;libstdc++.so.6: version GLIBCXX_3.4.21&#39; not found (required by .&#x2F;hugo)


解決辦法:


strings /usr/lib64/libstdc++.so.6 | grep GLIBCXXwget http://mirror.ghettoforge.org/distributions/gf/el/7/gf/x86_64/gf-release-7-12.gf.el7.noarch.rpmrpm -Uvh gf-release-7-12.gf.el7.noarch.rpmyum install gcc10-libstdc++rpm -ql gcc10-libstdc++.x86_64find / -name &quot;libstdc++.so.6*&quot;cp /opt/gcc-10.2.1/usr/lib64/libstdc++.so.6.0.28 /usr/lib64/cd /usr/lib64rm libstdc++.so.6ln -s libstdc++.so.6.0.28 libstdc++.so.6hugo version





]]></content>
      <categories>
        <category>HUGO</category>
      </categories>
      <tags>
        <tag>HUGO</tag>
      </tags>
  </entry>
  <entry>
    <title>HUGO - error 缺少模組 admonition (測試機)</title>
    <url>/blog.github.io/2023/05/20/HUGO-error%E7%BC%BA%E5%B0%91%E6%A8%A1%E7%B5%84admonition(%E6%B8%AC%E8%A9%A6%E6%A9%9F)/</url>
    <content><![CDATA[
failed to extract shortcode: template for shortcode “admonition” not found


解決辦法: 新增 html 模組


vim themes/hugo-FixIt/themes/FixIt/layouts/shortcodes/admonition.html



&#123;&#123;- $inner := .Inner | .Page.RenderString -&#125;&#125;&#123;&#123;- $iconMap := dict &quot;note&quot; &quot;fa-solid fa-pencil-alt fa-fw&quot; -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;abstract&quot; &quot;fa-solid fa-list-ul fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;info&quot; &quot;fa-solid fa-info-circle fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;tip&quot; &quot;fa-solid fa-lightbulb fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;success&quot; &quot;fa-solid fa-check-circle fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;question&quot; &quot;fa-solid fa-question-circle fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;warning&quot; &quot;fa-solid fa-exclamation-triangle fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;failure&quot; &quot;fa-solid fa-times-circle fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;danger&quot; &quot;fa-solid fa-skull-crossbones fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;bug&quot; &quot;fa-solid fa-bug fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;example&quot; &quot;fa-solid fa-list-ol fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconMap : dict &quot;quote&quot; &quot;fa-solid fa-quote-right fa-fw&quot; | merge $iconMap -&#125;&#125;&#123;&#123;- $iconDetails := &quot;fa-solid fa-angle-right fa-fw&quot; -&#125;&#125;&#123;&#123;- if .IsNamedParams -&#125;&#125;  &#123;&#123;- $type := .Get &quot;type&quot; | default &quot;note&quot; -&#125;&#125;  &lt;div class=&quot;details admonition &#123;&#123; $type &#125;&#125;&#123;&#123; if .Get `open` | ne false &#125;&#125; open&#123;&#123; end &#125;&#125;&quot;&gt;    &lt;div class=&quot;details-summary admonition-title&quot;&gt;      &lt;i class=&quot;icon &#123;&#123; index $iconMap $type | default (index $iconMap &quot;note&quot;) &#125;&#125;&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&#123;&#123; .Get &quot;title&quot; | .Page.RenderString | default (T (printf &quot;admonition.%v&quot; $type)) &#125;&#125;&lt;i class=&quot;details-icon &#123;&#123; $iconDetails &#125;&#125;&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;    &lt;/div&gt;    &lt;div class=&quot;details-content&quot;&gt;      &lt;div class=&quot;admonition-content&quot;&gt;        &#123;&#123;- $inner -&#125;&#125;      &lt;/div&gt;    &lt;/div&gt;  &lt;/div&gt;&#123;&#123;- else -&#125;&#125;  &#123;&#123;- $type := .Get 0 | default &quot;note&quot; -&#125;&#125;  &lt;div class=&quot;details admonition &#123;&#123; $type &#125;&#125;&#123;&#123; if .Get 2 | ne false &#125;&#125; open&#123;&#123; end &#125;&#125;&quot;&gt;    &lt;div class=&quot;details-summary admonition-title&quot;&gt;      &lt;i class=&quot;icon &#123;&#123; index $iconMap $type | default (index $iconMap &quot;note&quot;) &#125;&#125;&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&#123;&#123; .Get 1 | .Page.RenderString | default (T (printf &quot;admonition.%v&quot; $type)) &#125;&#125;&lt;i class=&quot;details-icon &#123;&#123; $iconDetails &#125;&#125;&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;    &lt;/div&gt;    &lt;div class=&quot;details-content&quot;&gt;      &lt;div class=&quot;admonition-content&quot;&gt;        &#123;&#123;- $inner -&#125;&#125;      &lt;/div&gt;    &lt;/div&gt;  &lt;/div&gt;&#123;&#123;- end -&#125;&#125;




]]></content>
      <categories>
        <category>HUGO</category>
      </categories>
      <tags>
        <tag>HUGO</tag>
      </tags>
  </entry>
  <entry>
    <title>HUGO - 如何更換主題 (測試機)</title>
    <url>/blog.github.io/2023/05/20/HUGO-%E6%9B%B4%E6%8F%9B%E4%B8%BB%E9%A1%8C(%E6%B8%AC%E8%A9%A6%E6%A9%9F)/</url>
    <content><![CDATA[

Hugo 更換主題紀錄

建立新的 hugo site

hugo new site hugo-beautifulhugo



Clone 主題至新的 Site

cd hugo-beautifulhugogit clone https://github.com/halogenica/beautifulhugo.git themes/beautifulhugo



將該主題需要的設定檔複製到新的 site

cp -r themes/beautifulhugo/exampleSite/* . -iv



將舊主題的筆記移到新主題裡

cd themes/hugo-terminal/content/postscp -r ../../../../themes/hugo-FixIt/content/posts/* .



背景啟動 hugo

nohup hugo -D server -b 172.16.0.222 --bind=&quot;0.0.0.0&quot; --theme=$THEME --disableFastRender -e production &amp;




]]></content>
      <categories>
        <category>HUGO</category>
      </categories>
      <tags>
        <tag>HUGO</tag>
      </tags>
  </entry>
  <entry>
    <title>HUGO - 報錯 ERROR-panic: mkdir /tmp/hugo_cache: no such file or directory</title>
    <url>/blog.github.io/2023/05/05/HUGO-ERROR-panic-mkdir-hugo_cache_no_such_file_or_directory/</url>
    <content><![CDATA[

Hugo ERROR 解決辦法




將 hugo 重新安裝即可
/var/lib/snapd/snap/bin/hugo -vsnap remove hugosnap install hugosnap listhugo version




]]></content>
      <categories>
        <category>HUGO</category>
      </categories>
      <tags>
        <tag>HUGO</tag>
      </tags>
  </entry>
  <entry>
    <title>HUGO - install by snapd on centos7</title>
    <url>/blog.github.io/2023/05/01/HUGO-install-by-sbapd-on-centos7/</url>
    <content><![CDATA[

Hugo 下載安裝紀錄

安裝依賴庫及 snapd
yum install epel-releaseyum install snapd



開機啟動服務
systemctl enable --now snapd.socket



建立 snap 軟連結 link
ln -s /var/lib/snapd/snap /snap



使用 snap 安裝 hugo
snap install hugo



ERROR: error: too early for operation, device not yet seeded or device model not acknowledged

重新在下一次安裝語法即可
snap install hugo





安裝完成後,建立 hugo 軟連結 link
ln -s /var/lib/snapd/snap/bin/hugo /usr/bin/hugo



]]></content>
      <categories>
        <category>HUGO</category>
      </categories>
      <tags>
        <tag>HUGO</tag>
      </tags>
  </entry>
  <entry>
    <title>HUGO - 添加 Valine 評論系統 (Fixlt)</title>
    <url>/blog.github.io/2023/05/01/HUGO-%E6%B7%BB%E5%8A%A0Valine%E8%A9%95%E8%AB%96%E7%B3%BB%E7%B5%B1_(FixIt)/</url>
    <content><![CDATA[

Hugo 添加評論系統紀錄

註冊 LeanCloud 帳號
ps. 選擇國際板註冊

LeanCloud 官網

新增專案應用
點選 創造應用 , 填入 專案名稱 , 選擇 開發版





點選設定 齒輪 進入後台





左側找到 設置 &gt; 應用憑證
需記住這 3 組 KEY

AppIDAppKeyRESET API





左側找到 數據存儲 &gt; 結構化數據 





新增 2 個 Class , 分別命名為 Counter 及 Comment , ACL 權限設置為 限制寫入





設置可調用此 SDK 資源的域名 (就是自己的域名啦)





修改設定檔 config.toml
將評論設置打開為 true

# FixIt 0.2.15 | CHANGED Comment config[params.page.comment]enable: true


修改 Valine 參數

appId: 之前紀錄的 AppID

appkey: 之前紀錄的 App Key

serverURLs: 之前紀錄的 RESET API


[params.page.comment.valine]  enable: true  appId: &quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;  appKey: &quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;  placeholder: &quot;說點啥吧......&quot;  avatar: &quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;  meta: &quot;&quot;  requiredFields: &quot;&quot;  pageSize: 10  lang: &quot;&quot;  visitor: true  recordIP: true  highlight: true  enableQQ: false  serverURLs: &quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;  # FixIt 0.2.6 | NEW emoji data file name, default is &quot;google.yml&quot;  # [&quot;apple.yml&quot;, &quot;google.yml&quot;, &quot;facebook.yml&quot;, &quot;twitter.yml&quot;]  # located in &quot;themes/FixIt/assets/lib/valine/emoji/&quot; directory  # you can store your own data files in the same path under your project:  # &quot;assets/lib/valine/emoji/&quot;  emoji: &quot;&quot;  commentCount: true # FixIt 0.2.13 | NEW



主題文件comments中有相關佈局可以不需要修改
部署到自己的託管平台，就可以看到正常的文章計數和評論框了]]></content>
      <categories>
        <category>HUGO</category>
      </categories>
      <tags>
        <tag>HUGO</tag>
      </tags>
  </entry>
  <entry>
    <title>haproxy - 設定檔解析</title>
    <url>/blog.github.io/2023/03/09/Haproxy-%E8%A8%AD%E7%BD%AE%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[

global 設定 ( 全域設定 )global        log 127.0.0.1 local5        chroot /usr/local/haproxy        pidfile /var/run/haproxy.pid        maxconn 5000        user haproxy        group haproxy        daemon        stats socket /etc/haproxy/haproxy.sock mode 600 level admin        stats timeout 2m#-----------------------------------------------------------------------------------------------



log       設定至本機 syslog 預設位置 (級別為 local5 notice)
chroot    設定為 haproxy 主要運行位置
pidfile   設定為 haproxy 進程
maxconn   設定每個 haproxy 進程可以接受的最大併發連接數
daemon    設定為背景執行


default 設定 ( 設定能用來配置套用到 frontend、backend、listen 等配置 )defaults        mode tcp        log global        option httplog        option dontlognull        option log-health-checks        retries 3        timeout http-request 30s        timeout queue 300s        timeout connect 600s        timeout client 10m        timeout server 10m        timeout http-keep-alive 30s        timeout check 600s        maxconn 4000#-----------------------------------------------------------------------------------------------



mode  指定了 HAProxy instance 所使用的通訊協定
log   指定 LOG 將寫入的位址 global 值參照了 global 一節中的 log 參數中所指定的 HAProxy instance
option httplog    能紀錄 HTTP session 的多種值，包括 HTTP 請求、session 狀態、連線數、來源位址、以及連線計數器等等
option dontlognull    停用了對 null 連線之記錄，表示 HAProxy 不會記錄未傳遞任何資料的連線
option log-health-checks  記錄健康檢查日誌
retries   指定了在無法第一次就連上時，真實伺服器會重試連線的次數
timeout http-request  http請求超時時間
timeout queue     排隊超時
timeout connect   設置成功連接到一臺服務器的最長等待時間，默認單位是毫秒
timeout client    設置連接客戶端發送數據時的成功連接最長等待時間，默認單位是毫秒
timeout server    設置服務器端迴應客戶度數據發送的最長等待時間，默認單位是毫秒
timeout http-keep-alive   設置長連接時間
timeout check     設置超時時間
maxconn       最大連接數


listen stats 設定 ( 監聽狀態 )listen stats        bind  XX:XX:XX:XX:8080 (內網IP)        mode    http        log     127.0.0.1 local0 err        stats   uri     /hastats        stats auth    admin:admin        stats refresh 10s        stats hide-version        stats admin if TRUE#-----------------------------------------------------------------------------------------------        



bind  設定 IP , PORT


frontend 設定 ( 設定會配置伺服器聆聽來自用戶端連線請求的聆聽 socket )frontend ha86        bind *:3386        mode tcp        option tcplog        default_backend mysqlha86



option tcplog  允許記錄tcp連接的狀態和時間


backend 設定 ( 設定會指定真實伺服器的 IP 位址，以及負載平衡程式的排程演算法 )backend mysqlha86        balance leastconn        server db86 XX:XX:XX:XX:3306 check port 3306 rise 1 fall 2 maxconn 2000 weight 100#-----------------------------------------------------------------------------------------------        



balance   指定負載平衡程式的排程演算法，此範例中使用的乃最少連線排程法 leastconn
server    指定了後端可以使用的伺服器 db86
check     設置定期「健康檢查」的伺服器，以確保伺服器的可用性
rise 1    表示 1 次檢查結果正確則認爲服務器可用
fall 2    表示檢測結果失敗 2 次則認爲服務器不可用
weight    權重


演算法說明|  演算法名稱 		  |  設置參數   	 |  							 							說明|  ——–   		  |  ——–   	 |  ———————————————————————————————————————————————————-	||	  循環法		  |    roundrobin    |            將請求依序發給集區中的伺服器。使用此演算法則時，所有真實伺服器不管能力為何，都會被視為平等														|																||	  靜態循環法	  |    static-rr     |  一般地在一組伺服器之間循序性地分散各項請求，不過不允許動態式配置伺服器的權重。然而，基於伺服器權重的靜態本質，後端中不會有伺服器啟用數量上的限制			|																			||	  最少連線排程法  |	  leastconn   	 |  將請求分散至連線數較少的真實伺服器。當處於一個動態式且包含各種 session 或是連線長度的環境中，對管理員來說這個排程器可能會較適合其環境						|									||	  來源		  	  |    source  		 |  透過雜湊請求的來源 IP 位址，並除以所有運作中的伺服器的權重，以判斷哪個伺服器將會收到請求																	||	  URI		  	  |    uri      	 |  透過雜湊整個 URI（或是 URI 的可配置部分）並除以所有運作中的伺服器的權重，以判斷哪個伺服器將會收到請求														||	  URL 參數		  |    url_param     |  藉由在來源 URL 請求中找尋特定參數字串，並執行一項雜湊計算除以所有運作中的伺服器的權重，以將請求分散至伺服器上												||	  表頭名稱		  |    hdr    		 |  透過選取各個來源 HTTP 請求中的特定表頭名稱來將請求發佈至伺服器上，並進行一項雜湊計算然後除以所有運作中伺服器的權重											|					||	  RDP Cookie	  |    rdp-cookie    |  透過查詢每項 TCP 請求的 RDP cookie 來將請求發佈至伺服器上，並執行一項雜湊計算然後除以所有運作中伺服器的權重													|
參考: https://access.redhat.com/documentation/zh-tw/red_hat_enterprise_linux/7/html/load_balancer_administration/s1-haproxy-setup-global

]]></content>
      <categories>
        <category>DNS</category>
      </categories>
      <tags>
        <tag>Haproxy</tag>
      </tags>
  </entry>
  <entry>
    <title>HUGO - 添加 Algolia 搜索支持</title>
    <url>/blog.github.io/2023/03/10/HUGO%E6%B7%BB%E5%8A%A0Algolia%E6%90%9C%E7%B4%A2%E6%94%AF%E6%8C%81/</url>
    <content><![CDATA[

新增搜索模塊 Algolia 配置在 hugo 上,實現本地搜索Algolia官方網址


{Step 1} 新建 application 及 index


{Step 2} 紀錄 Keys 等等會用到 ( Application ID, Search-Only API Key, Admin API Key )


{Step 3} 修改 config.yaml 主要生成 Algolia 索引outputFormats:    Algolia:        baseName: algolia        isPlainText: true        mediaType: application/json        notAlternative: trueoutputs:    home: [&quot;HTML&quot;, &quot;RSS&quot;, &quot;Algolia&quot;]params.algolia:    appId: &quot;Application ID&quot;    indexName: &quot;Index name&quot;    searchOnlyKey: &quot;Admin API Key&quot;



{Step 4} 目錄下執行 hugo 命令後,在 public/ 下會生成 index.json  (若是生成 algolia.json 會找不到位置)

{Step 5} 將上述生成的 index.json 上傳至 Algolia


{Step 6} 安裝 Atomic-Algolia (目的: 自動上傳)

在根目錄下語法
註：這裡需要用到 npm 套件工具，所以需要安裝 node js


npm init    直接一直 `ENTER` , 生成 `package.Json`npm install atomic-algolia --save       生成 `package-lock.json` 及 `node_modules````    ******#### 修改根目錄下的 `package.Json`******```sqlvim package.Json



在 scripts 下添加以下&quot;scripts&quot;: &#123;    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,    &quot;algolia&quot;: &quot;atomic-algolia&quot;  &#125;,

Json 格式記得要加逗號,不然會跳 ERROR


 


在跟目錄下建立 .env 檔  一定要小寫 , 大寫 ENV 會報錯

vim .env



ALGOLIA_APP_ID=你的Application IDALGOLIA_INDEX_NAME=你的索引名字  ALGOLIA_INDEX_FILE=public/algolia.jsonALGOLIA_ADMIN_KEY=你的Admin API Key



上傳索引文件

執行指令查看效果
npm run algolia



 


之後有新文章的時候，使用 hugo &amp;&amp; npm run algolia 即可

參考: https://edward852.github.io/post/hugo%E6%B7%BB%E5%8A%A0algolia%E6%90%9C%E7%B4%A2%E6%94%AF%E6%8C%81/#%E7%94%9F%E6%88%90%E7%B4%A2%E5%BC%95%E6%96%87%E4%BB%B6

]]></content>
      <categories>
        <category>HUGO</category>
      </categories>
      <tags>
        <tag>HUGO</tag>
      </tags>
  </entry>
  <entry>
    <title>InfluxDB - http CRUD 語法</title>
    <url>/blog.github.io/2023/03/23/InfluxDB-http_CRUD%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[
InfluxDB 常用語法紀錄


HTTP API

使用 GET 請求 查詢 CPU (帶 user : password)curl -G &#x27;http://172.16.0.222:8086/query?pretty=true&#x27; --data-urlencode &quot;db=telegraf&quot; -u telegraf:telegraf --data-urlencode &quot;q=SELECT * FROM &quot;cpu&quot; limit 1&quot;



使用 POST 請求 創建資料庫curl -i -XPOST &#x27;http://172.16.0.222:8086/query?pretty=true&#x27; -u laurance:telegraf --data-urlencode &quot;q=CREATE DATABASE testdb&quot;    HTTP/1.1 200 OK    Content-Type: application/json    Request-Id: aeee08da-cc97-11ed-8be8-92b84f18e45a    X-Influxdb-Build: OSS    X-Influxdb-Version: 1.8.10    X-Request-Id: aeee08da-cc97-11ed-8be8-92b84f18e45a    Date: Mon, 27 Mar 2023 12:05:36 GMT    Transfer-Encoding: chunked        &#123;        &quot;results&quot;: [            &#123;                &quot;statement_id&quot;: 0            &#125;        ]    &#125;



使用 POST 請求 將數據寫入 DBcurl -i -XPOST &#x27;http://172.16.0.222:8086/write?db=testdb&#x27; -u laurance:kiwi888 --data-binary &#x27;cpu_load_short,host=server01,region=us-west value=0.64 1434055562000000000&#x27;    HTTP/1.1 204 No Content    Content-Type: application/json    Request-Id: 5dedeb7d-cc98-11ed-8cda-92b84f18e45a    X-Influxdb-Build: OSS    X-Influxdb-Version: 1.8.10    X-Request-Id: 5dedeb7d-cc98-11ed-8cda-92b84f18e45a    Date: Mon, 27 Mar 2023 12:10:30 GMT



使用 POST 請求 將數據一起寫入 DBcurl -i -XPOST &#39;http://172.16.0.222:8086/write?db=testdb&#39; -u laurance:kiwi888 --data-binary &#39;cpu_load_short,host=server01,region=us-west value=0.64 1434055562000000000
&gt; cpu_load_short,host=server02,region=us-west value=0.55 1422568543702900257
&gt; cpu_load_short,direction=in,host=server01,region=us-west value=2.0 1422568543702900257&#39;


    HTTP/1.1 204 No Content
    Content-Type: application/json
    Request-Id: ccf012f8-cc98-11ed-8d78-92b84f18e45a
    X-Influxdb-Build: OSS
    X-Influxdb-Version: 1.8.10
    X-Request-Id: ccf012f8-cc98-11ed-8d78-92b84f18e45a
    Date: Mon, 27 Mar 2023 12:13:36 GMT



使用 POST 請求 將文件 TXT 寫入 DBcurl -i -XPOST &#39;http://172.16.0.222:8086/write?db=testdb&#39; -u laurance:kiwi888 --data-binary @influxdb.txt


    HTTP/1.1 204 No Content
    Content-Type: application/json
    Request-Id: 29a9ebda-cc99-11ed-8dfa-92b84f18e45a
    X-Influxdb-Build: OSS
    X-Influxdb-Version: 1.8.10
    X-Request-Id: 29a9ebda-cc99-11ed-8dfa-92b84f18e45a
    Date: Mon, 27 Mar 2023 12:16:11 GMT






返回代碼
說明



2xx
如果你寫了數據後收到HTTP 204 No Content，說明寫入成功了！


4xx
表示InfluxDB不知道你發的是什麼鬼。


5xx
系統過載或是應用受損。



]]></content>
      <categories>
        <category>InfluxDB</category>
      </categories>
      <tags>
        <tag>InfluxDB</tag>
      </tags>
  </entry>
  <entry>
    <title>InfluxDB - 如何建立使用者密碼及相關權限</title>
    <url>/blog.github.io/2023/03/23/InfluxDB-%E5%BB%BA%E7%AB%8B%E4%BD%BF%E7%94%A8%E8%80%85%E5%AF%86%E7%A2%BC/</url>
    <content><![CDATA[InfluxDB 預設是沒有密碼的,使用 influx 進入介面操作即可[root@laurance ~]# influx    Connected to http://localhost:8086 version 1.8.10    InfluxDB shell version: 1.8.10



建立使用者及密碼CREATE USER telegraf WITH PASSWORD &#x27;telegraf&#x27;CREATE USER &lt;username&gt; WITH PASSWORD &#x27;&lt;password&gt;&#x27;



給予讀的權限GRANT READ ON telegraf TO lauranceGRANT [READ,WRITE,ALL] ON &lt;database_name&gt; TO &lt;username&gt;



查看使用者SHOW USERS



查看權限SHOW GRANTS FOR laurance



拔除 root 權限REVOKE ALL PRIVILEGES FROM telegraf



給予 root 權限GRANT ALL PRIVILEGES TO laurance



重新設置密碼SET PASSWORD FOR laurance: &#x27;influxdb4ever&#x27;



刪除使用者DROP USER laurance



登入將密碼驗證打開 ps 一定要有 &#39;&#39;ROOT&#39;  才能登入編輯設定檔 vim /etc/influxdb/influxdb.conf將 [http] 模快下的 [auth-enabled] 改為 true 


改完設定重啟 DBsystemctl restart influxdb



帶密碼登入influx -username laurance -password influxdb4ever



進入介面 使用密碼登入[root@laurance ~]# influx    Connected to http://localhost:8086 version 1.8.10    InfluxDB shell version: 1.8.10    &gt; auth    username: laurance    password: 




]]></content>
      <categories>
        <category>InfluxDB</category>
      </categories>
      <tags>
        <tag>InfluxDB</tag>
      </tags>
  </entry>
  <entry>
    <title>Iptables - 使用 geoip 過濾國家 (centos7)</title>
    <url>/blog.github.io/2022/09/08/Iptables-%E4%BD%BF%E7%94%A8geoip%E9%81%8E%E6%BF%BE%E5%9C%8B%E5%AE%B6/</url>
    <content><![CDATA[安裝必要套件yum install xz gcc make wget unzip kernel-devel-$(uname -r) iptablesdevel.$(uname -p) perl-Text-CSV_XS
確認目前的kernel版本uname -r```        ### 確認底下的目錄名稱必須要跟上個步驟的版號完全相同，若不同時請確認yum安裝的kerneldevel套件版本，對不上時有下列幾種做法    ```sqlls /usr/src/kernels/
   #### 1) 一般、非客制化Linux版本，請參照下述##### 移除目前裝的版本rpm -e kernel-devel##### 至 rpm包網站 http://rpm.pbone.net 下載與kernel相同版號的 kernel-develwget *.rpm   ##### 解壓kernel-devel套件rpm -hiv *.rpm##### 確認目前的kernel版本ls /usr/src/kernels/##### 確認套件版本 uname -r
 2) Aamzon EC2請參照下述移除目前裝的版本rpm -e kernel-devel
kernel版本升級yum install kernel
重開機reboot
確認目前的kernel版本uname -r
再次yum安裝kernel-devel套件yum install kernel-devel-$(uname -r)
確認套件版本ls /usr/src/kernels/
確認iptables版本iptables -V
下載與iptables相對應的套件版本wget xtables-addons-*.tar.xz
Iptables套件載點
#iptables 1.47請用 xtables-addons-1.47.tar.xz
#aws-ec2 請用 xtables-addons-3.0.tar.xz
tar Jxf xtables-addons-1.47.tar.xzcd xtables-addons-1.47./configuremakemake install


編譯遇到以下錯誤   yum -y install iptables-devel ##### 其中若有遇到問題，可調整mconfig中的模組留geoip即可。
   若遇到 xtnu_ipv6_find_hdr’ 錯誤處理程序如下   
使用&#x2F;* *&#x2F;注解此行vim /lib/modules/`uname -r`/build/include/linux/autoconf.h#define CONFIG_IP6_NF_IPTABLES_MODULE 1 #

或是進入extensions資料夾執行sed -i &#x27;/define WITH_IPV6/d&#x27; compat_xtables.c xt_psd.c xt_length2.c xt_TARPIT.c xt_SYSRQ.c xt_RAWNAT.c
   
若鍽譯時遇到 &#x2F;lib&#x2F;modules&#x2F;XXXX.x86_64&#x2F;build&#x2F; 路徑錯誤時重新連結到正確的目錄cd /lib/modules/XXXX.x86_64/rm -rf buildln -s ../../../usr/src/kernels/XXX.x86_64/ build


開始建立IP資料庫cd geoip
若是使用付費版的GeoIP2 Databases源./xt_geoip_dl./xt_geoip_build GeoIPCountryWhois.csv
若是使用免費版的GeoLite2 Databases源需要先注冊一個 maxmind.com 帳號後即可生成一個 License Key   註冊maxmind.com帳號##### 下載轉格式工具程式GeoLite2xtableswget https://github.com/mschmitt/GeoLite2xtables/archive/master.zip    unzip master.zip    cd GeoLite2xtables-master    echo &quot;YOUR_LICENSE_KEY=&#x27;你的金鑰&#x27;&quot; &gt;&gt; geolite2.license    echo &quot;YOUR_LICENSE_KEY=&#x27;tBobMt3HrPTWVJKP&#x27;&quot; &gt;&gt; geolite2.license    ./00_download_geolite2    ./10_download_countryinfo    cat /tmp/GeoLite2-Country-Blocks-IPv4.csv | ./20_convert_geolite2 /tmp/CountryInfo.txt &gt; ../GeoIPCountryWhois.csv    cd ..    ./xt_geoip_build GeoIPCountryWhois.csv
  若是遇到下圖錯誤表示perl缺少模組   
yum install *YAML* perl-CPAN    perl -MCPAN -e shell

#預設回答yes即可
cpan[1]&gt; install NetAddr::IP    cpan[1]&gt; exit      ---      mkdir /usr/share/xt_geoip    mv BE LE /usr/share/xt_geoip/```    ##### 確認是否有安裝成功    ```sqllsmod|grep geoip
   
一行命令中最多可以使用10個國家iptables -I INPUT -m geoip --src-cc PH,KR -j DROP
只允許中國IP的TCP80連線iptables -A except -p TCP --dport 80 -m geoip --src-cc CN -j ACCEPT
只允許中國IP的TCP80、443連線iptables -A except -p TCP -m multiport --dports 80,443 -m geoip --src-cc CN -j ACCEPT
若是要加進火牆shell請用這組iptables -A pig -m geoip --src-cc tw -j DROP
確認規則是不是有吃到iptables -n --list INPUT
   

]]></content>
      <categories>
        <category>Iptables</category>
      </categories>
      <tags>
        <tag>Iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>InfluxDB - 常用語法</title>
    <url>/blog.github.io/2022/08/03/InfluxDB-%E5%B8%B8%E7%94%A8%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[返回具有最新时间戳的点ORDER BY time DESC

時間格式設置--precision rfc3339
在查詢語句的最後加上tz(‘Asia&#x2F;Shanghai’)，這樣查詢的時間纔是糾正爲中國時區顯示 tz(‘Asia&#x2F;Taipei’)tz(&#x27;Asia/Shanghai&#x27;)
查詢某個時間返回的數據，設置時區爲上海時區select * from CPU_ALL where time &gt;= &#x27;2018-11-23 14:30:39&#x27; and time &lt;= &#x27;2019-11-23 14:32:32&#x27; tz(&#x27;Asia/Shanghai&#x27;)
查詢特定字段數據SELECT * FROM &quot;cpu&quot; WHERE time &lt; now() - 5m and &quot;cpu&quot;:~ /cpu0/
創建 measurementinsert myapp,host=127.0.0.1,service=app.service.index qps=1340,rt=1313,cpu=45.23,mem=&quot;4145m&quot;,load=1.21 
查看使用者SHOW USERS
刪除使用者DROP USER &quot;admin-mysql&quot;	
新增使用者CREATE USER jdoe WITH PASSWORD &#x27;1337password&#x27;
新增使用者並給予最高權限CREATE USER jdoe WITH PASSWORD &#x27;1337password&#x27; WITH ALL PRIVILEGES
取消使用者最高權限REVOKE ALL PRIVILEGES FROM &quot;mysql-server&quot;
給予使用者讀 mydb 的權限GRANT READ ON mydb TO &quot;mysql-server&quot;
查詢當前資料庫中含有的表SHOW MEASUREMENTS
查看 key 數據SHOW series from pay
刪除 keyDROP SERIES FROM  WHERE:&#x27;&#x27;```        ### 查看表中的TAG    ```sqlSHOW TAG KEYS FROM &quot;system&quot;
查看表中的TAG-hostSHOW TAG VALUES FROM &quot;system&quot; WITH KEY: &quot;host&quot; 
查詢所有監控項目show field keys
查詢當前資料庫下所有表的第一行記錄SELECT * FROM /.*/ LIMIT 1




]]></content>
      <categories>
        <category>InfluxDB</category>
      </categories>
      <tags>
        <tag>InfluxDB</tag>
      </tags>
  </entry>
  <entry>
    <title>Iptables - 如何利用 ipset 建立 iptables 集合,封鎖 國家 IP</title>
    <url>/blog.github.io/2022/12/05/Iptables-%E5%88%A9%E7%94%A8ipset%E5%BB%BA%E7%AB%8Biptables%E9%9B%86%E5%90%88_%5B%E5%AF%A6%E7%8F%BE%E5%B0%81%E9%8E%96%E5%9C%8B%E5%AE%B6IP%5D/</url>
    <content><![CDATA[
這邊記錄一下並使用 日本IP 實測


ipblocks - 國家 IP 網站


安裝套件 ipset
yum -y install ipset



下載 日本 IP 文件檔
wget http://www.ipdeny.com/ipblocks/data/aggregated/jp-aggregated.zone



使用 ipset 建立一個放 日本IP 的集合
ipset create jpip hash:net maxelem 65536



建立一支 shell 來抓取文件檔中的 IP
vim jpip.sh



   


查看目前集合中IP為 0
ipset list jpip



   


執行 shell 之後集合中的IP為 2946
ipset list jpip |head -n 8



   


查看 list-jpip 中有多少個IP ( tail -n +9 從第九行開始算 )
ipset list jpip |tail -n +9 |wc -l



對照文檔中的 IP數量 是否一致
cat jp-aggregated.zone |wc -l



最後使用 iptables 將此集合中IP進來的封包 DROP掉
iptables -I INPUT -m set --match-set jpip src -j DROP 



   


IPSET 官網


src 表示源地址  dst 表示目標地址
hash:net 表示用什麼進行 hash ，也可以是 hash:ip 就只能 ip 不能網段 hash:ip port ip+port 進行 hash
也可以有 timeout 數字 這種參數，指定這個集合裏默認的超時時間單位 s  超時後會自動把裏面的對象刪除




常用指令
指令意思



ipset del yoda x.x.x.x
從 yoda 集合中刪除內容


ipset list yoda
查看 yoda 集合內容


ipset list
查看所有集合的內容


ipset flush yoda
清空 yoda 集合


ipset flush
清空所有集合


ipset destroy yoda
銷毀 yoda 集合


ipset destroy
銷毀所有集合


ipset save yoda
輸出 yoda 集合內容到標準輸出


ipset save
輸出所有集合內容到標準輸出


ipset restore
根據輸入內容恢復集合內容





]]></content>
      <categories>
        <category>Iptables</category>
      </categories>
      <tags>
        <tag>Iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>Iptables - 參數紀錄</title>
    <url>/blog.github.io/2022/08/03/Iptables-%E5%B8%B8%E7%94%A8%E5%8F%83%E6%95%B8/</url>
    <content><![CDATA[

參數說明：

-F ：清除所有的已訂定的規則；
-X ：殺掉所有使用者建立的 tables ；
-Z ：將所有的 chain 的計數與流量統計都歸零 
-N ：建立新的規則鏈(chain)
-E ：更改指定的規則鏈(chain)名稱
-A ：追加規則:新增規則到某個規則鏈中，該規則將會成為規則鏈中的最後一條規則
-R ：修改規則–&gt;iptables -R INPUT 1 -s 192.168.12.0 -j DROP 取代現行規則，順序不變(1是位置)
-I ：插入規則–&gt;iptables -I INPUT 1 –dport 80 -j ACCEPT 插入一條規則，原本位置上的規則將會往後移動一個順位
-L ：查看規則–&gt;iptables -L INPUT 列出規則鏈中的所有規則
-P ：policy , 定義過濾政策。 也就是未符合過濾條件之封包，預設的處理方式
-t ：參數後跟上要單獨查看的表名 $IPTABLES -F -t nat (清空nat表)
-p ：協定：tcp、upd、icmp…


-m ：模組：state、mac、limit、owner、multiport…
-m state –state :
新的（NEW） — 某個封包請求開啟新的連線，例如 HTTP 請求。
已建立（ESTABLISHED） — 屬於某個現有連線的封包。
相關的（RELATED） — 屬於現有連線的封包，請求開啟一個新的連線，例如被動式 FTP 的連線，其連接埠為 20；但資料傳輸埠則是 1024 以上，未使用的連接埠。
無效的（INVALID） — 在連結追蹤表中，不屬於任何連線的封包。


lo  : 只要是本机进程内相互访问的，都会去到lo这张网卡上，所以在外部IP时对于iptables选择的是eth0这样的网卡，要捕获本机时是lo这个网卡
-o ：網路介面：-o 為 out 網路介面就填 eth0… (用於 POSTROUTING、OUTPUT、FORWARD)
-i ：網路介面：-i 為 in 網路介面就填 eth0… (用於 PREROUTING、INPUT、FORWARD)
-s ：來源：可為 IP Address、IP 網段、網域名稱
–sport：指定封包來源 Port、Port Range (配合 -p tcp、-p udp)
-d ：目的地：可為 IP、IP 網段、網域名稱
–dport：指定封包目的地 Port、Port Range (配合 -p tcp、-p udp)
-j ：政策 &#x2F; 目標：ACCEPT、DROP、REJECT、SNAT、DNAT、MASQUERADE、REDIRECT、RETURN…



]]></content>
      <categories>
        <category>Iptables</category>
      </categories>
      <tags>
        <tag>Iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>Iptables - 常用語法</title>
    <url>/blog.github.io/2022/08/03/Iptables-%E5%B8%B8%E7%94%A8%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[iptables -A [規則] [-s 要動作的IP] [-d 目的地IP] [-p 協定] [-j 動作]查看目前設定iptables -nL
清除所有規則鏈中的規則(不能透過SSH操作,不然會鎖住)    
iptables -F
清除使用者自訂鏈中的規則(不能透過SSH操作,不然會鎖住)
iptables -X
清除mangle表中，所有規則鏈中的規則(不能透過SSH操作,不然會鎖住)
iptables -F -t mangle
查看IP鎖了幾個iptables -n --list pig|wc -l
查看此IP有沒有被鎖在裡面iptables -nL |grep XXX
增加規則except允許此IP 80 port通過iptables -A except -p tcp -s XXX/32 --dport 80 -j ACCEPT
刪除規則pig此IPiptables -D pig -s XXX -j DROP
查看INPUT裡的規則此IPiptables -L INPUT -n --line-numbers |grep &quot;XXX&quot;
以數字的方式顯示pig的總數iptables -n --list pig|wc -l
新建機器執行增加火牆規則./root/iptables/ipfish.sh
iptables 刪除某行規則增加此行規則iptables -A INPUT -s 123.123.123.123 -j DROP # 將 123.123.123.123 全部擋掉
列出所有規則，前面加上行號iptables -L INPUT -n --line-numbers
要刪除某一行的規則iptables -D INPUT 1 # 若只有上述那行，那就是 1iptables -D INPUT 3 # 若有多行，只要刪除第三行
保存iptables規則iptables-save &gt;rules-0


]]></content>
      <categories>
        <category>Iptables</category>
      </categories>
      <tags>
        <tag>Iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>Iptables - 永久關閉指令</title>
    <url>/blog.github.io/2022/09/08/Iptables-%E6%B0%B8%E4%B9%85%E9%97%9C%E9%96%89%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[查看防火牆狀態service iptables status
永久性生效 (重啟不復原)chkconfig iptables on   (開啟)chkconfig iptables off  (關閉)
即時性生效 (重啟後復原)service iptables start  (開啟)service iptables stop   (關閉)
設置後重啟reboot


]]></content>
      <categories>
        <category>Iptables</category>
      </categories>
      <tags>
        <tag>Iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>Iptables - 移除某一條規則</title>
    <url>/blog.github.io/2022/11/18/Iptables-%E7%A7%BB%E9%99%A4%E6%9F%90%E4%B8%80%E6%A2%9D%E8%A6%8F%E5%89%87/</url>
    <content><![CDATA[將規則用號碼列出,並篩出該IPiptables -nL --line-number |grep 52.52.52.52
將該chain裡的第41行砍掉iptables -D deny 41


]]></content>
      <categories>
        <category>Iptables</category>
      </categories>
      <tags>
        <tag>Iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>Iptables - 如何轉發 PORT</title>
    <url>/blog.github.io/2022/10/20/Iptables-%E8%BD%89%E7%99%BCPORT%E8%99%9F/</url>
    <content><![CDATA[   將 80 PROT 轉向 8000 PORTiptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 8000
   利用 OUTPUT 的規則，從本機連到自己iptables -t nat -A OUTPUT -p tcp -d localhost --dport 80 -j REDIRECT --to-ports 8000


]]></content>
      <categories>
        <category>Iptables</category>
      </categories>
      <tags>
        <tag>Iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - ERROR-Metric client health check failed</title>
    <url>/blog.github.io/2022/10/10/Kubernetes-ERROR-Metric_client_health_check_failed/</url>
    <content><![CDATA[
“k8s dashboard 報錯: (404) the server could not find the requested resource”


dashboard 出現以下畫面   


查看 dashboard pod 的 LOG# kubectl get pods -n kube-system|grep dashkubernetes-dashboard-6ff6454fdc-78fnx   1/1     Running   0          4h8m



K8s LOG 報錯 Metric client health check failed: the server could not find the requested resource (get services heapster). Retrying in 30 seconds   
**原因: kubernets用的比较高的版本，但dashboard版本用的比较低，因此報錯**
解決: 重新安裝 dashboard 版本先將舊的版本刪除 (將 dashboard 的 NS 刪除即可)kubectl delete ns kubernetes-dashboard

查看 kubernetes 版本$ kubectl version --shortFlag --short has been deprecated, and will be removed in the future. The --short output will become the default.Client Version: v1.25.2Kustomize Version: v4.5.7Server Version: v1.25.0
根據 kubernetes 版本 下載相對應的 dashboard 版本下載網址連結



dashboard
對應版本



dashboard v2.0.0-beta5
—&gt; kubernetes 1.16


dashboard v2.0.0
kubernetes 1.18


dashboard v2.0.1
kubernetes 1.18


dashboard v2.0.2
kubernetes 1.18


dashboard v2.0.3
kubernetes 1.18


dashboard v2.0.4
kubernetes 1.19


dashboard v2.0.5
kubernetes 1.19


dashboard v2.1.0
kubernetes 1.20


dashboard v2.2.0
kubernetes 1.20


dashboard v2.3.0
kubernetes 1.21


dashboard v2.3.1
kubernetes 1.21


wget 下來修改 Service 的部分wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml

修改為 Nodeport 方式訪問vim recommended.yamlkind: ServiceapiVersion: v1metadata:  labels:    k8s-app: kubernetes-dashboard  name: kubernetes-dashboard  namespace: kubernetes-dashboardspec:  type: NodePort #新添加的  ports:    - port: 443      targetPort: 8443      nodePort: 30003 #新添加的（可以改成其它的端口号，要大于30000）  selector:    k8s-app: kubernetes-dashboard


執行 yaml 文件kubectl apply -f recommended.yamlnamespace/kubernetes-dashboard createdserviceaccount/kubernetes-dashboard createdservice/kubernetes-dashboard createdsecret/kubernetes-dashboard-certs createdsecret/kubernetes-dashboard-csrf createdsecret/kubernetes-dashboard-key-holder createdconfigmap/kubernetes-dashboard-settings createdrole.rbac.authorization.k8s.io/kubernetes-dashboard createdclusterrole.rbac.authorization.k8s.io/kubernetes-dashboard createdrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard createdclusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard createddeployment.apps/kubernetes-dashboard createdservice/dashboard-metrics-scraper createddeployment.apps/dashboard-metrics-scraper created

建立 dashboard 管理員vim dashboard-admin.yamlapiVersion: v1kind: ServiceAccountmetadata:  labels:    k8s-app: kubernetes-dashboard  name: dashboard-admin  namespace: kubernetes-dashboardkubectl create -f dashboard-admin.yaml

建立 RBAC 分配權限vim dashboard-admin-role.yaml         apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata:   name: dashboard-admin-role   labels:     k8s-app: kubernetes-dashboard roleRef:   apiGroup: rbac.authorization.k8s.io   kind: ClusterRole   name: cluster-admin subjects: - kind: ServiceAccount   name: dashboard-admin   namespace: kubernetes-dashboard         kubectl create -f dashboard-admin-role.yaml
查看是否創建成功kubectl get secret -n kubernetes-dashboard    NAME                               TYPE                                  DATA   AGEdashboard-admin-token-fj9v6        kubernetes.io/service-account-token   3      95sdefault-token-lj7xg                kubernetes.io/service-account-token   3      33mkubernetes-dashboard-certs         Opaque                                0      33mkubernetes-dashboard-csrf          Opaque                                1      33mkubernetes-dashboard-key-holder    Opaque                                2      33mkubernetes-dashboard-token-cdkzc   kubernetes.io/service-account-token   3      33m

dashboard-admin-token 是剛剛創建的，再篩出 TOKEN 即可
kubectl describe -n kubernetes-dashboard secret/dashboard-admin-token-fj9v6|grep token:token:      eyJhbGciOiJSUzI1NiIsImtpZCI6ImJyYjJDR18tMDQtdkc3MzBBN0RwQU8zTlVjV01PM2w0dGRBWVh5UXhPN3MifQ.eyJpc3MiOiJrdWJlcm5ldGVz



驗證 : 輸入 https://172.16.0.223:30003 即可訪問 Dashboard ， 並輸入剛剛篩出的 TOKEN

   


]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - ERROR-unable to create new content is being terminated</title>
    <url>/blog.github.io/2022/10/12/Kubernetes-ERROR-unable_to_create_new_content_is_being_terminated/</url>
    <content><![CDATA[
“Namespace-kubernetes-dashboard 一直卡在 termnating，所以導致無法有效刪除.”


查看 namespace
kubectl get ns
   


查看 kubernetes-dashboard 的 namespace
kubectl get ns kubernetes-dashboard  -o json &gt; kubernetes-dashboard.json



編輯 kubernetes-dashboard.json 檔
vim kubernetes-dashboard.json



刪除前
   


刪除後
   


重新掛起 Proxy
kubectl proxy --address=&#x27;0.0.0.0&#x27; &amp;



curl刪除
curl -k -H &quot;Content-Type:application/json&quot; -X PUT --data-binary @kubernetes-dashboard.json http://127.0.0.1:8001/api/v1/namespaces/kubernetes-dashboard/finalize



kubernetes-dashboard 已刪除
   



]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - Ingress 實作測試紀錄</title>
    <url>/blog.github.io/2022/10/12/Kubernetes-Ingress/</url>
    <content><![CDATA[

Docker file包製作
mkdir dockerfile/ &amp;&amp; cd dockerfile/    vim Dockerfile#/bin/bash  FROM nginxARG HTML     #Change nginx configRUN rm /usr/share/nginx/html/index.htmlCOPY ./$HTML /usr/share/nginx/html/index.html



製作測試頁 (綠)
vim green.html     &lt;!DOCTYPE html&gt;   &lt;head&gt;       &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;   &lt;/head&gt;   &lt;body style=&quot;background-color: green; color:#fff&quot;&gt;     &lt;h1&gt;2022/10/12 ---Ingress-test&lt;/h1&gt;     &lt;table&gt;         &lt;tbody&gt;               &lt;tr&gt;                   &lt;td&gt;Author&lt;/td&gt;                   &lt;td&gt;: Laurance&lt;/td&gt;               &lt;/tr&gt;               &lt;tr&gt;                   &lt;td&gt;Article Link&lt;/td&gt;                   &lt;td&gt;: &lt;a href=&quot;https://note.laurance.ml&quot; target=&quot;_blank&quot;&gt;2022/10/12 ---Ingress-test&lt;/a&gt;&lt;/td&gt;               &lt;/tr&gt;               &lt;tr&gt;                   &lt;td&gt;Topic&lt;/td&gt;                   &lt;td&gt;: &lt;a href=&quot;https://note.laurance.ml&quot; target=&quot;_blank&quot;&gt;2022/10/12 ---Ingress-test&lt;/a&gt;&lt;/td&gt;               &lt;/tr&gt;         &lt;/tbody&gt;     &lt;/table&gt;   &lt;/body&gt;   &lt;/html&gt;



製作測試頁 (紅)
vim red.html     &lt;!DOCTYPE html&gt;   &lt;head&gt;       &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;   &lt;/head&gt;   &lt;body style=&quot;background-color: red; color:#fff&quot;&gt;     &lt;h1&gt;2022/10/12 ---Ingress-test&lt;/h1&gt;     &lt;table&gt;         &lt;tbody&gt;               &lt;tr&gt;                   &lt;td&gt;Author&lt;/td&gt;                   &lt;td&gt;: Laurance&lt;/td&gt;               &lt;/tr&gt;               &lt;tr&gt;                   &lt;td&gt;Article Link&lt;/td&gt;                   &lt;td&gt;: &lt;a href=&quot;https://note.laurance.ml&quot; target=&quot;_blank&quot;&gt;2022/10/12 ---Ingress-test&lt;/a&gt;&lt;/td&gt;               &lt;/tr&gt;               &lt;tr&gt;                   &lt;td&gt;Topic&lt;/td&gt;                   &lt;td&gt;: &lt;a href=&quot;https://note.laurance.ml&quot; target=&quot;_blank&quot;&gt;2022/10/12 ---Ingress-test&lt;/a&gt;&lt;/td&gt;               &lt;/tr&gt;         &lt;/tbody&gt;     &lt;/table&gt;   &lt;/body&gt;   &lt;/html&gt;



使用 docker build 建立 image
docker build --build-arg HTML=green.html -t laurance/green .    docker build --build-arg HTML=red.html -t laurance/red .



更改 TAG 名稱為 docker 用戶名 &#x2F; image 名稱
docker tag laurance/red ihatemis/red    docker tag laurance/green ihatemis/green



上傳至 Docker hub ，需要先 docker login
docker push ihatemis/red:latest    docker push ihatemis/green:latest



  Deplymentvim ingress.deployment.yaml      #apiVersion: extensions/v1beta1   apiVersion: apps/v1   kind: Deployment   metadata:       name: red-nginx       namespace: simple2   spec:     selector:       matchLabels:         app: red-nginx     replicas: 4     template:       metadata:         labels:           app: red-nginx       spec:         containers:         - name: nginx           image: ihatemis/red:latest           ports:           - containerPort: 80---      #apiVersion: extensions/v1beta1   apiVersion: apps/v1   kind: Deployment   metadata:       name: green-nginx       namespace: simple2   spec:     selector:       matchLabels:         app: green-nginx     replicas: 2     template:       metadata:         labels:           app: green-nginx       spec:         containers:         - name: nginx           image: ihatemis/green:latest           ports:           - containerPort: 80

建立 ingress.deployment.yaml
kubectl apply -f ingress.deployment.yaml 



   servicevim ingress.service.yaml      apiVersion: v1   kind: Service   metadata:     name: green-service     namespace: simple2   spec:     type: NodePort     selector:       app: green-nginx     ports:       - protocol: TCP         port: 80        ---   apiVersion: v1   kind: Service   metadata:     name: red-service     namespace: simple2   spec:     type: NodePort     selector:       app: red-nginx     ports:       - protocol: TCP         port: 80
建立 ingress.service.yaml
kubectl apply -f ingress.service.yaml



   Ingressvim ingress.yaml      #apiVersion: extensions/v1beta1   apiVersion: networking.k8s.io/v1   kind: Ingress   metadata:     name: web     namespace: simple2     annotations:       nginx.ingress.kubernetes.io/rewrite-target: /   spec:     rules:     - host: green.ingress.com       http:         paths:           - path: /             pathType: Prefix             backend:               service:                 name: green-service                 port:                   number: 80     - host: red.ingress.com       http:         paths:           - path: /             pathType: Prefix             backend:               service:                 name: red-service                 port:                   number: 80
建立 kubectl apply -f ingress.yaml
kubectl apply -f ingress.yaml 



將域名綁至 HOSTS 測試
172.16.0.223 red.ingress.com green.ingress.com



訪問 http://red.ingress.com
   


訪問 http://green.ingress.com
       



]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - Install and Set Up kubectl on Linux</title>
    <url>/blog.github.io/2022/10/06/Kubernetes-Install_and_Set_Up_kubectl_on_Linux/</url>
    <content><![CDATA[
CURL 官方安裝版本


(1) 在 Linux 上安裝帶有 curl 的 kubectl 二進位檔 (最新)curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot;

注意：要下載特定版本，請將命令部分替換為特定版本。  $curl -L -s https://dl.k8s.io/release/stable.txt
例如，要在Linux上下載 v1.25.0 版本，輸入：
curl -LO https://dl.k8s.io/release/v1.25.0/bin/linux/amd64/kubectl



(2) 驗證二進位檔 (選擇)下載 kubectl 校驗和檔：
curl -LO &quot;https://dl.k8s.io/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl.sha256&quot;
根據校驗和文件驗證 kubectl 二進位檔：
echo &quot;$(cat kubectl.sha256)  kubectl&quot; | sha256sum --check
如果有效，則輸出為：
kubectl: OK
如果檢查失敗，則以非零狀態退出並列印類似於以下內容的輸出：sha256
kubectl: FAILEDsha256sum: WARNING: 1 computed checksum did NOT match```    `**注意：下載相同版本的二進位檔和校驗和。**`******## **(3) 安裝 kubectl**```sqlsudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
如果在目標系統上沒有根訪問許可權，仍然可以將 kubectl 安裝到該目錄：~/.local/bin&lt;/font&gt;	
chmod +x kubectl    mkdir -p ~/.local/bin    mv ./kubectl ~/.local/bin/kubectl    # and then append (or prepend) ~/.local/bin to $PATH



(4) 測試確保安裝的版本是最新的：kubectl version --client
或者使用以下內容檢視：
kubectl version --client --output=yaml




]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - Install kubectl on Linux by yum</title>
    <url>/blog.github.io/2022/10/06/Kubernetes-Install_kubectl_on_Linux_by_yum/</url>
    <content><![CDATA[
yum 官方安裝版本


新增yum源
cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo[kubernetes]name=Kubernetesbaseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-\$basearchenabled=1gpgcheck=1gpgkey=https://packages.cloud.google.com/yum/doc/rpm-package-key.gpgEOF


使用YUM安裝
sudo yum install -y kubectl kubelet kubeadm



開機啟動
systemctl enable kubelet




]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - Lens 使用指南 : 透過 IDE 管理 minikube</title>
    <url>/blog.github.io/2022/10/10/Kubernetes-Lens_%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97_%E9%80%9A%E9%81%8EIDE%E7%AE%A1%E7%90%86_minikube/</url>
    <content><![CDATA[安装 LENS on Windows x64
LENS 官方載點
   


右上三條線點選 File &gt;&gt; Add Cluster 新增集群
   


回到測試機上查看 minikube 設定檔
kubectl config view 
   


將測試機裡的 .minikube 隱藏檔資料夾 winscp 取出放到對應位置
PWD: /root/.minikube

     


將測試機裡的 .kube 隱藏檔資料夾 winscp 取出放到對應位置，並修改路徑   
PWD: /root/.kube
   


將 .kube 下的 config 內容貼至 LENS &gt;&gt; File &gt;&gt; Add Cluster 新增集群
   


雙擊連接即可
   



]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - install minikube on Linux</title>
    <url>/blog.github.io/2022/10/06/Kubernetes-install_minikube_on_Linux/</url>
    <content><![CDATA[

前置關閉 swap 註解即可
vim /etc/fstab


依賴
yum install conntrack


在 /etc/hosts 新增 hostname
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4 laurance





Kubernetes 1.24+ 已從上游刪除了 dockershim

需要在系統上安裝 cri-dockerd

cri-dockerd 安裝wget https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repoyum -y install docker-cesystemctl enable docker &amp;&amp; systemctl start dockerdocker version



安裝 minikube
添加 YUM源
cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt; EOF[kubernetes]name=Kubernetesbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64enabled=1gpgcheck=0repo_gpgcheck=0gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpgEOF



安裝 kubectl
yum install -y kubectlusermod -aG docker $USER &amp;&amp; newgrp docker



下載 minikube
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64install minikube-linux-amd64 /usr/local/bin/minikubechmod +x /usr/local/bin/minikube



啟動集群

minikube start --force --driver=docker --cni calico  --registry-mirror=https://registry.docker-cn.com --container-runtime=containerdminikube status




]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - install cri-dockerd on Linux</title>
    <url>/blog.github.io/2022/10/10/Kubernetes-install_cri_dockerd_on_Linux/</url>
    <content><![CDATA[

從cri-dockerd GitHub 頁面下載適當的二進制包
wget https://github.com/Mirantis/cri-dockerd/releases/download/v0.2.0/cri-dockerd-v0.2.0-linux-amd64.tar.gz
解壓縮包
tar xvf cri-dockerd-v0.2.0-linux-amd64.tar.gz



將 cri-dockerd 二進製文件移動到 usr&#x2F;local&#x2F;bin 目錄
mv ./cri-dockerd /usr/local/bin/ 



配置 systemd
wget https://raw.githubusercontent.com/Mirantis/cri-dockerd/master/packaging/systemd/cri-docker.service    wget https://raw.githubusercontent.com/Mirantis/cri-dockerd/master/packaging/systemd/cri-docker.socket    mv cri-docker.socket cri-docker.service /etc/systemd/system/sed -i -e &#x27;s,/usr/bin/cri-dockerd,/usr/local/bin/cri-dockerd,&#x27; /etc/systemd/system/cri-docker.service



啟用 cri-dockerd 
systemctl daemon-reload    systemctl enable cri-docker.service    systemctl enable --now cri-docker.socket



驗證該服務是否正在運行
systemctl status cri-docker.socket




]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - 在本地端上建立 Dashboard</title>
    <url>/blog.github.io/2022/10/10/Kubernetes-%E5%9C%A8%E6%9C%AC%E5%9C%B0%E7%AB%AF%E4%B8%8A%E5%BB%BA%E7%AB%8B_Dashboard/</url>
    <content><![CDATA[ Github Kubernetes Dashboard 這裡記錄一下安裝的過程


kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml

   


這樣就安裝好了，然後看一下正在運行的容器
kubectl get all -n kube-system -l k8s-app=kubernetes-dashboard
   


先把Iptables規則打開 (預設FORWARD是關閉的)
iptables -P FORWARD ACCEPT



確認火牆都關閉 firewalld &amp;&amp; selinux
systemctl stop firewalld    getenforce &gt;&gt; disabled



設置一層代理讓外部訪問 dashboard
kubectl proxy --address=&#x27;0.0.0.0&#x27; --disable-filter=true &amp;
PS. disable-filter=true表示禁用請求過濾功能，否則我們的請求會被拒絕，並提示 Forbidden (403) Unauthorized
   


訪問 dashboard
http://172.16.0.223:8001/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/#/service?namespace=default
   



]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - 常見 minikube 指令</title>
    <url>/blog.github.io/2022/10/10/Kubernetes-%E5%B8%B8%E8%A6%8Bminikube%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[插件列表
minikube addons list

插件啟用
minikube addons enable ADDON_NAME

插件禁用
minikube addons disable ADDON_NAME
不使用任何驅動開啟集群
minikube start --driver=none

停止集群
minikube stop
删除集群
minikube delete

不影响已部署应用情况下暂停 Kubernetes
minikube pause
取消暂停的instance
minikube unpause
增加默认内存限制（需重启）
minikube config set memory 16384
各節點操作
minikube node [add|start|stop|delete|list]

額外啟動參數镜像所在国家--image-mirror-country=cn 

镜像仓库地址--image-repository=registry.cn-hangzhou.aliyuncs.com/google_containers

设置minikube虚拟机分配CPU核数--cpus=2

设置minikube虚拟机分配内存--memory=2000mb

使用的kubernetes版本--kubernetes-version=version

minikube虚拟机内部docker使用代理地址--docker-env http_proxy=http://IP:7890 http_proxy=https://IP:7890
指定驱动在主机上运行Kubernetes组件，而不是在VM中,该方式驱动依赖Docker--vm-driver=none

表示用虚拟机,默认--vm-driver=virtualbox
**PS. 不通过--vm-driver=none参数启动，则创建的Pod、Service均不能通过外网访问**
**只能minikube ssh 进入集群访问操作**
參考文獻

]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>Kubernetes - 常見 kubectl 指令</title>
    <url>/blog.github.io/2022/10/10/Kubernetes-%E5%B8%B8%E8%A6%8Bkubectl%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[取得所有 Pods 的資訊
kubectl get pods -o wide

取得某 Pod 的詳細資料
kubectl describe pod &lt;pod Name&gt;

修改 Pods 的資訊
kubectl edit pods -n &lt;namespace&gt; &lt;pod Name&gt;```    **查看 Pods 事件**```sqlkubectl describe pod &lt;pod Name&gt;

查看 Pods 日志文件
kubectl logs -f &lt;pod Name&gt;```    **刪除這個 pod**```sqlkubectl delete -f pod-demo.yaml

使用 yaml 創建 Pods
kubectl apply -f laurance-test.yaml
進入 Pods 內部
kubectl exec -it &lt;pod Name&gt; /bin/bash
查看各節點狀態
kubectl get node &lt;node name&gt;
查看各節點事件
kubectl describe node &lt;node name&gt;
查看系统 Kubelet 日志 1000行
journalctl -l -u kubelet -n 1000
將 YAML 導出
kubectl get service &lt;serviceName&gt; -o yaml &gt; backup.yaml

檢查叢集狀態
kubectl get all



]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title>LINE - BOT 串接 Dialogflow 操作紀錄</title>
    <url>/blog.github.io/2022/12/05/LINE-BOT_%E4%B8%B2%E6%8E%A5Dialogflow/</url>
    <content><![CDATA[

GCP 後台搜尋服務 Dialogflow


   


選取 Dialogflow 控制台


   


這邊選擇舊專案 (原本沒有的話點新增)


   
   


新增 agent (因為當初建專案時,選擇的是免費地區,所以這邊才只能選 global)


   


選擇 Manage , 點擊需要串接 Webhook 的 Intent 
進入後在最下方勾選「Enable webhook call for this intent」，表示該 Intent 會透過 Webhook 處理後再進行回覆


   


選擇 Intergrations 與 LINE 串接


   
   


將 LINE 的 ID 及 TOKEN 依序填入 Configuration


   
   
   


最後將 Webhook URL 複製到 LINE 後台上的 Webhook settings 


   
   


串接流程圖

   



]]></content>
      <categories>
        <category>Line</category>
      </categories>
      <tags>
        <tag>Line</tag>
      </tags>
  </entry>
  <entry>
    <title>LINE - Notify 操作紀錄</title>
    <url>/blog.github.io/2022/11/10/LINE-Notify/</url>
    <content><![CDATA[

登入 LINE Notify


   


選擇要接收通知的聊天室


   


把產生的權證記錄下來


   


API

   


   參考

]]></content>
      <categories>
        <category>Line</category>
      </categories>
      <tags>
        <tag>Line</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - History 增加時間顯示</title>
    <url>/blog.github.io/2022/08/16/Linux-History%E5%A2%9E%E5%8A%A0%E6%99%82%E9%96%93%E9%A1%AF%E7%A4%BA/</url>
    <content><![CDATA[

臨時添加exprt HISTTIMEFORMAT=’%F %T ’



永久套用  vim ~/.bashrc HISTTIMEFORMAT=&quot;%F %T &quot;source .bashrc



寫入 &#x2F;etc&#x2F;profile 達到全體套用vim /etc/profileHISTTIMEFORMAT=&quot;%F %T &quot;    source /etc/profile```    ********Shell 執行的方法**-----```sqlecho &#x27;HISTTIMEFORMAT=&quot;%F %T &quot;&#x27; &gt;&gt; /etc/profilesource /etc/profile




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - Logrotate 參數</title>
    <url>/blog.github.io/2022/08/03/Linux-Logrotate_%E5%8F%83%E6%95%B8/</url>
    <content><![CDATA[

daily 指定轉儲週期爲每天


weekly 指定轉儲週期爲每週


monthly 指定轉儲週期爲每月


rotate count 指定日誌文件刪除之前轉儲的次數，0 指沒有備份，5 指保留 5 個備份


tabooext [+] list 讓 logrotate 不轉儲指定擴展名的文件，缺省的擴展名是：.rpm-orig, .rpmsave, v, 和 ～


missingok 在日誌輪循期間，任何錯誤將被忽略，例如 “文件無法找到” 之類的錯誤。


size size 當日志文件到達指定的大小時才轉儲，bytes (缺省) 及 KB (sizek) 或 MB (sizem)


compress 通過 gzip 壓縮轉儲以後的日誌


nocompress 不壓縮


copytruncate 用於還在打開中的日誌文件，把當前日誌備份並截斷


nocopytruncate 備份日誌文件但是不截斷


create mode owner group  轉儲文件，使用指定的文件模式創建新的日誌文件


nocreate 不建立新的日誌文件


delaycompress 和 compress 一起使用時，轉儲的日誌文件到下一次轉儲時才壓縮


nodelaycompress 覆蓋 delaycompress 選項，轉儲同時壓縮。


errors address  專儲時的錯誤信息發送到指定的 Email 地址


ifempty 即使是空文件也轉儲，這個是 logrotate 的缺省選項。


notifempty 如果是空文件的話，不轉儲


mail address  把轉儲的日誌文件發送到指定的 E-mail 地址


nomail  轉儲時不發送日誌文件


olddir directory 儲後的日誌文件放入指定的目錄，必須和當前日誌文件在同一個文件系統


noolddir 轉儲後的日誌文件和當前日誌文件放在同一個目錄下


prerotate/endscript 在轉儲以前需要執行的命令可以放入這個對，這兩個關鍵字必須單獨成行


Log 保留三天 , 執行完畢 , Nginx 重啟
/usr/local/web/nginx/logs/*.acc &#123;        daily        rotate 3        create        sharedscripts        postrotate             /usr/local/web/nginx/sbin/nginx -s reload        endscript    &#125;





]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Logrotate</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - Crontab 實現以秒為單位排程</title>
    <url>/blog.github.io/2022/08/03/Linux-Crontab%E5%AF%A6%E7%8F%BE%E4%BB%A5%E7%A7%92%E7%82%BA%E5%96%AE%E4%BD%8D%E6%8E%92%E7%A8%8B/</url>
    <content><![CDATA[

方法一	(設置crontab)

EX:	(每10秒執行一次)





php &#x2F;root&#x2F;test&#x2F;php&#x2F;crontab&#x2F;tolog.php












sleep 10; php &#x2F;root&#x2F;test&#x2F;php&#x2F;crontab&#x2F;tolog.php












sleep 20; php &#x2F;root&#x2F;test&#x2F;php&#x2F;crontab&#x2F;tolog.php












sleep 30; php &#x2F;root&#x2F;test&#x2F;php&#x2F;crontab&#x2F;tolog.php












sleep 40; php &#x2F;root&#x2F;test&#x2F;php&#x2F;crontab&#x2F;tolog.php












sleep 50; php &#x2F;root&#x2F;test&#x2F;php&#x2F;crontab&#x2F;tolog.php











方法二   設置腳本 shell-script

EX:最多每2秒執行
  #/bin/bash    step=2 #間隔的秒數for (( i=0; i &lt; 60; i=(i+step) )); do    XXX 動作 XXX    sleep $stepdone    exit 0




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Crontab</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - Nodejs 安裝紀錄</title>
    <url>/blog.github.io/2022/08/03/Linux-Nodejs-%E5%AE%89%E8%A3%9D/</url>
    <content><![CDATA[

yum install epel-releaseyum install nodejswget https://nodejs.org/download/release/v8.9.4/node-v8.9.4-linux-x64.tar.gztar --strip-components 1 -xzvf node-v* -C /usr/localnode -vnpm -v




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>NodeJS</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - Rsync 基本設定</title>
    <url>/blog.github.io/2023/02/03/Linux-Rsync%E5%9F%BA%E6%9C%AC%E8%A8%AD%E5%AE%9A%E6%95%99%E5%AD%B8/</url>
    <content><![CDATA[

測試環境A主機 ( Server端 ) IP :192.168.1.222
B主機 ( Clinet端 ) IP :192.168.1.122



B主機( Clinet端 ) 設定安裝服務yim install xinetd rsync
修改服務設定 xinetd.confvim /etc/xinetd.d/rsync    service rsync&#123;        disable        : no        socket_type    : stream        wait           : no        user           : root        server         : /usr/bin/rsync        server_args    : --daemon        log_on_failure  += USERID&#125;

修改服務設定 rsyncd.confvim /etc/rsyncd.conf        [update]path:          /auth users:    updatehosts allow:   XX.XX.XX.XX  //來源IPuid:           rootgid:           rootsecrets file:  /etc/rsync.secretsread only:     no

設定帳號密碼vim /etc/rsync.secrets    update:123abc

啟動服務systemctl start xinetd




A主機 (Server端) 設定設定密碼即可vim rsync.secrets    123abc
同步語法rsync -aHSz  --delete --contimeout=5 --password-file=/etc/rsync.secrets /hugoserver update@XX.XX.XX.XX::update



]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Rsync</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - SNMP 常用監控_OID</title>
    <url>/blog.github.io/2023/08/03/Linux-SNMP_%E5%B8%B8%E7%94%A8%E7%9B%A3%E6%8E%A7_OID/</url>
    <content><![CDATA[

Linux 常用的監控 SNMP_OID

EX:snmpwalk -v 2c -c public 127.0.0.1 OID  



負載 Loading
1 minute Load: .1.3.6.1.4.1.2021.10.1.3.15 minute Load: .1.3.6.1.4.1.2021.10.1.3.215 minute Load: .1.3.6.1.4.1.2021.10.1.3.3



CPU
用戶CPU時間百分比：.1.3.6.1.4.1.2021.11.9.0原始用戶CPU時間：.1.3.6.1.4.1.2021.11.50.0系統 CPU 時間百分比：.1.3.6.1.4.1.2021.11.10.0原始系統CPU時間：.1.3.6.1.4.1.2021.11.52.0空閒 CPU 時間百分比：.1.3.6.1.4.1.2021.11.11.0原始空閒 CPU 時間：.1.3.6.1.4.1.2021.11.53.0原始良好的CPU時間：.1.3.6.1.4.1.2021.11.51.0



內存 RAM
總交換規模：.1.3.6.1.4.1.2021.4.3.0可用交換空間：.1.3.6.1.4.1.2021.4.4.0機器中的總 RAM：.1.3.6.1.4.1.2021.4.5.0使用的總內存：.1.3.6.1.4.1.2021.4.6.0可用 RAM 總量：.1.3.6.1.4.1.2021.4.11.0共享 RAM 總量：.1.3.6.1.4.1.2021.4.13.0緩衝 RAM 總量：.1.3.6.1.4.1.2021.4.14.0總緩存內存：.1.3.6.1.4.1.2021.4.15.0



硬碟容量
磁盤掛載路徑：.1.3.6.1.4.1.2021.9.1.2.1分區設備路徑：.1.3.6.1.4.1.2021.9.1.3.1磁盤/分區的總大小（KB）：.1.3.6.1.4.1.2021.9.1.6.1磁盤上的可用空間：.1.3.6.1.4.1.2021.9.1.7.1磁盤上已用空間：.1.3.6.1.4.1.2021.9.1.8.1磁盤上已使用空間的百分比：.1.3.6.1.4.1.2021.9.1.9.1磁盤上使用的 inode 百分比：.1.3.6.1.4.1.2021.9.1.10.1



系統運行時間
.1.3.6.1.2.1.1.3.0



參考文件





]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>SNMP</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - VIM 常用參數 &amp; 快捷鍵</title>
    <url>/blog.github.io/2022/08/03/Linux-VIM%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[

永久新增 標註行數vim /etc/vimrc

加上參數 set nuset nu



VIM 常用編輯快捷鍵

複製 y 常用的命令如下:


快捷命令
意思解說



y
在使用 v 模式選定了某一塊的時候,複製選定塊到緩衝區用


yy
複製整行( nyy 或者 yny ,複製 n 行 , n 為數字)


y^
複製當前到行頭的內容


y$
複製當前到行尾的內容


yw
複製一個word (nyw 或者 ynw , 複製 n 個 word , n 為數字)


yG
複製至檔尾 (nyG 或者 ynG , 複製到第 n 行,例如 1yG 或者 y1G , 複製到檔尾)




剪下 d 常用的命令如下:


快捷命令
意思解說



d
剪下選定塊到緩衝區


dd
剪下整行


d^
剪下至行首


d$
剪下至行尾


dw
剪下一個word


dG
剪下至檔尾




貼上 p 常用的命令如下:


快捷命令
意思解說



p
小寫 p 代表貼至遊標後


P
大寫P代表貼至遊標前




注:在正則表示式中,^表示匹配字串的開始位置,$表示匹配字串的結束位置。命令前面加數字表示重複的次數,加字母表示使用的緩衝區名稱。使用英文句號”.”可以重複上一個命令。在複製貼上時,另一組常用的命令是u(撤銷操作),U(撤銷某一行最近所有修改),Ctrl+R(重做),這些功能主要是vim中的,vi中略有差別
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>VIM</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - UNAR 安裝 &amp; 解壓 rar檔</title>
    <url>/blog.github.io/2023/08/03/Linux-UNAR%E5%AE%89%E8%A3%9D%E8%A7%A3%E5%A3%93-rar%E6%AA%94/</url>
    <content><![CDATA[

安裝 unaryum install epel-releaseyum install unar



解壓unar example.rar



解壓到指定目錄unar -o /tmp/example.rar



帶密碼解壓unar -p 123456 centos.rar



列出壓縮內容lsar centos.rar



指定編碼unar -e GBK centos.rar




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>RAR</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - youtube-dl &amp;&amp; ffmpeg 安裝教學 &amp;&amp; yt-dlp 安裝</title>
    <url>/blog.github.io/2023/02/13/Linux-youtube-dl_ffmpeg_%E5%AE%89%E8%A3%9D%E6%95%99%E5%AD%B8/</url>
    <content><![CDATA[

youtube-dl 安裝youtube-dl官方連結


安裝最新穩定版本curl -L https://yt-dl.org/downloads/latest/youtube-dl -o /usr/bin/youtube-dl

給予權限chmod a+rx /usr/bin/youtube-dl

查看版本youtube-dl --version

若要更新版本youtube-dl --update



ffmpeg 安裝ffmpeg官方連結
安裝依賴yum install yasm

下載官方 tar 包wget https://ffmpeg.org/releases/ffmpeg-5.1.2.tar.gz

解壓 &amp;&amp; 安裝tar zxvf ffmpeg-5.1.2.tar.gz    ./configure --prefix=/usr/local/ffmpeg --enable-openssl --enable-protocols --enable-protocol=https    make &amp;&amp; make install
建立 Linkln -s /usr/local/ffmpeg/bin/ffmpeg /usr/bin/ffmpegln -s /usr/local/ffmpeg/bin/ffprobe /usr/bin/ffprobe```    ### 查看版本```sqlffmpeg -version



yt-dlp 安裝

python3 -m pip install -U yt-dlpyt-dlp --version



參考: https://guopengzhen.com/%E7%BF%BB%E8%AF%91/205/

]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>youtube-dl</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 實現免密碼複製遠端檔案 (scp)</title>
    <url>/blog.github.io/2022/12/10/Linux-%E4%BD%BF%E7%94%A8SSH%E9%85%8D%E5%90%88%E6%86%91%E8%AD%89%E4%BE%86%E9%81%A0%E7%AB%AF%E8%A4%87%E8%A3%BD%E6%AA%94%E6%A1%88_(scp)/</url>
    <content><![CDATA[

測試環境 :( 來源 ) A 機( 目的 ) B 機

A 機設置 :在家目錄新增 公鑰 及 私鑰ssh-keygen -t dsa

新增完後, 在 .ssh/ 目錄裡，會多出 id_rsa 和 id_rsa.pub 這兩個檔案





將 A 機  id_dsa.pub  的內容複製到 B 機家目錄下 並命名為 authorized_keys  限制讀寫權限cat id_rsa.pub &gt; authorized_keys    chmod 600 authorized_keys



PS. 若是有多個  id_rsa.pub 需要設定 (注意!!! 需要在第一步選擇路徑)
ssh-keygen -t rsa
第一步需填寫路徑 其餘 ENTER 即可
Enter file in which to save the key (/root/.ssh/id_rsa): /root/.ssh/id_rsa_root









]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - yum 安裝報錯 Fix error: rpmdb: BDB0113 Thread/process</title>
    <url>/blog.github.io/2023/08/03/Linux-yum_%E5%AE%89%E8%A3%9D%E5%A0%B1%E9%8C%AF-error_rpmdb_BDB0113/</url>
    <content><![CDATA[

Fix “error: rpmdb: BDB0113 Thread&#x2F;process – Thread died in Berkeley DB library | rpmdb open failed” – CentOS 7




解決方法 :


mv /var/lib/rpm/__db* /tmp/yum clean all



]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - history 命令保存的最大數</title>
    <url>/blog.github.io/2022/12/10/Linux-history%E5%91%BD%E4%BB%A4%E4%BF%9D%E5%AD%98%E7%9A%84%E6%9C%80%E5%A4%A7%E6%95%B8/</url>
    <content><![CDATA[

~&#x2F;.bash_history 裡面紀錄的是上一次登出的歷史紀錄 (默認保存1000條)

查看目前保留配置echo $HISTSIZE



修改環境變量 (永久配置)sed -i &#x27;s/^HISTSIZE=1000/HISTSIZE=100000/&#x27; /etc/profilesource /etc/profile




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 使用 locate 尋找檔案教學與範例</title>
    <url>/blog.github.io/2023/02/01/Linux-%E4%BD%BF%E7%94%A8locate%E5%B0%8B%E6%89%BE%E6%AA%94%E6%A1%88%E6%95%99%E5%AD%B8%E8%88%87%E7%AF%84%E4%BE%8B/</url>
    <content><![CDATA[

安裝 locate 工具yum install mlocate
更新 locate 資料庫updatedb
預設的 locate 資料庫檔案位置ls -l /var/lib/mlocate/mlocate.db



快速尋找檔案尋找含有 .bashrc 關鍵字的檔案locate .bashrc
計算含有 .bashrc 關鍵字的檔案數量locate -c .bashrc
不分大小寫locate -i my.txt
查看 locate 資料庫狀態locate -S




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Locate</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 使用 PuTTYgen 產生 SSH 連線公鑰與私鑰</title>
    <url>/blog.github.io/2022/08/03/Linux-%E4%BD%BF%E7%94%A8putty-keygen%E7%94%A2%E7%94%9FSSH-key/</url>
    <content><![CDATA[
用於 IDE 編輯器的帳號 (程式連)


Linux 機器裡新增 使用者 ide 帳號useradd lauranceide    su - lauranceide    ssh-keygen
ssh-keygen 一路按Enter 即可


(Windows 介面) 打開 putty-keygen.exe 並按下 Generate




將產生的 key 貼入剛剛創建 ide 帳號家目錄中 .ssh 的目錄裡 , 並命名為 authorized_keys

使用 putty-keygen.exe 製作 authorized_keys內容 , 按下 Generate (滑鼠在進度調上游移會快一點)




跑完後 複製上面的內容貼進帳號的 .ssh/authorized_keys 再給權限 600chmod 600 .ssh/authorized_keys






按下 save pubilc key 儲存檔案  lauranceide.pub按下 save private key 儲存檔案  lauranceide.ppk

將 lauranceide.ppk 轉檔成 lauranceide.pem 先 import_key lauranceide.ppk 後在 Export_key lauranceide.pem(root) 登入 Linux 將帳號登入的權限改為 nologinvim  /etc/passwd 	

將 /bin/bash 改為 /sbin/nologinlauranceide:x:1006:1009::/home/lauranceide: /sbin/nologin



]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>PuTTYgen</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 如何刪除殭屍程序</title>
    <url>/blog.github.io/2022/08/03/Linux-%E5%88%AA%E9%99%A4%E6%AE%AD%E5%B1%8D%E7%A8%8B%E5%BA%8F/</url>
    <content><![CDATA[

找出殭屍程序ps -Al | grep -w Z


從找到的程序資訊中，分析出 pidps -Al | grep -w Z | awk &#x27;&#123;print $4&#125;&#x27;



將分析出來的 pid 串連成一個陣列ps -Al | grep -w Z | awk &#x27;&#123;print $4&#125;&#x27; | xargs


***
    

將陣列中的每一個 pid 的程序，利用 kill 來終止、刪除它們ps -Al | grep -w Z | awk &#x27;&#123;print $4&#125;&#x27; | xargs sudo kill -9



若再跑一次 ps -Al | grep -w Z 還是看到有 zombie process

先確認父程序資訊ps -Al | grep -w Z | awk &#x27;&#123;print $5&#125;&#x27; | xargs ps -lp



再確認相依的子程序資訊ps -Al | grep -w Z | awk &#x27;&#123;print $5&#125;&#x27; | xargs ps -l --ppid



如果其中沒有重要程序或是其他正在執行中程序的話，就可以安心地將父程序給刪除掉ps -Al | grep -w Z | awk &#x27;&#123;print $5&#125;&#x27; | xargs sudo kill -9




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 將 CentOS-home 硬碟空間轉移至 CentOS-root 底下</title>
    <url>/blog.github.io/2024/03/03/Linux-%E5%B0%87centos-home%E7%A1%AC%E7%A2%9F%E7%A9%BA%E9%96%93%E8%BD%89%E7%A7%BB%E8%87%B3centos-root%E5%BA%95%E4%B8%8B/</url>
    <content><![CDATA[

查看系統版本
cat /etc/redhat-release






查看系統的硬碟空間
指令: df -hPS: 要計算好移到 root 底下的空間, 後面若要新建home, 需要一定的空間。 ex 將 30G 轉移到 root 底下, 預留 8G 新建給 homePS: /dev/mapper/centos-root、/dev/mapper/centos-home 不同機器名稱可能不同






備份 home 分區
指令: tar zcvf /tmp/home.tar /home






解 mount home&#x2F;指令: umount /home


若跳錯誤 無法執行解 mount 需使用 root 身分登入並執行以下指令
指令: fuser -km /homePS: 若沒有該指令 需執行: yum install -y psmisc






刪除 &#x2F;home 分區
lvremove /dev/mapper/centos-home






擴容 &#x2F;root 分區
lvextend -L +30G /dev/mapper/centos-root






擴展 &#x2F;root 文件系統
xfs_growfs /dev/mapper/centos-root






重新創建 &#x2F;home 分區lvcreate -L 8G -n /dev/mapper/centos-home






創建 &#x2F;home 文件系統
mkfs.xfs /dev/mapper/centos-home






掛載 &#x2F;home 分區
mount /dev/mapper/centos-home






解壓原本備份的 home 至新的分區
tar zxvf /tmp/home.tar -C /home






查看硬碟空間是轉移
df -h






END

]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Mount</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 新增 SWAP 記憶體</title>
    <url>/blog.github.io/2022/08/03/Linux-%E6%96%B0%E5%A2%9Eswap%E8%A8%98%E6%86%B6%E9%AB%94/</url>
    <content><![CDATA[

解決 RAM 不足 問題 - 在 LINUX 新增 SWAP 虛擬記憶體

以一台 1 Gb 記憶體的主機而言，我們在這裡建立 2G的 Swap 虛擬記憶體儲存空間cd /  fallocate -l 2G swapfile    chmod 600 swap-sda1



初始化 Swap 空間

透過 mkswap 將 /swapfile 建立為 Linux 交換區，讓這個資料夾被分割為一個磁碟區mkswap /swapfile



啟動交換區swapon /swapfile



開機啟動swapon -s



如果不使用，可透過以下指令終止：swapoff /swapfile



如果想先主要以實體記憶體為主，swap 為輔，可以透過 swappiness 來設定分配方式sysctl vm.swappiness=10 &gt;&gt; 預設通常會是 60 （值越高，表示會越優先使用 swap，範圍 0~100）



開機自動設定echo &quot;vm.swappiness=10&quot; &gt;&gt; /etc/sysctl.conf&quot;




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 建立 MFA 二階段認證</title>
    <url>/blog.github.io/2022/08/03/Linux-%E6%A9%9F%E5%99%A8%E7%99%BB%E5%85%A5%E4%BA%8C%E9%9A%8E%E6%AE%B5%E8%AA%8D%E8%AD%89MFA/</url>
    <content><![CDATA[

手機先下載 APPapp store 搜索 : Twilio Authygoogleplay store  搜索 : Twilio Authy 2-Factor Authentication

輸入使用要設定的帳號輸入切換成使用者 laurancesu - nadal

執行語法 google-authenticator按 y 按到結束 &gt; 帳號家目錄下面會有一支 .google_authenticatorgoogle-authenticator&gt;&gt; y&gt;&gt; y&gt;&gt; y. . . . . 

建立該帳號存 MFA驗證 的目錄mkdir /home/gauth/laurance/
將 .google_authenticator 移動到 /home/gauth/laurance/ 下面mv  /home/laurance/.google_authenticator /home/gauth/laurance/

權限改給 rootchown root.root /home/gauth/laurance/.google_authenticator



將上面顯示的網址 輸入到瀏覽器即可得到一張 QR Code
使用 APP 掃瞄那張 QR Code 即可成功加入設定

使用 XShell 登入時
選擇下面的 keyboard Interactive 登入
第一次輸入密碼 第二次輸入 APP顯示的六位數字 即可登入

機器服務安裝教學參考:https://shenyu.me/2016/09/05/centos-google-authenticator.html


機器服務安裝步驟

安裝依賴套件yum -y install gcc make pam-devel libpng-devel libtool wget git
直接安裝 EPEL 源 RPM 包
CentOS 6rpm -Uvh http://mirrors.ustc.edu.cn/fedora/epel/epel-release-latest-6.noarch.rpm
CentOS 7rpm -Uvh http://mirrors.ustc.edu.cn/fedora/epel/epel-release-latest-7.noarch.rpm
安裝Qrencode，谷歌身份驗證器需要調用該程序生成二維碼並顯示yum install -y qrencode```        ### 安裝谷歌身份驗證器    ```sqlgit clone https://github.com/google/google-authenticator-libpam.git    cd google-authenticator-libpam/```        ### 編譯並安裝    ```sql./bootstrap.sh  ./configure --prefix=/usr/local/google-authenticator    make &amp;&amp; make install```        ### 複製 google 身份驗證器 pam 模塊到系統下    ```sqlcp /usr/local/google-authenticator/lib/security/pam_google_authenticator.so /lib64/security/
建立指令連結到環境變數ln -s /usr/local/google-authenticator/bin/google-authenticator  /usr/bin/```        ### 配置 `/etc/pam.d/sshd`### 在 auth       substack     password-auth 下面    ### 新增```sql    auth       required     pam_google_authenticator.so user=root secret=/home/gauth/$&#123;USER&#125;/.google_authenticator  nullok
配置 SSH服務vim /etc/ssh/sshd_config```        ### 修改以下參數    ```sqlChallengeResponseAuthentication yes    PasswordAuthentication no  PubkeyAuthentication yesUsePAM yes
重啟 ssh服務service sshd restart





]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>MFA</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 設定 logrotate 輪詢</title>
    <url>/blog.github.io/2022/08/03/Linux-%E8%A8%AD%E5%AE%9Alogrotate_%E8%BC%AA%E8%A9%A2/</url>
    <content><![CDATA[

建立 logrotate 目錄mkdir /root/logrotate/



建立 執行的 shell(加入參數 -f 為強制執行)
EX:
&#x2F;usr&#x2F;sbin&#x2F;logrotate  -f &#x2F;root&#x2F;logrotate&#x2F;weblog
vim /root/logrotate/logrotate.sh
#!/bin/bash/usr/sbin/logrotate  /root/logrotate/weblog



建立要輪詢的設定檔vim /root/logrotate/weblog
/usr/local/web/nginx/logs/*.acc &#123;        daily        rotate 3        create        sharedscripts        postrotate             /usr/local/web/nginx/sbin/nginx -s reload        endscript    &#125;   


建立排程crontab -e
10 05 * * * sh /root/logrotate/logrotate.sh






參數
說明



daily
表示每日一份


create
輪替之後，自動建立新的記錄檔


minsize
大小超過100k，才會發生滾動，即使時間沒到下一個滾動週期內，也不會發生滾動


maxsize
大小超過100k，即使時間沒到下一個滾動週期內，也會發生滾動


dateext
%Y%m%d作為字尾


rotate 5
保留最近的5個備份


compress
切換之後壓縮.tar.gz


create 644 root root
權限壓644 root


sharedscripts
整個日誌組執行一次


postrotate
在與 endscript 的區間內是 rotate 結束後會執行的指令


endscript
同上


copytruncate
用於還在打開中的日誌文件，把當前日誌備份並截斷


missingok
大小超過100k，才會發生滾動，即使時間沒到下一個滾動週期內，也不會發生滾動







參數
說明



-d, –debug
debug 模式，測試配置文件是否有錯誤


-f, –force
強制轉儲文件


-m, –mail&#x3D;command
壓縮日誌後，發送日誌到指定郵箱


-s, –state&#x3D;statefile
使用指定的狀態文件


-v, –verbose
顯示轉儲過程




查看執行狀態cat /var/lib/logrotate/logrotate.status





]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Logrotate</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 核心 &amp; 系統日誌檔 (local 級別) 紀錄</title>
    <url>/blog.github.io/2023/03/03/Linux-%E7%B3%BB%E7%B5%B1LOG_local%E7%B4%9A%E5%88%A5/</url>
    <content><![CDATA[






等級數值
等級名稱
說明



7
debug
用來 debug (除錯) 時產生的訊息資料；


6
info
僅是一些基本的訊息說明而已；


5
notice
雖然是正常資訊，但比 info 還需要被注意到的一些資訊內容；


4
warning
警示的訊息，可能有問題，但是還不至於影響到某個 daemon 運作的資訊；


3
err
一些重大的錯誤訊息，例如設定檔的某些設定值造成該服務服法啟動的資訊說明 ;


2
crit
比 error 還要嚴重的錯誤資訊，這個 crit 是臨界點 (critical) 的縮寫 ;


1
alert
警告警告，已經很有問題的等級，比 crit 還要嚴重！ ;


0
emerg
疼痛等級，意指系統已經幾乎要當機的狀態！ 很嚴重的錯誤資訊了。通常大概只有硬體出問題，導致整個核心無法順利運作 ;







]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>System</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 開機出現 or type control -D to continue 解決辦法</title>
    <url>/blog.github.io/2023/02/01/Linux-%E9%96%8B%E6%A9%9F%E5%87%BA%E7%8F%BE_or_type_control_-D_to_continue%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95/</url>
    <content><![CDATA[
 ERROR : or type control -D to continue 解決辦法 


Linux 開機失敗 ERROR “or type control -D to continue” 解決辦法

主要是磁碟問題,秀的 ERROR

先使用 root 進入 修復模式




輸入完密碼後,進入的模式為 唯讀模式 使用以下指令更改為 讀寫模式mount -n -o remount,rw /






使用指令 df -h 可以看到原本磁碟 mount 的位置




將正確位置寫入 /etc/fstab




重啟後即可reboot




]]></content>
      <categories>
        <category>Mount</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 建立開機畫面 motd 文字</title>
    <url>/blog.github.io/2022/08/10/Linux%E5%BB%BA%E7%AB%8B%E9%96%8B%E6%A9%9F%E7%95%AB%E9%9D%A2motd%E6%96%87%E5%AD%97/</url>
    <content><![CDATA[

建立開機畫面 motd 文字

使用 vim 替換 ^[  為 轉義 字符

在 vim 內按 :

輸入以下內容%s/\^\[/ 

(不要點擊Enter)


輸入 Ctrl+v 然後點擊 Esc 轉換字符

最後輸入 /g ，點擊 Enter

如果操作正確 ^[ 則從灰色變為藍色，如果沒有點擊 u 返回

另一種方法 ( 使用 echo )EX:echo $&#x27;\e[1;37m&#x27; &gt; myfile



各符號代表意思 :


符號
意思



%s
搜索


&#x2F;
第一項


^[
轉義版本 ^[


&#x2F;
第二項，使用鍵盤插入實際 Esc


&#x2F;g
重複所有出現



]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 查看當前目錄大小語法 ( du )</title>
    <url>/blog.github.io/2022/08/03/Linux%E6%9F%A5%E7%9C%8B%E7%95%B6%E5%89%8D%E6%96%87%E4%BB%B6%E7%9B%AE%E9%8C%84%E5%A4%A7%E5%B0%8F/</url>
    <content><![CDATA[

查看當前文件目錄各個文件夾大小du -h --max-depth=1 |sort -hr


查看指定目錄du -h --max-depth=1 /path



查看當層目錄du -h - .



深入到第一層目錄--max-depth=1



查看當前目錄下user目錄的大小，并不想看其他目錄以及其子目錄du -sh user



要通過以1024字節為單位顯示一個目錄樹及其每個子樹的磁盤使用情况du -k /home/linux



以MB為單位顯示一個目錄樹及其每個子樹的磁盤使用情况du -m /home/linux



以GB為單位顯示一個目錄樹及其每個子樹的磁盤使用情况du -g /home/linux



列出當前目錄中的目錄名不包括xyz字符串的目錄的大小du -h --exclude=&#x27;*xyz*&#x27;



只顯示一個目錄樹的全部磁盤使用情况du -s /home/linux



]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 系統重啟 &amp; 檢視日誌及歷史紀錄</title>
    <url>/blog.github.io/2022/08/11/Linux%E7%B3%BB%E7%B5%B1%E9%87%8D%E5%95%9F_%E6%AA%A2%E8%A6%96%E6%97%A5%E8%AA%8C%E5%8F%8A%E6%AD%B7%E5%8F%B2%E7%B4%80%E9%8C%84/</url>
    <content><![CDATA[

各 LOG 代表意思及存放位置


LOG 路徑
代表意思



&#x2F;var&#x2F;log&#x2F;message
系統啟動後的資訊和錯誤日誌


&#x2F;var&#x2F;log&#x2F;secure
與安全相關的日誌資訊


&#x2F;var&#x2F;log&#x2F;maillog
與郵件相關的日誌資訊


&#x2F;var&#x2F;log&#x2F;cron
與定時任務相關的日誌資訊


&#x2F;var&#x2F;log&#x2F;spooler
與UUCP和news裝置相關的日誌資訊


&#x2F;var&#x2F;log&#x2F;boot.log
守護程序啟動和停止相關的日誌訊息


&#x2F;var&#x2F;log&#x2F;wtmp
永久記錄每個使用者登入、登出及系統的啟動、停機的事件


&#x2F;var&#x2F;run&#x2F;utmp
記錄當前正在登入系統的使用者資訊


&#x2F;var&#x2F;log&#x2F;btmp
記錄失敗的登入嘗試資訊




Linux 系統查詢機器最近重啟時間命令




指令
意思



last reboot
檢視所有重啟日誌資訊


last reboot l head -1
檢視最近的一條







指令
意思



last -x  l  grep shutdown  l  head -1
顯示上次關機的日期和時間


uptime -s
檢視系統正常的執行時間





]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Memcache - 參數</title>
    <url>/blog.github.io/2022/08/16/Memcache-%E5%8F%83%E6%95%B8/</url>
    <content><![CDATA[




參數
參數代表意思



-d
是啟動一個守護程序


-m
是分配給Memcache使用的記憶體數量，單位是MB


-u
是執行Memcache的使用者


-l
是監聽的伺服器IP地址，可以有多個地址


-p
是設定Memcache監聽的埠，，最好是1024以上的埠


-c
是最大執行的併發連線數，預設是1024


-P
是設定儲存Memcache的pid檔案





]]></content>
      <categories>
        <category>Memcache</category>
      </categories>
      <tags>
        <tag>Memcache</tag>
      </tags>
  </entry>
  <entry>
    <title>Memcache - 基本操作</title>
    <url>/blog.github.io/2022/08/16/Memcache-%E5%B8%B8%E7%94%A8%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[




參數名稱
作用



command
add 、 set 或 replace


key
緩存的名字


flag
16 位無符號整數，和 key 要存儲的數據一起存儲，並在程序 get 緩存時，返回


exptime
過去時間，0 表示永遠不過期


bytes
存儲數據的字節數


\r\n
換行 Enter




格式
&lt;command&gt; &lt;key&gt; &lt;flags&gt; &lt;exptime&gt; &lt;bytes&gt;\r\n    &lt;data block&gt;\r\n



啟動服務./memcached -d -m 2048 -u nobody  -p 12000 -c 2048 -P /tmp/memcached.pid



連接 memcachetelnet 127.0.0.1 12000

linux 下一般用 telnet 連接


添加緩存add kk 1 0 4  	        #Enter1234  		        #Enter    STORED

如果 key 已經存在，則會添加失敗。如果數據 不是 4 個字節 應該會提示數據錯誤


修改緩存replace kk 1 0 2        #Enter 11  		        #Enter    STORED  

key 存在時,成功 ； 不存在時,失敗******設置緩存set kk 1 0 4  	        #Enter1234 		        #EnterSTORED


讀取get kkVALUE kk 1 41234



刪除delete kk 	        #EnterDELETED



清空所有缓存flush_all  OK



查看缓存服務器狀態stats



]]></content>
      <categories>
        <category>Memcache</category>
      </categories>
      <tags>
        <tag>Memcache</tag>
      </tags>
  </entry>
  <entry>
    <title>Memcache - 安裝 ( CentOS7 )</title>
    <url>/blog.github.io/2022/08/16/Memcache-%E5%AE%89%E8%A3%9D-CentOS7/</url>
    <content><![CDATA[

依賴yum install libevent libevent-devel    yum install perl-Test*    wget http://memcached.googlecode.com/files/memcached-1.4.8.tar.gz    tar zxvf memcached-1.4.8.tar.gz    cd memcached-1.4.8    make &amp;&amp; make test    make install

啟動服務./memcached -d -m 2048 -u nobody  -p 12000 -c 2048 -P /tmp/memcached.pid
停止服務pkill memcached				



]]></content>
      <categories>
        <category>Memcache</category>
      </categories>
      <tags>
        <tag>Memcache</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDB - 安裝教學</title>
    <url>/blog.github.io/2022/08/15/Mongod-Mongodb%E5%AE%89%E8%A3%9D%E6%95%99%E5%AD%B8/</url>
    <content><![CDATA[

MongoDB官網下載地址








yum install libcurl openssl    wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-4.0.28.tgz    tar zxvf mongodb-linux-x86_64-4.0.28.tgz  -C /usr/local/    mv /usr/local/mongodb-linux-x86_64-4.0.28/ mongodb/    cd /usr/local/mongodb/    mkdir data log conf    cd data/ &amp;&amp; mkdir db/    cd /usr/local/mongodb/conf &amp;&amp; touch mongodb.conf



vim mongodb.conf
dbpath=/usr/local/mongodb/data/db      logpath=/usr/local/mongodb/log/mongodb.log     port=27017    fork=true    bind_ip=0.0.0.0



啟動服務./bin/mongod --config ./conf/mongodb.conf



關閉服務./bin/mongod --config ./conf/mongodb.conf --shutdown



建立 mongoDB 連線./mongo




]]></content>
      <categories>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDB - 常用語法</title>
    <url>/blog.github.io/2022/08/15/Mongod-Mongodb%E5%B8%B8%E7%94%A8%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[

創建資料庫  (如果資料庫不存在，則創建並切換過去)use DATABASE_NAME



創建集合db.createCollection(&quot;runoob&quot;)



查看集合show collections &amp;&amp; show tables



查看資料庫db.col.find()



顯示目前數據庫db



查看所有數據庫show dbs



插入資料到數據庫db.test222.insert(&#123;&quot;name&quot;:&quot;菜鳥&quot;&#125;)



刪除數據庫db.dropDatabase()



删除集合db.collection.drop()



創建固定集合mycol，集合空間大小6142800B，文檔最大個數10000個db.createCollection(&quot;mycol&quot;, &#123; capped : true, autoIndexId : true, size : 6142800, max : 10000 &#125; )



集合插入多個文檔db.col.insert(&#123;title: &#x27;MongoDB教程&#x27;,         description: &#x27;MongoDB 是一個Nosql數據庫&#x27;,        by: &#x27;菜鳥&#x27;,        url: &#x27;https://note.laurance.ml&#x27;,        tags: [&#x27;mongodb&#x27;, &#x27;database&#x27;, &#x27;NoSQL&#x27;],        likes: 100        &#125;)



或是可以設成變量document=(&#123;title: &#x27;MongoDB教程&#x27;,         description: &#x27;MongoDB 是一個Nosql數據庫&#x27;,        by: &#x27;菜鳥&#x27;,        url: &#x27;https://note.laurance.ml&#x27;,        tags: [&#x27;mongodb&#x27;, &#x27;database&#x27;, &#x27;NoSQL&#x27;],        likes: 100        &#125;);



在執行插入動作db.col.insert(document)




]]></content>
      <categories>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDB -Studio 3T for MongoDB 2019 019.3.0</title>
    <url>/blog.github.io/2023/03/03/Mongod-Studio_3T_for_MongoDB-2019/</url>
    <content><![CDATA[

{Step 1} 安裝 Studio 3T for 2019.3.0 exe執行檔ps. 記住安裝包路徑  ex: C:\Program Files\3T Software Labs\Studio 3T





{Step 2} 安裝完成後前面會跳 建議要更新 , 不用理他按 OK




{Step 3} 點選 I agree 即可




{Step 4} 此時會跳出需要驗證的環節




{Step 5} 將 Crack 底下的 data-man-mongodb-XXX 移至安裝包路徑




{Step 6} 再次打開已跳過驗證環節




studio 3T for 2019 019.3.0

]]></content>
      <categories>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDB - 如何使用 studio 3T 遠端建立連線</title>
    <url>/blog.github.io/2022/10/22/Mongod-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8studio-3T%E9%81%A0%E7%AB%AF%E5%BB%BA%E7%AB%8B%E9%80%A3%E7%B7%9A/</url>
    <content><![CDATA[

新建立連線




打上 host , port 儲存




studio 3T for windows

]]></content>
      <categories>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDB - 如何備份與還原</title>
    <url>/blog.github.io/2022/10/22/Mongod-%E5%A6%82%E4%BD%95%E5%82%99%E4%BB%BD%E8%88%87%E9%82%84%E5%8E%9F_MongoDB/</url>
    <content><![CDATA[

先建立要備份的資料庫 (否則會備份失敗)mkdir /root/168-mongo.bak



透過以下命令進行單個資料庫備份 (參數 -d 資料庫)mongodump -h 172.16.2.169 --port 27017 -d my-mongo -o ./root/168-mongo.bak



透過以下命令進行全部資料庫備份mongodump -h 172.16.2.169 --port 27017 -o ./root/168-mongo.bak



透過以下命令進行本機備份 (解決Authentication failed.)mongodump -o mongodb-dump/






透過以下命令還原剛剛備份的資料庫mongorestore -h 127.0.0.1 --port 27017 /root/168-mongo.bak



會報錯 ERROR - E11000 duplicate key error 重複密鑰錯誤集合




(加入參數 –drop my-backup)  注意!!! 任何不在備份中的文件都將永久丟失！mongorestore -h 127.0.0.1 --port 27017 /root/168-mongo.bak --drop



]]></content>
      <categories>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDB - 建立每日備份 Shell Script</title>
    <url>/blog.github.io/2022/10/22/Mongod-%E5%BB%BA%E7%AB%8B%E6%AF%8F%E6%97%A5%E5%82%99%E4%BB%BD_Shell_Script/</url>
    <content><![CDATA[

Linux 建立每日備份 Shell Script
  #!/bin/sh # Definded Dump ConfiguartionrollingDays=7dumpFilename=&quot;mongodb&quot;dumpTmpDir=&quot;/tmp/mongo-dump-tmp&quot;backupPath=&quot;/root/mongo-backup&quot;username=&quot;username&quot;password=&quot;password&quot;hostname=&quot;127.0.0.1&quot;database=&quot;my-mongo&quot; #Start Dumpping.......today=`date &quot;+%Y-%m-%d&quot;`echo &quot;Today: $&#123;today&#125;&quot;echo &quot;Start Dumpping.......&quot; # Make backup directoryif ! [ -d &quot;$&#123;backupPath&#125;&quot; ] ; then    echo &quot;make dir : $&#123;backupPath&#125;&quot;    mkdir -p &quot;$&#123;backupPath&#125;&quot;fiif ! [ -d &quot;$&#123;dumpTmpDir&#125;&quot; ] ; then    echo &quot;make dir : $&#123;dumpTmpDir&#125;&quot;    mkdir -p &quot;$&#123;dumpTmpDir&#125;&quot;fi # Make parameterdn=&quot;-h $&#123;hostname&#125;&quot;if [ &quot;$&#123;username&#125;&quot; != &quot;&quot; ] &amp;&amp; [ &quot;$&#123;password&#125;&quot; != &quot;&quot; ] ; then    dn=&quot;$&#123;dn&#125; -u $&#123;username&#125; -p $&#123;password&#125;&quot;fiif [ &quot;$&#123;databse&#125;&quot; != &quot;&quot; ] ; then    dn=&quot;$&#123;dn&#125; -d $&#123;database&#125;&quot;fi # Run backup scriptrm -rf -R $&#123;dumpTmpDir&#125;command=&quot;mongodump $&#123;dn&#125; -o $&#123;dumpTmpDir&#125;&quot;echo $command$commandif [ $?:= 0 ] ; then    cd &quot;$&#123;dumpTmpDir&#125;&quot;    /bin/tar -zcvf &quot;$&#123;backupPath&#125;/$&#123;dumpFilename&#125;-$&#123;today&#125;.tar.gz&quot; *    find $&#123;backupPath&#125;/$&#123;dumpFilename&#125;-* -mtime +&#123;rollingDays&#125; -exec rm -f &#123;&#125; \;firm -rf -R $&#123;dumpTmpDir&#125;



參考文件

]]></content>
      <categories>
        <category>MongoDB</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 報錯 Changed limits max_connections ( error 214 ) 解决方法</title>
    <url>/blog.github.io/2022/12/14/Mysql-Changed_limits_max_connections_%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[
error 214 —- Buffered warning: Changed limits: max_connections


修改系統 Kernel 的變數vim /etc/sysctl.conf
net.ipv4.tcp_syncookies: 1net.ipv4.tcp_tw_reuse: 1net.ipv4.tcp_tw_recycle: 1  net.ipv4.tcp_fin_timeout: 30



修改系統資源限制配置文件vim /etc/security/limits.conf 

* soft nproc 65535* hard nproc 65535* soft nofile 65535* hard nofile 65535  



將mysql默認資源限制拉高 (默認為5000)vim /usr/lib/systemd/system/mysqld.service
    
LimitNOFILE=65535







]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 主從報錯 Error &#39;Duplicate entry &#39;XXXXX&#39; for key &#39;XXX&#39;&#39; on query. ( error 1062 ) 解決方法</title>
    <url>/blog.github.io/2023/01/19/Mysql-1062_%E4%B8%BB%E5%BE%9E%E9%8C%AF%E8%AA%A4Error_&#39;Duplicate_entry_&#39;XXXXX&#39;_for_key_&#39;XXX&#39;&#39;_on_query/</url>
    <content><![CDATA[
error 1062 —- 主鍵沖突，出現這種情況就是從庫出現插入操作，主庫又重新來了一遍 iothread 沒問題 sqlthread 出錯


解決方案:

stop slave;set global sql_slave_skip_counter=1;start slave;



上述指令的 SET GLOBAL sql_slave_skip_counter: 1; 代表的是 1 個 event在 Innodb 中，一個 event 代表的是一組 sql 指令，並非一筆 sql


]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 報錯 Row size too large (&gt; 8126). Changing some columns to TEXT or BLOB or using ROW_FORMAT ( error 1118 ) 解決方法</title>
    <url>/blog.github.io/2023/01/19/Mysql-Error_1118_Row_size_too_large_8126/</url>
    <content><![CDATA[

解決方法: 關閉 mysql 嚴格模式

查看 innodb_strict_mode 參數是否為 onshow variables like &#x27;%innodb_strict_mode%&#x27;;



關閉嚴格模式:vim /etc/my.cnf
[mysqld] &gt;&gt; innodb_strict_mode: 0



登入 mysql 後查看設定 OFFshow variables like &#x27;%innodb_strict_mode%&#x27;;




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 主從報錯 Table &#39;mysql.gtid_slave_pos&#39; doesn&#39;t exist in engine ( error 1932 ) 解決方法</title>
    <url>/blog.github.io/2023/01/19/Mysql-Error_Table_&#39;mysql_gtid_slave_pos&#39;_doesn&#39;t_exist_in_engine/</url>
    <content><![CDATA[

解決方案:

將 DB 所有資料庫備份為 SQL檔mysqldump -uroot -p -S /var/lib/mysql/master01/mysql01.sock --all-databases &gt; all_databases.sql



將 DB 砍掉 重新生成預設資料庫mysql_install_db --user=mysql --datadir=/var/lib/mysql/master01



再次將 SQL檔重新匯入mysql -uroot -p -S /var/lib/mysql/master01/mysql01.sock &lt; all_databases.sql



檢查所有資料庫是否有錯誤mysqlcheck -c --all-databases -uroot -p -S mysql01.sock




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL dump - 備份 &amp; 還原資料庫</title>
    <url>/blog.github.io/2022/08/03/Mysql-mysqldump%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[

備份單一資料庫mysqldump -h hostname -u root -p database_name &gt; backup.sql;



備份資料庫中單一資料表mysqldump -u root -p database_name table_name &gt; backup.sql;



匯出資料庫中的某張資料表的表結構（不含資料）mysqldump -u username -p -d dbname tablename &gt; tablename.sql   



備份資料庫中多張資料表mysqldump -u root -p database_name table1 table2 &gt; backup.sql;



備份多個資料庫mysqldump -u root -p --databases db1 db2 &gt; backup.sql;



備份所有資料庫mysqldump -u root -p --all-databases &gt; backup.sql;



匯出資料庫結構（不含資料）mysqldump -u username -p -d dbname &gt; dbname.sql    



復原單一資料庫mysql -u root -p database_name &lt; backup.sql```    ******    **復原多個資料庫**-----    ```sqlmysql -u root -p &lt; backup.sql




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - Replication 主從式跟隨架構設定</title>
    <url>/blog.github.io/2022/08/03/Mysql-%E4%B8%BB%E5%BE%9E%E8%B7%9F%E9%9A%A8/</url>
    <content><![CDATA[

Master Slave Replication 的架構

在 master  server 執行的 SQL command 會被記錄在 Binary Log 裡面master 將 Binary Log 傳送到 slave 的 Relay Logslave 依據 Relay Log 做資料的變更




建立 MySQL Replication 實作紀錄 [ Slave 設定為不寫 binlog]

Master server 設定 :

{ 修改 Master 設定檔 }vim /etc/mysql/my.cnf
[mysqld]skip-external-lockingsql_mode=NO_AUTO_Create_USER,NO_ENGINE_SUBSTITUTION#default-storage-engine=MYISAMexplicit_defaults_for_timestamp=true#--------------------------------------#default-tmp-storage-engine=MYISAMcharacter_set_server: utf8innodb_buffer_pool_size: 1500Minnodb_log_buffer_size: 32Minnodb_log_file_size: 16Minnodb_flush_log_at_trx_commit: 2innodb_buffer_pool_instances: 1innodb_file_per_table=1#-------------------------------------max_connections: 2000max_allowed_packet: 64Mtable_open_cache: 512sort_buffer_size: 4Mnet_buffer_length: 8Kread_buffer_size: 256Kread_rnd_buffer_size: 512Kmyisam_sort_buffer_size: 128M#key_buffer: 256M#-------------------------------------socket: /var/lib/mysql/mysql.sockpid-file: mysql.pidlog-error: mysql.errlog-slave-updatesmax_binlog_size: 500Mbinlog_format=&quot;MIXED&quot;log-bin: log-binserver_id: 999relay-log-purge: 1max-relay-log-size: 500Mrelay-log-space-limit: 500M slow_query_log: 1slow_query_log_file: slow-queries.loglong_query_time: 1#---------------------------------------------[mysqld_multi]mysqld: /usr/bin/mysqld_safemysqladmin: /usr/bin/mysqladmin



重新啟動 MySQL 服務 [使設定檔生效]mysqladmin -uroot -p shutdown    mysqld_safe &amp;



登陸 Master 建立 Slave 帳號mysql -u root -p
STOP SLAVE;GRANT REPLICATION SLAVE ON *.* TO &#x27;輸入使用者名稱&#x27;@&#x27;輸入來源 + %&#x27; IDENTIFIED BY &#x27;輸入密碼&#x27;;FLUSH PRIVILEGES;SHOW MASTER STATUS;exit;



DUMP 語法mysqldump -uroot -p --all-databases &gt; masterdatabase.sql



登陸 Master 查看 Master 資訊mysql -u root -p
show master status;exit;



將 SQL 檔 SCP 至 Slavescp masterdatabase.sql root@slave主機來源:~



{ 修改 Slave 設定檔 }

Slave 停 DBmysqladmin -uroot -p shutdown



將 Master 的 SQL 檔匯入 Slavemysql -u root -p &lt; /home/masterdatabase.sql



修改 Slave 設定檔vim /etc/my.cnf
[mysqld]skip-external-locking#skip-innodb#skip-name-resolvesql_mode=NO_AUTO_Create_USER,NO_ENGINE_SUBSTITUTIONserver_id: 998innodb_buffer_pool_size: 1500Minnodb_log_buffer_size: 32Minnodb_log_file_size: 16Minnodb_flush_log_at_trx_commit: 2innodb_buffer_pool_instances: 1#innodb_file_format: barracuda#innodb_file_format_max: barracudainnodb_file_per_table: 1read-only: 1#-------------------------------------max_connections: 2000max_allowed_packet: 64Mtable_open_cache: 512sort_buffer_size: 4Mnet_buffer_length: 8Kread_buffer_size: 256Kread_rnd_buffer_size: 512Kmyisam_sort_buffer_size: 128M#key_buffer: 256M#-------------------------------------socket: /var/lib/mysql/mysql.sockpid-file: mysql.pidlog-error: mysql.errlog-slave-updatesport: 3306relay-log-purge: 1max-relay-log-size: 500Mrelay-log-space-limit: 500M slow_query_log: 1slow_query_log_file: slow-queries.log#long_query_time: 1#---------------------------------------------[mysqld_multi]mysqld: /usr/bin/mysqld_safemysqladmin: /usr/bin/mysqladmin



啟動 Slave DBmysqld_safe &amp;



設定 SlaveDB，指定 Master DB 登入資訊，並啟動 Replicationmysql -u root -p
STOP SLAVE;CHANGE MASTER TO MASTER_HOST=&#x27;輸入Master主機ip&#x27;, MASTER_USER=&#x27;輸入使用者名稱&#x27;, MASTER_PASSWORD=&#x27;輸入密碼&#x27;, MASTER_LOG_FILE=&#x27;mariadb-bin.000001&#x27;, MASTER_LOG_POS=479;start slave;SHOW SLAVE STATUS \G;



   ############################################

]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MariaDB - CentOS 7 yum 安裝源 ( yum_repo )</title>
    <url>/blog.github.io/2022/08/03/Mysql-yum%E5%AE%89%E8%A3%9D/</url>
    <content><![CDATA[

{ yum repo }cat &lt;&lt;EOF | tee /etc/yum.repos.d/MariaDB.repo# MariaDB 10.5 CentOS repository# http://downloads.mariadb.org/mariadb/repositories/[mariadb]name: MariaDBbaseurl: http://yum.mariadb.org/10.5/centos7-amd64gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDBgpgcheck=1EOF



yum 安裝 MariaDB-10.5.14yum install -y MariaDB-server MariaDB-client MariaDB-devel*




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 報錯 Your password does not satisfy the current policy requirements ( error 1819 HY000) 解決方法</title>
    <url>/blog.github.io/2022/09/27/Mysql-%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A2%BC%E5%BC%B7%E5%BA%A6%E8%A6%8F%E5%89%87/</url>
    <content><![CDATA[
當建立 MySQL 帳號或者修改密碼時, 密碼強度不符合要求, 會出現以下錯誤
ERROR 1819 (HY000): Your password does not satisfy the current policy requirements.


查看密碼強度規則show variables like &#x27;validate_pass%&#x27;;
   +--------------------------------------+--------+| Variable_name                        | Value  |+--------------------------------------+--------+| validate_password_check_user_name    | OFF    || validate_password_dictionary_file    |        || validate_password_length             | 8      || validate_password_mixed_case_count   | 1      || validate_password_number_count       | 1      || validate_password_policy             | MEDIUM || validate_password_special_char_count | 1      |+--------------------------------------+--------+



修改密碼強度為最低set global validate_password_policy=0;


修改密碼長度為4 (最短)set global validate_password_length=4;



修改密碼 特殊符號為最低set global validate_password_special_char_count:0; 



再次查看規則show variables like &#x27;validate_pass%&#x27;;
   +--------------------------------------+-------+| Variable_name                        | Value |+--------------------------------------+-------+| validate_password_check_user_name    | OFF   || validate_password_dictionary_file    |       || validate_password_length             | 4     || validate_password_mixed_case_count   | 1     || validate_password_number_count       | 1     || validate_password_policy             | LOW   || validate_password_special_char_count | 0     |+--------------------------------------+-------+


修改 root 密碼SET PASSWORD FOR &#x27;root&#x27;@&#x27;localhost&#x27;: PASSWORD(&#x27;123456&#x27;);




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 剛載完的密碼存放位置</title>
    <url>/blog.github.io/2022/09/27/Mysql-%E5%89%9B%E8%BC%89%E5%AE%8C%E7%9A%84%E5%AF%86%E7%A2%BC%E5%AD%98%E6%94%BE%E4%BD%8D%E7%BD%AE/</url>
    <content><![CDATA[
實測 MySQL-5.7 會有隨機密碼, MariaDB 則預設沒密碼


剛下載完啟動 server 會有一組隨機密碼 存放在 /var/log/mysqld.log

vim /var/log/mysqld.log






初次登入需要設置 root@localhost 密碼 ( 規則為: 大英 + 小英 + 符號 )SET Password: password(&#x27;Aaa123456@&#x27;);



]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 報錯 Slave received end packet from server apparent master shutdown</title>
    <url>/blog.github.io/2022/10/19/Mysql-%E5%A0%B1%E9%8C%AFSlave_received_end_packet_from_server_apparent_master_shutdown/</url>
    <content><![CDATA[

MySQL 一臺從庫的錯誤日誌，大量報下面的錯誤資訊




先檢查一下 Server ID 有沒有重複show global variables like &#x27;server%id%&#x27;;



若 ServerID 沒重複的話那肯定就是 DB 的 UUID 重複了

{ 解決方式 }:

到 MySQL 目錄將 auto.cnf 砍掉重新生成即可cd /var/lib/mysqlrm -f auto.cnfmysqld_multi stop 3mysqld_multi start 3




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 如何配置 buffer pool</title>
    <url>/blog.github.io/2022/10/26/Mysql-%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AEbuffer_pool/</url>
    <content><![CDATA[

{ 主要修改參數 }

默認大小為 128M 健康比例為內存大小 50% (值越大 IO讀寫 就越少,數據讀寫就越快)
innodb_buffer_pool_size



一般取 256M 的倍數,並結合 innodb_buffer_pool_size 設置其大小 25%-50%
innodb_log_file_size


一般取 16M 的倍數
innodb_log_buffer_size




一般取 innodb_buffer_pool_size 的 50% 效果最優
innodb_buffer_pool_instances


EX: 跑兩套 mysqld_multi  本機記憶體:31798M (32G)
innodb_buffer_pool_size: 8G innodb_log_buffer_size: 32Minnodb_log_file_size: 1Ginnodb_flush_log_at_trx_commit: 2innodb_buffer_pool_instances: 6#innodb_file_format=barracuda#innodb_file_format_max=barracudainnodb_file_per_table=1

mysqladmin -uroot -p shutdownmysqld_safe &amp;```    `配置完後 , 重啟服務生效`******### 進入 mysql 查看配置是否正確***```sqlshow variables where variable_name in (&#x27;innodb_buffer_pool_size&#x27;, \&#x27;innodb_buffer_pool_instances&#x27; ,\&#x27;innodb_log_buffer_size&#x27; ,\&#x27;innodb_log_file_size&#x27;);





公式整理 : percent 必須 &gt;&#x3D; 95%
percent: innodb_buffer_pool_read_requests / (innodb_buffer_pool_reads + innodb_buffer_pool_read_requests) * 100%    innodb_buffer_pool_pages_total: innodb_buffer_pool_size / innodb_page_size    percent: innodb_buffer_pool_pages_data / innodb_buffer_pool_pages_total * 100%    innodb_buffer_pool_size: innodb_buffer_pool_pages_data * innodb_page_size * 1.05 / (1024*1024*1024)






]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 將庫及表轉成 `SQL檔` 語法</title>
    <url>/blog.github.io/2022/08/09/Mysql-%E5%B0%87%E5%BA%AB%E5%8F%8A%E8%A1%A8%E8%BD%89%E6%88%90SQL%E6%AA%94/</url>
    <content><![CDATA[

將某庫某表轉成 SQL檔

mysqldump -uroot -p UserAccount UserGame &gt; /root/UserGame.sql




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 將預設資料庫編碼 `latin1` 改為 `UTF 8`</title>
    <url>/blog.github.io/2022/09/27/Mysql-%E5%B0%87%E9%A0%90%E8%A8%AD%E8%B3%87%E6%96%99%E5%BA%AB%E7%B7%A8%E7%A2%BClatin1%E6%94%B9%E7%82%BAUTF8/</url>
    <content><![CDATA[

***** 新版 MySQL 請參考官方文件


Step.1 先修改 MySQL Config 讓之後建立的資料庫都使用編碼 UTF8vim /etc/my.cnf
[mysqld]default-character-set=utf8default-collation=utf8_unicode_cicharacter-set-server=utf8collation-server=utf8_unicode_ci     datadir=/var/lib/mysqlsocket=/var/lib/mysql/mysql.sockuser=mysql# Disabling symbolic-links is recommended to prevent assorted security riskssymbolic-links=0    [client]default-character-set=utf8    [mysql]default-character-set=utf8    [mysqld_safe]log-error=/var/log/mysqld.logpid-file=/var/run/mysqld/mysqld.pid


重新啟動 MySQL 讓設定生效
service mysqld restart



Step.2 若要直接修改，不通過設定檔的方式
ALTER DATABASE dbdata CHARACTER SET utf8 COLLATE utf8_general_ci;```    ***    **再進入 Mysql 介面查詢編碼** ```sqlmysql&gt; status;



Step.3 若要修改已存在的 Tables
mysqldump -uroot -prootpw --default-character-set=latin1 --skip-set-charset dbdata &gt; dbdata.sql


將 latin1 取代成 utf8
sed -i &#x27;s/latin1/utf8/g&#x27; dbdata.sql &gt; dbdata_utf8.sql


匯入 MYSQL
mysql -uroot -prootpw --default-character-set=utf8 dbdata &lt; dbdata_utf8.sql




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 常用語法整理</title>
    <url>/blog.github.io/2022/08/03/Mysql-%E5%B8%B8%E7%94%A8%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[

背景啟動mysqld_safe &amp;



停掉服務mysqladmin -u root -p shutdown 



創建密碼mysqladmin -u root password &#x27;密碼&#x27; 



列出該 database_name 所有資料表mysqlshow -u user_name -p db_name



檢視伺服器埠show global variables like &#x27;port&#x27;; 



查詢 IDSHOW VARIABLES LIKE &#x27;%server_%&#x27;; 



忘記密碼時在 my.cnf 增加參數skip-grant-tables



在 mysql 介面執行更改密碼use mysql;UPDATE user SET Password: password(&#x27;123456&#x27;) WHERE User: &#x27;root&#x27;; 



檢查是否有支援 PartitionSHOW PLUGINS;SELECT PLUGIN_NAME as Name, PLUGIN_VERSION as Version, PLUGIN_STATUS as Status FROM INFORMATION_SCHEMA.PLUGINS WHERE PLUGIN_TYPE=&#x27;STORAGE ENGINE&#x27;;



若要關閉 partition 支援，可在 my.cnf 加上 skip-partition 再重新啟動

查看版本 ( 在 Mysql 介面 執行 )mysql&gt; select version(); 

或是在 Linux 介面 執行
mysql -V



查看表的存储引擎show create table proc \G



直接更改存储引擎alter table UserConf engine=MyISAM;	



顯示數據表結構：describe 表名;



查看 MySQL 的時間select now();



查看 MySQL 時區show variables like &quot;%time_zone%&quot;;



顯示哪個執行緒正在運行SHOW PROCESSLIST;



顯示資料表的欄位show columns from 資料表名稱;



顯示user裡的資料SELECT * FROM user \G



新增帳號CREATE USER &#x27;laurance&#x27;@&#x27;10.10.%.%&#x27; IDENTIFIED BY &#x27;123456&#x27;;



給予全部權限grant all on *.* to &#x27;laurance&#x27;@&#x27;10.10.%.%&#x27;;



修改使用者update user set User=&#x27;laurance&#x27; where User=&#x27;root&#x27;;



刪除使用者drop user &#x27;laurance&#x27;@&#x27;localhost&#x27;;



查看使用者權限show grants for &#x27;laurance&#x27;@&#x27;localhost&#x27;; 



安裝 MySQL 密碼強度插件INSTALL PLUGIN validate_password SONAME &#x27;validate_password.so&#x27;;



臨時改密碼強度規則SET GLOBAL validate_password_policy=LOW;



查看密碼強度規則show variables like &#x27;validate_pass%&#x27;;



查看密碼長度規則select @@validate_password_length;



更換主從語法change master to MASTER_HOST=&#x27;10.10.10.10&#x27;, MASTER_USER=&#x27;laurance&#x27;, MASTER_PASSWORD=&#x27;123456&#x27;, MASTER_LOG_FILE=&#x27;log-bin.000018&#x27;, MASTER_LOG_POS=815722;



查詢 MySQL 密碼select * from mysql.user \G



將 * 開頭的亂碼貼到 MD5 解
https://www.cmd5.com/


重新設為預設資料庫mysql_install_db --datadir=/var/lib/mysql/master01/ --user=mysql &amp;



新增 TABLE 語法CREATE TABLE ithelp1007a(id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,class CHAR(1) NOT NULL,name CHAR(20) NOT NULL,score TINYINT UNSIGNED NOT NULL);



插入 TABLE 語法INSERT INTO ithelp1007a(class, name, score) VALUES(&#x27;A&#x27;, &#x27;Tom&#x27;, 78),(&#x27;A&#x27;, &#x27;Mary&#x27;, 25),(&#x27;A&#x27;, &#x27;John&#x27;, 65),(&#x27;B&#x27;, &#x27;Hitomi&#x27;, 95),(&#x27;B&#x27;, &#x27;Asami&#x27;, 84),(&#x27;B&#x27;, &#x27;Keiko&#x27;, 73);




]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL - 建立主從監控 - dbmonitor</title>
    <url>/blog.github.io/2022/01/27/Mysql-%E5%BB%BA%E7%AB%8B%E4%B8%BB%E5%BE%9E%E7%9B%A3%E6%8E%A7-dbmonitor/</url>
    <content><![CDATA[
[ 安裝套件 apache + php + mysql ]


版本 [MySQL-5.1.73 + Apache-2.2.27 + PHP-5.5.16]

1. 環境安裝

安裝 { MySQL-5.1.73 } Centos6 預設 mysql 版本
安裝服務
yum install mysql-server mysql-client mysql-devel*


啟動服務
service mysqld start


設置 root 密碼
mysqladmin -u root password &#x27;123456&#x27;


建立 database-newdb
mysqladmin -uroot -p create &quot;newdb&quot;


安裝 {Apache-2.2.27}
安裝依賴
yum -y install gcc+ gcc-c++


解壓 &amp; 安裝
tar zxvf httpd-2.2.27.kiwi.tar.gz    ./configure --prefix=/usr/local/web/apache2 --enable-ssl --enable-so  --enable-vhost-alias  --with-mpm=prefork    make &amp;&amp; make install


啟動服務
/usr/local/web/apache2/bin/apachectl



安裝 {PHP-5.5.16}
安裝依賴
yum -y install gcc gcc-c++  make cmake automake autoconf kernel-devel ncurses-devel libxml2-devel openssl-devel curl-devel libjpeg-devel libpng-devel  pcre-devel libtool libtool-libs freetype-devel gd zlib-devel file bison patch mlocate flex diffutils   readline-devel glibc-devel glib2-devel bzip2-devel gettext-devel libcap-devel openldap openldap-devel libxslt-devel sqlite-devel


解壓 &amp; 安裝
tar zxvf php-5.5.16.kiwi.tar.gz    &#x27;./configure&#x27; &#x27;--prefix=/usr/local/web/php&#x27; &#x27;--with-apxs2=/usr/local/web/apache2/bin/apxs&#x27; &#x27;--with-mysql&#x27; &#x27;--with-mysqli&#x27; &#x27;--disable-cgi&#x27; &#x27;--with-iconv&#x27; &#x27;--disable-inline-optimization&#x27; &#x27;--enable-mbstring=tw&#x27; &#x27;--enable-sysvshm&#x27; &#x27;--enable-sysvsem&#x27; &#x27;--enable-sockets&#x27; &#x27;--with-jpeg-dir&#x27; &#x27;--with-png-dir&#x27; &#x27;--with-gd&#x27; &#x27;--with-zlib&#x27; &#x27;--with-curl&#x27; &#x27;--enable-zip&#x27; &#x27;--with-openssl-dir=/usr/lib/openssl&#x27; &#x27;--with-openssl&#x27; &#x27;--enable-opcache&#x27;    make &amp;&amp; make install


複製設定檔及 link
cp php.ini-development /usr/local/web/php/etc/php.ini        cp /usr/local/web/php/bin/* /usr/bin/        ln -s /usr/local/web/php/etc/php.ini /etc/php.ini



2. 設定 DB &amp; WEB

設定 [mysql]
下載框架
git clone https://github.com/dingbangli/dbmonitor-case.git


將 SQL 框架匯入 DB
mysql -uroot -p newdb &lt; dbmonitor_newdb.sql


Mysql 建立使用者 &amp; DB 資料
GRANT ALL PRIVILEGES ON *.* TO &#x27;ckdb&#x27;@&#x27;localhost&#x27;   IDENTIFIED BY &#x27;XXX&#x27;    insert into dbwhere(wid,dbname,dbip,dbtype,id2,dbport) values(&#x27;22&#x27;,&#x27;DB-22&#x27;,&#x27;172.16.0.222&#x27;,&#x27;m&#x27;,&#x27;2106&#x27;,&#x27;3306&#x27;);    insert into dbwhere(wid,dbname,dbip,dbtype,id2,dbport) values(&#x27;23&#x27;,&#x27;DB-23&#x27;,&#x27;172.16.0.223&#x27;,&#x27;s&#x27;,&#x27;2107&#x27;,&#x27;3306&#x27;);    insert into web(wname,wid) values(&#x27;lv22&#x27;,&#x27;22&#x27;);    insert into web(wname,wid) values(&#x27;lv23&#x27;,&#x27;23&#x27;);    \q



設定 [Apache]
建立資料夾放 vhost
mkdir /usr/local/web/apache2/conf/extra/vhost-list


將 git 拉出的 web 框架移至 home
tar zxvf dbmonitor.tar.gz -C /home/


編輯 web 框架設定
vim /home/dbmonitor/sys_config.phpvim /home/dbmonitor/masinfo.phpvim /home/dbmonitor/masinfo2.php
&lt;?phperror_reporting (16);$db_ip=&quot;localhost:/var/lib/mysql/mysql.sock&quot;;$db_user=&quot;laurance&quot;;$db_pas=&quot;123456&quot;;$go_user=&quot;laurance&quot;;$go_pas=&quot;123456&quot;;?&gt;


編輯 httpd-vhost 設定
vim httpd-vhosts.conf
NameVirtualHost *:80Include conf/extra/vhost-list/*.conf






編輯 dbmonitor 設定
vim  /usr/local/web/apache2/conf/extra/vhost-list/dbmonitor.conf
&lt;VirtualHost *:80&gt;    ServerAdmin root@localhost    DocumentRoot &quot;/home/dbmonitor/&quot;    ServerName dbmonitor.net    ServerAlias dbmonitor2.net    ErrorLog &quot;logs/dbmonitor.err&quot;    CustomLog &quot;logs/dbmonitor.acc&quot; common&lt;/VirtualHost&gt;


編輯 httpd 主設定檔
vim  /usr/local/web/apache2/conf/httpd.conf
## This is the main Apache HTTP server configuration file.  It contains the# configuration directives that give the server its instructions.# See &lt;URL:http://httpd.apache.org/docs/2.2&gt; for detailed information.# In particular, see # &lt;URL:http://httpd.apache.org/docs/2.2/mod/directives.html&gt;# for a discussion of each configuration directive.## Do NOT simply read the instructions in here without understanding# what they do.  They&#x27;re here only as hints or reminders.  If you are unsure# consult the online docs. You have been warned.  ## Configuration and logfile names: If the filenames you specify for many# of the server&#x27;s control files begin with &quot;/&quot; (or &quot;drive:/&quot; for Win32), the# server will use that explicit path.  If the filenames do *not* begin# with &quot;/&quot;, the value of ServerRoot is prepended -- so &quot;logs/foo_log&quot;# with ServerRoot set to &quot;/usr/local/web/apache2&quot; will be interpreted by the# server as &quot;/usr/local/web/apache2/logs/foo_log&quot;.## ServerRoot: The top of the directory tree under which the server&#x27;s# configuration, error, and log files are kept.## Do not add a slash at the end of the directory path.  If you point# ServerRoot at a non-local disk, be sure to point the LockFile directive# at a local disk.  If you wish to share the same ServerRoot for multiple# httpd daemons, you will need to change at least LockFile and PidFile.#ServerRoot &quot;/usr/local/web/apache2&quot;## Listen: Allows you to bind Apache to specific IP addresses and/or# ports, instead of the default. See also the &lt;VirtualHost&gt;# directive.## Change this to Listen on specific IP addresses as shown below to # prevent Apache from glomming onto all bound IP addresses.##Listen 12.34.56.78:80Listen 80## Dynamic Shared Object (DSO) Support## To be able to use the functionality of a module which was built as a DSO you# have to place corresponding `LoadModule&#x27; lines at this location so the# directives contained in it are actually available _before_ they are used.# Statically compiled modules (those listed by `httpd -l&#x27;) do not need# to be loaded here.## Example:# LoadModule foo_module modules/mod_foo.soLoadModule php5_module        modules/libphp5.so#LoadModule proxy_module       modules/mod_proxy.so#LoadModule proxy_http_module  modules/mod_proxy_http.so#&lt;IfModule !mpm_netware_module&gt;&lt;IfModule !mpm_winnt_module&gt;## If you wish httpd to run as a different user or group, you must run# httpd as root initially and it will switch.  ## User/Group: The name (or #number) of the user/group to run httpd as.# It is usually good practice to create a dedicated user and group for# running httpd, as with most system services.#User daemonGroup daemon&lt;/IfModule&gt;&lt;/IfModule&gt;# &#x27;Main&#x27; server configuration## The directives in this section set up the values used by the &#x27;main&#x27;# server, which responds to any requests that aren&#x27;t handled by a# &lt;VirtualHost&gt; definition.  These values also provide defaults for# any &lt;VirtualHost&gt; containers you may define later in the file.## All of these directives may appear inside &lt;VirtualHost&gt; containers,# in which case these default settings will be overridden for the# virtual host being defined.### ServerAdmin: Your address, where problems with the server should be# e-mailed.  This address appears on some server-generated pages, such# as error documents.  e.g. admin@your-domain.com#ServerAdmin you@example.com## ServerName gives the name and port that the server uses to identify itself.# This can often be determined automatically, but we recommend you specify# it explicitly to prevent problems during startup.## If your host doesn&#x27;t have a registered DNS name, enter its IP address here.#ServerName www.example.com:80## DocumentRoot: The directory out of which you will serve your# documents. By default, all requests are taken from this directory, but# symbolic links and aliases may be used to point to other locations.#DocumentRoot &quot;/usr/local/web/apache2//htdocs&quot;#DocumentRoot &quot;/home/dbmonitor&quot;## Each directory to which Apache has access can be configured with respect# to which services and features are allowed and/or disabled in that# directory (and its subdirectories). ## First, we configure the &quot;default&quot; to be a very restrictive set of # features.  #&lt;Directory /&gt;    Options FollowSymLinks    AllowOverride None    Order allow,deny    allow from all&lt;/Directory&gt;## Note that from this point forward you must specifically allow# particular features to be enabled - so if something&#x27;s not working as# you might expect, make sure that you have specifically enabled it# below.### This should be changed to whatever you set DocumentRoot to.#&lt;Directory &quot;/usr/local/web/apache2//htdocs&quot;&gt;    #    # Possible values for the Options directive are &quot;None&quot;, &quot;All&quot;,    # or any combination of:    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews    #    # Note that &quot;MultiViews&quot; must be named *explicitly* --- &quot;Options All&quot;    # doesn&#x27;t give it to you.    #    # The Options directive is both complicated and important.  Please see    # http://httpd.apache.org/docs/2.2/mod/core.html#options    # for more information.    #    Options Indexes FollowSymLinks    #    # AllowOverride controls what directives may be placed in .htaccess files.    # It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:    #   Options FileInfo AuthConfig Limit    #    AllowOverride None    #    # Controls who can get stuff from this server.    #    Order allow,deny    Allow from all&lt;/Directory&gt;## DirectoryIndex: sets the file that Apache will serve if a directory# is requested.#&lt;IfModule dir_module&gt;    DirectoryIndex index.html index.php indexs.php&lt;/IfModule&gt;## The following lines prevent .htaccess and .htpasswd files from being # viewed by Web clients. #&lt;FilesMatch &quot;^\.ht&quot;&gt;    Order allow,deny    Deny from all    Satisfy All&lt;/FilesMatch&gt;## ErrorLog: The location of the error log file.# If you do not specify an ErrorLog directive within a &lt;VirtualHost&gt;# container, error messages relating to that virtual host will be# logged here.  If you *do* define an error logfile for a &lt;VirtualHost&gt;# container, that host&#x27;s errors will be logged there and not here.#ErrorLog &quot;logs/error_log&quot;## LogLevel: Control the number of messages logged to the error_log.# Possible values include: debug, info, notice, warn, error, crit,# alert, emerg.#LogLevel warn&lt;IfModule log_config_module&gt;    #    # The following directives define some format nicknames for use with    # a CustomLog directive (see below).    #    LogFormat &quot;%h \&quot;%&#123;x-forwarded-for&#125;i\&quot; %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot;&quot; combined    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common    &lt;IfModule logio_module&gt;      # You need to enable mod_logio.c to use %I and %O      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot; %I %O&quot; combinedio    &lt;/IfModule&gt;    #    # The location and format of the access logfile (Common Logfile Format).    # If you do not define any access logfiles within a &lt;VirtualHost&gt;    # container, they will be logged here.  Contrariwise, if you *do*    # define per-&lt;VirtualHost&gt; access logfiles, transactions will be    # logged therein and *not* in this file.    #    CustomLog &quot;logs/access_log&quot; common    #    # If you prefer a logfile with access, agent, and referer information    # (Combined Logfile Format) you can use the following directive.    #    #CustomLog &quot;logs/access_log&quot; combined&lt;/IfModule&gt;&lt;IfModule alias_module&gt;    #    # Redirect: Allows you to tell clients about documents that used to     # exist in your server&#x27;s namespace, but do not anymore. The client     # will make a new request for the document at its new location.    # Example:    # Redirect permanent /foo http://www.example.com/bar    #    # Alias: Maps web paths into filesystem paths and is used to    # access content that does not live under the DocumentRoot.    # Example:    # Alias /webpath /full/filesystem/path    #    # If you include a trailing / on /webpath then the server will    # require it to be present in the URL.  You will also likely    # need to provide a &lt;Directory&gt; section to allow access to    # the filesystem path.    #    # ScriptAlias: This controls which directories contain server scripts.     # ScriptAliases are essentially the same as Aliases, except that    # documents in the target directory are treated as applications and    # run by the server when requested rather than as documents sent to the    # client.  The same rules about trailing &quot;/&quot; apply to ScriptAlias    # directives as to Alias.    #    ScriptAlias /cgi-bin/ &quot;/usr/local/web/apache2//cgi-bin/&quot;&lt;/IfModule&gt;&lt;IfModule cgid_module&gt;    #    # ScriptSock: On threaded servers, designate the path to the UNIX    # socket used to communicate with the CGI daemon of mod_cgid.    #    #Scriptsock logs/cgisock&lt;/IfModule&gt;## &quot;/usr/local/web/apache2/cgi-bin&quot; should be changed to whatever your ScriptAliased# CGI directory exists, if you have that configured.#&lt;Directory &quot;/usr/local/web/apache2//cgi-bin&quot;&gt;    AllowOverride None    Options None    Order allow,deny    Allow from all&lt;/Directory&gt;## DefaultType: the default MIME type the server will use for a document# if it cannot otherwise determine one, such as from filename extensions.# If your server contains mostly text or HTML documents, &quot;text/plain&quot; is# a good value.  If most of your content is binary, such as applications# or images, you may want to use &quot;application/octet-stream&quot; instead to# keep browsers from trying to display binary files as though they are# text.#DefaultType text/plain&lt;IfModule mime_module&gt;    #    # TypesConfig points to the file containing the list of mappings from    # filename extension to MIME-type.    #    TypesConfig conf/mime.types    #    # AddType allows you to add to or override the MIME configuration    # file specified in TypesConfig for specific file types.    #    #AddType application/x-gzip .tgz    #    # AddEncoding allows you to have certain browsers uncompress    # information on the fly. Note: Not all browsers support this.    #    #AddEncoding x-compress .Z    #AddEncoding x-gzip .gz .tgz    #    # If the AddEncoding directives above are commented-out, then you    # probably should define those extensions to indicate media types:    #    AddType application/x-compress .Z    AddType application/x-gzip .gz .tgz    AddType application/x-httpd-php .php .phtml    AddType application/x-httpd-php-source .phps    #    # AddHandler allows you to map certain file extensions to &quot;handlers&quot;:    # actions unrelated to filetype. These can be either built into the server    # or added with the Action directive (see below)    #    # To use CGI scripts outside of ScriptAliased directories:    # (You will also need to add &quot;ExecCGI&quot; to the &quot;Options&quot; directive.)    #    #AddHandler cgi-script .cgi    # For type maps (negotiated resources):    #AddHandler type-map var    #    # Filters allow you to process content before it is sent to the client.    #    # To parse .shtml files for server-side includes (SSI):    # (You will also need to add &quot;Includes&quot; to the &quot;Options&quot; directive.)    #    #AddType text/html .shtml    #AddOutputFilter INCLUDES .shtml&lt;/IfModule&gt;## The mod_mime_magic module allows the server to use various hints from the# contents of the file itself to determine its type.  The MIMEMagicFile# directive tells the module where the hint definitions are located.##MIMEMagicFile conf/magic## Customizable error responses come in three flavors:# 1) plain text 2) local redirects 3) external redirects## Some examples:#ErrorDocument 500 &quot;The server made a boo boo.&quot;#ErrorDocument 404 /missing.html#ErrorDocument 404 &quot;/cgi-bin/missing_handler.pl&quot;#ErrorDocument 402 http://www.example.com/subscription_info.html### MaxRanges: Maximum number of Ranges in a request before# returning the entire resource, or one of the special# values &#x27;default&#x27;, &#x27;none&#x27; or &#x27;unlimited&#x27;.# Default setting is to accept 200 Ranges.#MaxRanges unlimited## EnableMMAP and EnableSendfile: On systems that support it, # memory-mapping or the sendfile syscall is used to deliver# files.  This usually improves server performance, but must# be turned off when serving from networked-mounted # filesystems or if support for these functions is otherwise# broken on your system.##EnableMMAP off#EnableSendfile off# Supplemental configuration## The configuration files in the conf/extra/ directory can be # included to add extra features or to modify the default configuration of # the server, or you may simply copy their contents here and change as # necessary.# Server-pool management (MPM specific)#Include conf/extra/httpd-mpm.conf# Multi-language error messagesInclude conf/extra/httpd-multilang-errordoc.conf# Fancy directory listings#Include conf/extra/httpd-autoindex.conf# Language settingsInclude conf/extra/httpd-languages.conf# User home directories#Include conf/extra/httpd-userdir.conf# Real-time info on requests and configuration#Include conf/extra/httpd-info.conf# Virtual hostsInclude conf/extra/httpd-vhosts.conf# Local access to the Apache HTTP Server ManualInclude conf/extra/httpd-manual.conf# Distributed authoring and versioning (WebDAV)#Include conf/extra/httpd-dav.conf# Various default settingsInclude conf/extra/httpd-default.conf# Secure (SSL/TLS) connections#Include conf/extra/httpd-ssl.conf## Note: The following must must be present to support#       starting without SSL on platforms with no /dev/random equivalent#       but a statically compiled-in mod_ssl.#&lt;IfModule ssl_module&gt;SSLRandomSeed startup builtinSSLRandomSeed connect builtin&lt;/IfModule&gt;# Virtual dir for programmer use#Include conf/httpd-vdir.confAddDefaultCharset utf-8


重啟服務
/usr/local/web/apache2/bin/apachectl  graceful



PHP 不用設定

驗收 : 監控主從進度及 binlog





]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>Mysql - 如何查看和修改 DB 及 TABLE 編碼</title>
    <url>/blog.github.io/2023/06/03/Mysql-%E6%9F%A5%E7%9C%8B,%E4%BF%AE%E6%94%B9DB%E5%8F%8ATABLE%E7%B7%A8%E7%A2%BC/</url>
    <content><![CDATA[

查看 DB 編碼
SHOW VARIABLES LIKE &#x27;character_set%&#x27;;



修改 DB 編碼
ALTER DATABASE dbname CHARACTER SET utf8 COLLATE utf8_general_ci;



查看 TABLES 編碼
use dbname;SELECT @@character_set_database, @@collation_database;OR.SHOW FULL COLUMNS FROM tablename;OR.SHOW FULL FIELDS FROM tablename;



修改表的編碼為 UTF8
ALTER TABLE web CONVERT TO CHARACTER SET utf8;



查看 DB 內所有表的狀態
SHOW TABLE STATUS FROM tablename \G;


通過 SHOW CREATE TABLE 確認
SHOW CREATE TABLE web;







]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - 405 Not Allowed 解決方法</title>
    <url>/blog.github.io/2023/01/29/Nginx-405_Not_Allowed/</url>
    <content><![CDATA[
跨域存取錯誤 405 Not Allowed





解決方法

允許靜態頁使用 POST 方法
# To allow POST on static pageserror_page  405    :200 $uri ;



]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - Location 參數紀錄</title>
    <url>/blog.github.io/2022/08/03/Nginx-Location%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[

Location 的匹配模式


符號
代表意思



:
精确匹配


～
正則匹配 , 大小寫敏感


～*
正則匹配 , 大小寫不敏感


^~
忽略正則表達式的前綴匹配



沒有修飾符 , 前綴匹配


@
命名 location , 可用來做內部重定向




其中 = 和 ^~ 修饰符都可以認為是特殊形式的前缀匹配Location Example * :    server &#123;        listen 80 default_server;        server_name _;                # A        location: / &#123;                return 200 &quot;A&quot;;        &#125;        # B        location / &#123;                return 200 &quot;B&quot;;        &#125;        # C        location /docs &#123;                return 200 &quot;C&quot;;        &#125;        # D        location ^~ /imgs &#123;                return 200 &quot;D&quot;;        &#125;                # E        location ~* \.(gif|jpg|png)$ &#123;                return 200 &quot;E&quot;;        &#125;        # F        location ~ /a/.*$ &#123;                return 200 &quot;F&quot;;        &#125;    &#125;





input
output
說明



http://127.0.0.1
A
匹配到 A 跟 B  精确匹配优先级较高


http://127.0.0.1/test
B
只匹配到B


http://127.0.0.1/docs/1
C
匹配到 B 跟 C , C 前缀比 B 长


http://127.0.0.1/docs/2.jpg
E
匹配到 B 、 C 、 E  正则匹配比普通前缀匹配优先级高


http://127.0.0.1/imgs/1
D
只匹配到 B 、 D , D 前缀比 B 长


http://127.0.0.1/imgs/1.jpg
D
匹配到 B 、 D 、 E ，由于 D 是最长匹配且有 ^~ 修饰符，所以不会再检查正则匹配


http://127.0.0.1/docs/a/1
F
匹配到 B 、 C 、 F




Location @name 的用法@ 前綴可以用來定義一個命名的 location 該 location 不處理正常的外部請求,一般用來供內部重定向使用。它們不能嵌套,也不能包含嵌套的 locationLocation Example *        location /try &#123;        try_files $uri $uri/ @name;    &#125;        location /error &#123;        error_page 404: @name;        return 404;    &#125;        location @name &#123;        return 200 &quot;@name&quot;;    &#125;


這時訪問 /try 或者 /error 都會返回 @name
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - Proxy 常用配置</title>
    <url>/blog.github.io/2022/11/17/Nginx-Proxy%E5%8F%83%E6%95%B8/</url>
    <content><![CDATA[






常用參數語法
語法意思



      | proxy_set_header X-Real-IP $remote_addr; |						# 定義 header 記錄使用者真实 IP |
      | proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; |	                # 讓後端的 Web 伺服器可以取得使用者真實 IP |
      | proxy_redirect off; |								# 重新定向 url-OFF |
      | proxy_http_version 1.1; |								# 默认 http 版本为 1.0 , 开启对 http1.1 支持 |
      | proxy_pass http://127.0.0.1:3001; | |
      | proxy_set_header X_FORWARDED_HOST $host; |						# 客戶端調用服務端所使用的 host-ip |
      | #proxy_set_header X_FORWARDED_PORT 90; |						# 用於連接到負載均衡器的端口號 |
      | proxy_set_header Host $http_host; |							# 反向代理後標頭為 HOST 原始字段 |
      | proxy_ignore_client_abort on; |							# 默認是關閉的，即請求過程中如果客戶端主動關閉請求或者客戶端網絡斷掉，那麼 Nginx 會記錄 499 | 
      | proxy_read_timeout 300;	|							# 定義一個 nginx 等待 real server 響應數據的超時時間 |
      | proxy_ignore_headers &quot;Cache-Control&quot;;	|					#忽略被代理伺服器設定的 &quot;Cache-Control&quot; 頭資訊 |
      | add_header    Cache-Control  max-age=60; |					        # 客戶端本地的緩存，在配置的生存時間內的，客戶端可以直接使用 |
      | proxy_cache_valid  304 1m; |							# 對響應狀態碼為 304 的響應快取 1m |
      | proxy_cache_valid  301 302 1m; | |
      | proxy_cache two; | |
      | proxy_cache_valid any 1m; | |
      | proxy_cache_key $host$uri$is_args$args;	 |					# 每筆快取儲存的鍵值方式|






]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - Proxypass (範例)</title>
    <url>/blog.github.io/2022/12/13/Nginx-Proxypass_(HUGO)/</url>
    <content><![CDATA[

NGINX 開 port:1515 導向 HUGO-localhost:1313 範例

server &#123;    listen 1515;    listen [::]:1515;#    server_name ;        location  / &#123;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_redirect off;        proxy_http_version 1.1;        proxy_pass http://127.0.0.1:1313;        proxy_set_header X_FORWARDED_HOST $host;        proxy_set_header Host $http_host;        proxy_ignore_client_abort on;        proxy_read_timeout 300;        proxy_ignore_headers &quot;Cache-Control&quot;;        add_header X-Cache &quot;$upstream_cache_status from $server_addr&quot;;        add_header Cache-Control  max-age=60;        proxy_cache_valid  304 1m;#       proxy_cache two;        proxy_cache_key $host$uri$is_args$args;  &#125;    access_log logs/hugo-server/hugo-server.acc access;&#125;


]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - js/css 404 子路徑缺失替換方法</title>
    <url>/blog.github.io/2023/06/29/Nginx-js_css_%E8%B7%AF%E5%BE%91%E7%BC%BA%E5%A4%B1%E6%9B%BF%E6%8F%9B%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[

原因: 按下 F12 後,所有 js/css 全部變404 (當前路徑少一層目錄)

使用參數 sub_filter 替換該路徑

EX:

location ^~ /note &#123;alias  /root/web-server/config2/public/;sub_filter_types *;sub_filter &#x27;/css/&#x27; &#x27;/note/css/&#x27;;sub_filter &#x27;/lib/&#x27; &#x27;/note/lib/&#x27;;sub_filter &#x27;/svg/&#x27; &#x27;/note/svg/&#x27;;sub_filter &#x27;/js/&#x27; &#x27;/note/js/&#x27;;sub_filter &#x27;/tags/&#x27; &#x27;/note/tags/&#x27;;sub_filter &#x27;/fixit.min.svg&#x27; &#x27;/note/fixit.min.svg&#x27;;sub_filter_once off;access_log /root/web-server/hugoserver.acc;&#125;   







***

]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - log_format 參數配置</title>
    <url>/blog.github.io/2022/08/03/Nginx-log_format%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[






引數
說明
示例



$remote_addr
客戶端地址
192.168.122.1


$remote_user
客戶端使用者名稱稱
–


$time_local
訪問時間和時區
17&#x2F;Dec&#x2F;2018:10:47:58 +0800


$request
請求的 URI 和 HTTP 協議
“GET &#x2F; HTTP&#x2F;1.1”


|    $status      |            HTTP 請求狀態                      |               304 |
| $upstream_status   |      upstream 狀態                   |                    0 |
| $body_bytes_sent    |     傳送給客戶端檔案內容大小        |                 - |
| $http_referer      |      url 跳轉來源 , 用於記錄是從哪個頁面連結訪問過來的 |                                   
| $http_user_agent   |      使用者終端瀏覽器等資訊,即客戶瀏覽器的相關資訊    | &quot;Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0&quot; |
|   $http_host       |        請求地址，即瀏覽器中你輸入的地址（IP或域名）   |    www.wang.com 192.168.100.100 |
| $ssl_protocol      |      SSL協議版本                 |                       TLSv1 |
| $ssl_cipher       |       交換資料中的演算法       |                          RC4-SHA |
| $upstream_addr   |        後臺 upstream 的地址，即真正提供服務的主機地址  |     10.10.10.100:80 |
| $request_time     |       整個請求的總時間              |                     0.205 |
| $upstream_response_time  |  請求過程中 upstream 響應時間        |               0.002 |
| $http_x_forwarded_for	 |  客户端的真实 ip 如果包含多個 IP  |  X-Forwarded-For: client1, proxy1, proxy2, ... | 






]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - 加入 PageSpeed 模組及 nginx-http-concat</title>
    <url>/blog.github.io/2022/08/03/Nginx-%E5%8A%A0%E5%85%A5PageSpeed%E6%A8%A1%E7%B5%84%E5%8F%8Anginx-http-concat/</url>
    <content><![CDATA[

PageSpeed模組 (自動優化網站動態)下載

wget https://github.com/apache/incubator-pagespeed-ngx/archive/v1.13.35.2-stable.tar.gz    tar zxvf v1.13.35.2-stable.tar.gz    cd incubator-pagespeed-ngx-1.13.35.2-stable


這一步一定要做 不然 nginx 會無法加入模組 解壓縮會在根目錄下生成一個 psol 的資料夾 ( 解壓後將psol/放到incubator-pagespeed-ngx-1.13.35.2-stable/裡 )
cat PSOL_BINARY_URL    wget https://dl.google.com/dl/page-speed/psol/1.13.35.2-x64.tar.gz    tar zxvf 1.13.35.2-x64.tar.gz    cd ../    mv incubator-pagespeed-ngx-1.13.35.2-stable /usr/local/incubator-pagespeed-ngx-1.13.35.2-stable/



Nginx-http-concat 模組(合併HTTP請求)下載
wget https://github.com/alibaba/nginx-http-concat/archive/1.2.2.tar.gz    tar zxvf 1.2.2.tar.gz    mv nginx-http-concat-1.2.2/ /usr/local/nginx-http-concat/



編譯安裝 Nginxcd nginx-1.21.6/    ./configure --user=nginx --group=nginx --prefix=/usr/local/web/nginx --sbin-path=/usr/local/web/nginx/sbin/nginx --conf-path=/usr/local/web/nginx/conf/nginx.conf --error-log-path=/usr/local/web/nginx/logs/error.log --http-log-path=/usr/local/web/nginx/logs/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/lock/subsys/nginx --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module --with-pcre --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_secure_link_module --with-http_v2_module --with-http_stub_status_module --with-http_sub_module --add-module=/usr/local/incubator-pagespeed-ngx-1.13.35.2-stable/ --add-module=/usr/local/nginx-http-concat/    make &amp;&amp; make install

Ps 重新編譯的話不需要 make install


重新編譯完 Nginx 執行以下步驟/usr/local/web/nginx/sbin/nginx -s stop    cp /usr/local/nginx/sbin/nginx/ /usr/local/nginx/sbin/nginx.bak    cp /root/installation/nginx-1.21.6/objs/nginx /usr/local/nginx/sbin/nginx



檢查是否有加入模組
/usr/local/web/nginx/sbin/nginx -V```    ******    **在設定檔中加入以下 `pagespeed` 參數**```sqlvim /usr/local/web/nginx/conf/vhost/server.conf
server &#123;...  pagespeed on;  pagespeed FileCachePath /var/cache/nginx/ngx_pagespeed_cache;    location ~ &quot;\.pagespeed\.([a-z]\.)?[a-z]&#123;2&#125;\.[^.]&#123;10&#125;\.[^.]+&quot; &#123;      add_header &quot;&quot; &quot;&quot;;    &#125;    location ~ &quot;^/pagespeed_static/&quot; &#123; &#125;    location ~ &quot;^/ngx_pagespeed_beacon$&quot; &#123; &#125;...&#125;



重啟 nginx
/usr/local/web/nginx/sbin/nginx -s reload



更詳細的設定 PageSpeed 參數
  # Rewrite Levelpagespeed RewriteLevel CoreFilters;    # Minimize and optimize HTTP requestspagespeed EnableFilters rewrite_css;pagespeed EnableFilters rewrite_javascript;pagespeed EnableFilters combine_css;pagespeed EnableFilters combine_javascript;pagespeed EnableFilters inline_css;pagespeed CssInlineMaxBytes 4096;pagespeed EnableFilters inline_javascript;pagespeed JsInlineMaxBytes 4096;    # Image Optimization and lazy loadpagespeed EnableFilters rewrite_images;pagespeed EnableFilters inline_images;pagespeed EnableFilters resize_images;pagespeed EnableFilters recompress_images;    # Controlling the use of beaconspagespeed AvoidRenamingIntrospectiveJavascript off;pagespeed CriticalImagesBeaconEnabled false;




]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - 參數配置 tri_files $uri</title>
    <url>/blog.github.io/2023/02/19/Nginx-%E5%8F%83%E6%95%B8_tri_files_$uri/</url>
    <content><![CDATA[
進行內部重定向 URI 的 nginx 參數


按指定順序檢查文件是否存在，並使用第一個找到的文件進行請求處理

配置try_files $uri  $uri/ /index.html;


$uri  這個是 nginx 的一個變量，存放著用戶訪問的地址
EX： http://www.xxx.com/index.html 那麼 $uri 就是 /index.html

$uri/ 代表訪問的是一個目錄
EX： http://www.xxx.com/hello/test/ 那麼 $uri/ 就是 /hello/test/

比如用戶訪問這個網地址     http://www.xxx.com/test.htmltry_files 首先會判斷他是文件，還是一個目錄，結果發現他是文件，與第一個參數 $uri 變量匹配然後去到網站目錄下去查找 test.html 文件是否存在，如果存在直接讀取返回。如果不存在就跳去匹配 $uri/如果 $uri/  不存在則匹配原路徑底下 /index.html


]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - 常用的 LOG 搜索指令</title>
    <url>/blog.github.io/2022/08/03/Nginx-%E5%B8%B8%E7%94%A8%E7%9A%84LOG%E6%90%9C%E7%B4%A2%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[

統計IP訪問量awk &#x27;&#123;print $l&#125;&#x27; /var/log/nginx-access.log | sort -n | uniq | wc -l


查看某一時間段 IP 的訪問量grep &quot;14/Jul/2021:0[2-10]&quot; /var/log/nginx-access.log | awk &#x27;&#123;print $l&#125;&#x27; | sort | uniq -c | sort -nr | wc -l


查看訪問次數最頻繁的前100個IPawk &#x27;&#123;print $l&#125;&#x27; /var/log/nginx-access.log | sort -n | uniq -c | sort -rn | head -n 100


查看訪問次數100以上的IPawk &#x27;&#123;print $l&#125;&#x27; /var/log/nginx-access.log |sort -n |uniq -c |awk &#x27;&#123;if($l &gt;100) print $0 &#125; &#x27; | sort -rn


查詢某個IP的詳細訪問情況,按訪問頻率排序grep &#x27;172.16.0.6&#x27; /var/log/nginx-access.log |awk &#x27;&#123;print $7&#125;&#x27;|sort |uniq -c |sort -rn |head -n 100





查看訪問最頻繁的頁面awk &#x27;&#123;print $7&#125;&#x27; /var/log/nginx-access.log | sort | uniq -c | sort -rn | head -n 100


查看訪問最頻繁的頁面(排除PHP頁面)grep -v &quot;.php&quot; /var/log/nginx-access.log |awk &#x27;&#123;print $7&#125;&#x27;|sort|uniq -c|sort -rn|head -n 100


查看最近1000條紀錄,訪問量最高的頁面tail -1000 /var/log/nginx-access.log | awk &#x27;&#123;print $7&#125; &#x27; |sort|uniq -c|sort -nr|less


每秒請求量統計awk &#x27;&#123;print $4&#125;&#x27; /var/log/nginx-access.log |cut -c 14-21|sort|uniq -c|sort -nr|head -n 100


每分鐘請求統計awk &#x27;&#123;print $4&#125;&#x27; /var/log/nginx-access.log|cut -c 14-18|sort|uniq -c|sort -nr|head -n 100


每小時請求統計awk &#x27;&#123;print $4&#125;&#x27; /var/log/nginx-access.log |cut -c 14-15|sort|uniq -c|sort -nr|head -n 100





列出傳輸時間超過3秒的頁面,顯示前20條cat /var/log/nginx-access.log |awk &#x27;($NF &gt; 3)&#123;print $7&#125;&#x27;|sort -n|uniq -c|sort -nr|head -20


列出PHP頁面請求時間超過3秒的頁面,並統計其出現的次數,顯示前100條cat /var/log/nginx-access.log|awk &#x27;($NF &gt; 1 &amp;&amp;  $7~/\.php/)&#123;print $7&#125;&#x27;|sort -n|uniq -c|sort -nr|head -100





統計 抓取次數grep &#x27;Baiduspider&#x27; /var/log/nginx-access.log |wc -l


統計 抓取404的次數grep &#x27;Baiduspider&#x27; /var/log/nginx-access.log | grep &#x27;404&#x27; |wc -l





查看當前TCP連接數netstat -tan | grep &quot;ESTABLISHED&quot; | grep &quot;:80&quot; | wc -l


用 Tcpdump 嗅探80端口的訪問看誰高tcpdump -i enp0s3 -tnn dst port 80 -c 1000 | awk -F&quot;.&quot; &#x27;&#123;print $1&quot;.&quot;$2&quot;.&quot;$3&quot;.&quot;$4&#125;&#x27; | sort | uniq -c | sort -nr






參數
意思



head -5
# 前五行LOG 數據


sort -k 1nr
# 按照第一個字段 , 數值排序 , 且為逆序





]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - 重新編譯 &amp;&amp; 添加 echo 模組</title>
    <url>/blog.github.io/2023/03/13/Nginx-%E6%B7%BB%E5%8A%A0echo%E6%A8%A1%E7%B5%84/</url>
    <content><![CDATA[

安裝編譯環境
yum -y install pcre pcre-devel openssl openssl-devel gcc gcc-c++ zlib zlib-devel



在 Nginx 安裝包裡 下載 echo模組安裝包 &amp;&amp; 解壓縮
cd /root/installation/nginx-1.21.6/wget https://github.com/openresty/echo-nginx-module/archive/v0.61.tar.gztar zxvf v0.61.tar.gz



查看原本的編譯參數
/usr/local/web/nginx/sbin/nginx -V



重新編譯一次 (需進入原本安裝 nginx 的目錄底下編譯)
cd /root/installation/nginx-1.21.6./configure --user=nginx --group=nginx --prefix=/usr/local/web/nginx --sbin-path=/usr/local/web/nginx/sbin/nginx --conf-path=/usr/local/web/nginx/conf/nginx.conf --error-log-path=/usr/local/web/nginx/logs/error.log --http-log-path=/usr/local/web/nginx/logs/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/lock/subsys/nginx --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module --with-pcre --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_secure_link_module --with-http_v2_module --with-http_stub_status_module --with-http_sub_module --add-module=/usr/local/incubator-pagespeed-ngx-1.13.35.2-stable/ --add-module=/usr/local/nginx-http-concat/ --with-http_geoip_module --add-module=/root/installation/nginx-1.21.6/echo-nginx-module-0.61make  #不要 make install 會重複安裝



停 nginx 服務
/usr/local/web/nginx/sbin/nginx -s stop



將原本的執行檔備份為 nginx.bak
cp /usr/local/web/nginx/sbin/nginx /usr/local/web/nginx/sbin/nginx.bak



將新的執行檔複製到執行路徑裡
cp /root/installation/nginx-1.21.6/objs/nginx /usr/local/web/nginx/sbin/nginx



再次查看已編譯進去了
/usr/local/web/nginx/sbin/nginx -V



echo 模組用法:location /test &#123;      echo &quot;uri: $uri&quot;;      echo &quot;request_uri: $request_uri&quot;;  &#125; 





]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - 添加白名單 &amp; 封鎖國家 IP 方式</title>
    <url>/blog.github.io/2022/12/25/Nginx-%E6%B7%BB%E5%8A%A0%E7%99%BD%E5%90%8D%E5%96%AE%E7%9A%84%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[

1. IP 白名單文件讀取

建立白名單文件
vim /usr/local/web/nginx/conf/vhost/hugo/whitelist.conf

allow 172.16.0.6;


配置設定檔引入白名單文件
vim /usr/local/web/nginx/conf/vhost/hugo/hugo.conf
location  / &#123;    ...        ...        include /usr/local/web/nginx/conf/vhost/hugo/whitelist.conf;    deny all;    &#125;



2.國家IP封鎖

Nginx 主設定檔 的 http 區塊 加入 GEO 模塊 並引用 dat 文件

從 $remote_addr 這個變數 , 來定義 $ip_whitelist 這個變數

vim /usr/local/web/nginx/conf/nginx.conf
geoip_country /usr/local/web/nginx/conf/vhost/hugo/GeoCountry/country/maxmind.dat;geo $remote_addr $ip_whitelist &#123;    default 0;&#125;


建立一支定義 GEO 規則 的設定檔
vim /usr/local/web/nginx/conf/vhost/geoblock.conf
if ($ip_whitelist: 1) &#123;        break;&#125;if ($geoip_country_code ~ (JP|TW)) &#123;        return 403;&#125;


在配置的設定檔上 server 區塊 引用 GEO 規則 的設定檔
vim /usr/local/web/nginx/conf/vhost/hugo/hugo.conf
server &#123;    listen 1515;#    listen [::]:1515;    server_name note.laurance.com;    include vhost/geoblock.conf;        ...    ...     &#125;



使用 Nginx 阻擋國家 IP , 需要編譯模塊 http_geoip_module

下載 geoip 安裝包
yum install geoip-devel



ps. 若找不到安裝包,可先安裝 epel 倉庫  

yum install epel-release -y





檢查庫是否安裝成功
ldconfig -v | grep GeoIP        

libGeoIPUpdate.so.0 -&gt; libGeoIPUpdate.so.0.0.0libGeoIP.so.1 -&gt; libGeoIP.so.1.4.8libGeoIPUpdate.so.0 -&gt; libGeoIPUpdate.so.0.0.0libGeoIP.so.1 -&gt; libGeoIP.so.1.5.0


將 GeoIP 模塊 重新編譯到 Nginx 中 (原有的編譯參數可用 nginx -V 查看)
&#123;&#123; 不要 make install 否則覆蓋安裝就麻煩了 &#125;&#125;

./configure --user=nginx --group=nginx --prefix=/usr/local/web/nginx --sbin-path=/usr/local/web/nginx/sbin/nginx --conf-path=/usr/local/web/nginx/conf/nginx.conf --error-log-path=/usr/local/web/nginx/logs/error.log --http-log-path=/usr/local/web/nginx/logs/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/lock/subsys/nginx --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module --with-pcre --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_secure_link_module --with-http_v2_module --with-http_stub_status_module --with-http_sub_module --add-module=/usr/local/incubator-pagespeed-ngx-1.13.35.2-stable/ --add-module=/usr/local/nginx-http-concat/ --with-http_geoip_module    makeunlink /usr/sbin/nginx     mv /usr/local/web/nginx/sbin/nginx /usr/local/web/nginx/sbin/nginx-2023-01-01.bak    cp objs/nginx /usr/local/web/nginx/sbin/nginx    /usr/local/web/nginx/sbin/nginx -V


查看 GEO 模塊是否已編入
/usr/local/web/nginx/sbin/nginx -V 2&gt;&amp;1 | grep -o with-http_geoip_module```       ********下載 IP 數據庫 (dat 格式)**----- ******[ 第三方下載地址 ](https://www.miyuru.lk/geoiplegacy)*****下載同時包括 `Ipv4` 和 `Ipv6` 的 `country` 、 `city` 版本。**```sqlwget https://dl.miyuru.lk/geoip/maxmind/country/maxmind.dat.gz    gunzip maxmind.dat.gz    wget https://dl.miyuru.lk/geoip/maxmind/city/maxmind.dat.gz    gunzip maxmind.dat.gz


配置請看上面




國家相關參數
參數解釋



$geoip_country_code
#兩位字符的英文國家碼。如：CN, US


$geoip_country_code3
#三位字符的英文國家碼。如：CHN, USA


$geoip_country_name
#國家英文全稱。如：China, United States







城市相關參數
參數解釋



$geoip_city_country_code
#也是兩位字符的英文國家碼


$geoip_city_country_code3
#上同


$geoip_city_country_name
#上同


$geoip_region
#這個經測試是兩位數的數字，如杭州是02, 上海是 23。但是沒有搜到相關資料，希望知道的朋友留言告之。


$geoip_city
#城市的英文名稱。如：Hangzhou


$geoip_postal_code
#城市的郵政編碼。經測試，國內這字段為空


$geoip_city_continent_code
#不知什麼用途，國內好像都是 AS


$geoip_latitude
#緯度


$geoip_longitude
#經度




參考文件

]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - 配置 Nginx auth_basic 身分驗證</title>
    <url>/blog.github.io/2022/12/10/Nginx-%E9%85%8D%E7%BD%AENginx_auth_basic%E8%BA%AB%E5%88%86%E9%A9%97%E8%AD%89/</url>
    <content><![CDATA[

Nginx 默認就有安裝 ngx_http_auth_basic_module 模塊 ( 不用特別編譯 )

生成帳號 &amp;&amp; 密碼echo -n &#x27;root:&#x27; &gt;&gt; /usr/local/web/nginx/conf/mypasswords/.testpass.dav    openssl passwd -apr1 123456 &gt;&gt; /usr/local/web/nginx/conf/mypasswords/.testpass.dav






配置 Nginxserver &#123;            listen          80;        server_name     php-test.net;        index           index.php index.html;        root            /home/test/php;        include         vhost/file.conf;        access_log      logs/test/test.acc access;        auth_basic      &quot;authentication&quot;;        auth_basic_user_file /usr/local/web/nginx/conf/mypasswords/.testpass.dav;        &#125;```    ********配置file.conf (PHP)**-----   ```sqllocation ~ \.php$ &#123;        try_files $uri:404;        fastcgi_split_path_info ^(.+\.php)(/.+)$;        include fastcgi_params;        #fastcgi_index index.php;        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;        #fastcgi_intercept_errors on;        fastcgi_pass 127.0.0.1:9000;        &#125;            location ~ \.wav$ &#123;            add_header Content-Disposition &quot;inline&quot;;        &#125;```        ******   **Nginx 重啟吃設定**   ```sql/usr/local/web/nginx/sbin/nginx -t    /usr/local/web/nginx/sbin/nginx -s reload```    ******    **驗證:  Windows 本機綁 Host**    ```sql172.16.0.222 	php-test.net







]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx - 設定目錄密碼保護</title>
    <url>/blog.github.io/2022/08/03/Nginx-%E8%A8%AD%E5%AE%9A%E7%9B%AE%E9%8C%84%E5%AF%86%E7%A2%BC%E4%BF%9D%E8%AD%B7/</url>
    <content><![CDATA[

首先需要建立一個密碼檔, 裡面包含了使用者名稱 , 以及加密了的密碼 , 如果系統有安裝 Apache, 可以用以下語法建立密碼檔:
htpasswd -c /path/to/file/.htpasswd username



如果沒有 htpasswd 指令可以使用, 那便要手動建立密碼檔, 密碼檔的格式如下:
username:encrypted-password:comment

username 是使用者名稱, 可以自行定義, 而 encrypted-password 則是加密的密碼


建立密碼檔
vim /home/opencli/.htpasswd



將要設定的使用者名稱及上面的加密密碼複製到檔案, 即以下格式:
username:saoYYKpu2QSsA



開啟 Nginx 的設定檔
vim /etc/nginx/conf.d/default.conf



假設我要設定密碼保護的目錄是 /usr/share/nginx/html/admin 在 server 段落加入以下幾行:
location /admin/ &#123;    auth_basic &quot;Restricted&quot;;    auth_basic_user_file /home/opencli/.htpasswd;&#125;





儲存檔案後需要重新啟動 Nginx
systemctl restart nginx



]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>OpenSSL - 安裝 OpenSSL-3.1.2 並移除舊版本 (原因: nodejs-v16.18.1 不支援 openssl-1.1.1q)</title>
    <url>/blog.github.io/2023/08/04/OpenSSL-%E5%AE%89%E8%A3%9Dopenssl-3_1_2/</url>
    <content><![CDATA[

移除舊版本whereis openssl | xargs rm -frv



安裝依賴yum install perl-ExtUtils-CBuilder perl-ExtUtils-MakeMaker perl-CPAN perl-IPC-Cmd



下載安裝包wget https://github.com/openssl/openssl/releases/download/openssl-3.1.2/openssl-3.1.2.tar.gz



編譯安裝./config --prefix=/usr/local/opensslmakemake installecho &quot;/usr/local/openssl/lib64&quot; &gt;&gt; /etc/ld.so.confln -s /usr/local/openssl/bin/openssl /usr/bin/opensslldconfig /usr/local/lib64/



查看版本openssl version




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>OpenSSL</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP - 自行編譯安裝 (版本:php-7.0.1)</title>
    <url>/blog.github.io/2022/08/03/PHP-%E4%BD%BF%E7%94%A8tarball%E5%AE%89%E8%A3%9D/</url>
    <content><![CDATA[

安裝依賴

yum -y install dos2unix libzip libzip-devel libncurses*yum -y install gcc*yum -y install openssl openssl-develyum -y install openldap openldap-develyum -y install libjpeg-devel yum -y install libpng-develyum -y install libxml2-develyum -y install libevent-develyum -y install curl-develyum -y install freetype-develyum -y install m4yum -y install autoconfyum -y install unzipyum -y install git yum -y updateyum clean all



tar zxvf libiconv-1.14.tar.gzcd libiconv-1.14/./configure --prefix=/usr/local/webmakemake installcd ../tar zxvf libmcrypt-2.5.8.tar.gzcd libmcrypt-2.5.8/./configuremakemake install/sbin/ldconfigcd libltdl/./configure --enable-ltdl-installmakemake installcd ../../tar zxvf mhash-0.9.9.9.tar.gzcd mhash-0.9.9.9/./configuremakemake installcd ../tar zxvf mcrypt-2.6.8.tar.gzcd mcrypt-2.6.8//sbin/ldconfigexport LD_LIBRARY_PATH=/usr/local/lib: LD_LIBRARY_PATH./configuremakemake installcd ../tar zxvf libgd-2.2.5.tar.gzcd libgd-2.2.5./configure --bindir=/usr/sbin/ --sbindir=/usr/sbin/ --libexecdir=/usr/libexec --sysconfdir=/etc/ --localstatedir=/var --libdir=/usr/lib64/  --includedir=/usr/include/ --datarootdir=/usr/share --infodir=/usr/share/info --localedir=/usr/share/locale --mandir=/usr/share/man/ --docdir=/usr/share/doc/libgdmakemake installcd ../



ln -s /usr/local/lib/libmcrypt.la /usr/lib/libmcrypt.laln -s /usr/local/lib/libmcrypt.so /usr/lib/libmcrypt.soln -s /usr/local/lib/libmcrypt.so.4 /usr/lib/libmcrypt.so.4ln -s /usr/local/lib/libmcrypt.so.4.4.8 /usr/lib/libmcrypt.so.4.4.8ln -s /usr/local/lib/libmhash.a /usr/lib/libmhash.aln -s /usr/local/lib/libmhash.la /usr/lib/libmhash.laln -s /usr/local/lib/libmhash.so /usr/lib/libmhash.soln -s /usr/local/lib/libmhash.so.2 /usr/lib/libmhash.so.2ln -s /usr/local/lib/libmhash.so.2.0.1 /usr/lib/libmhash.so.2.0.1ln -s /usr/local/bin/libmcrypt-config /usr/bin/libmcrypt-configcp -frp /usr/lib64/libldap* /usr/lib/



安裝 php ( 版本:7.0.1 )

官網安裝tar包


tar -zxvf php-7.0.1.tar.gz&#x27;./configure&#x27; &#x27;--prefix=/usr/local/web/php&#x27; &#x27;--with-config-file-path=/usr/local/web/php/etc&#x27; &#x27;--with-mysqli&#x27; &#x27;--with-iconv-dir=/usr/local&#x27;  &#x27;--with-freetype-dir&#x27; &#x27;--with-jpeg-dir&#x27; &#x27;--with-gd&#x27; &#x27;--enable-gd-native-ttf&#x27; &#x27;--with-zlib&#x27; &#x27;--enable-libxml&#x27; &#x27;--enable-xml&#x27; &#x27;--disable-rpath&#x27; &#x27;--enable-bcmath&#x27; &#x27;--enable-shmop&#x27; &#x27;--enable-sysvsem&#x27; &#x27;--enable-inline-optimization&#x27; &#x27;--with-curl&#x27; &#x27;--enable-mbregex&#x27; &#x27;--enable-fpm&#x27; &#x27;--enable-mbstring&#x27;  &#x27;--with-openssl&#x27; &#x27;--with-mhash&#x27; &#x27;--enable-pcntl&#x27; &#x27;--enable-sockets&#x27; &#x27;--with-ldap&#x27; &#x27;--with-ldap-sasl&#x27; &#x27;--with-xmlrpc&#x27; &#x27;--enable-zip&#x27; &#x27;--enable-soap&#x27; &#x27;--enable-opcache&#x27; &#x27;--enable-ftp&#x27; &#x27;--enable-sysvshm&#x27; &#x27;--with-mcrypt&#x27; sed -i &#x27;s/-lcrypto -lcrypt.*/&amp; -llber/g&#x27; Makefilemake &amp;&amp; make install



cp php.ini-production /usr/local/web/php/etc/php.inicp sapi/fpm/php-fpm.service /usr/lib/systemd/system/cp /usr/local/web/php/etc/php-fpm.conf.default /usr/local/web/php/etc/php-fpm.confcp /usr/local/web/php/etc/php-fpm.d/www.conf.default /usr/local/web/php/etc/php-fpm.d/www.conf




]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP - 如何安裝 MongoDB 擴展</title>
    <url>/blog.github.io/2022/08/15/PHP-%E5%AE%89%E8%A3%9DMongoDB%E6%93%B4%E5%B1%95/</url>
    <content><![CDATA[

MongoDB 安裝包


wget http://pecl.php.net/get/mongodb-1.3.4.tgz    tar -zxvf mongodb-1.3.4.tgz    cd mongodb-1.3.4.tgz    /usr/local/web/php/bin/phpize        ./configure -with-php-config=/usr/local/web/php/bin/php-config        make &amp; make test &amp; make install



vim /usr/local/php/etc/php.ini    ```        ```sqlextension=mongodb.so




]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP - 如何安裝 memcached 擴展</title>
    <url>/blog.github.io/2022/09/30/PHP-%E5%AE%89%E8%A3%9Dmemcached%E6%93%B4%E5%B1%95/</url>
    <content><![CDATA[

memcached 安裝包


wget https://pecl.php.net/get/memcached-3.0.3.tgz   tar zxvf memcached-3.0.3.tgz      cd memcached-3.0.3    /usr/local/web/php/bin/phpize    ./configure -with-php-config=/usr/local/web/php/bin/php-config    make &amp;&amp; make install    



vim /usr/local/php/etc/php.ini    

extension=memcached.so




]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP - 如何安裝 Redis 擴展</title>
    <url>/blog.github.io/2022/08/15/PHP-%E5%AE%89%E8%A3%9DRedis%E6%93%B4%E5%B1%95/</url>
    <content><![CDATA[

REDIS


wget http://pecl.php.net/get/redis-4.0.0RC2.tgz        tar zxvf redis-4.0.0RC2.tgz    cd redis-4.0.0RC2    /usr/local/web/php/bin/phpize    ./configure -with-php-config=/usr/local/web/php/bin/php-config    make &amp;&amp; make install    



vim /usr/local/php/etc/php.ini    
extension=redis.so




]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP - 查看擴展服務版本</title>
    <url>/blog.github.io/2022/10/21/PHP-%E6%9F%A5%E7%9C%8B%E6%93%B4%E5%B1%95%E6%9C%8D%E5%8B%99%E7%89%88%E6%9C%AC/</url>
    <content><![CDATA[

查看是否安裝該套件
php -m |grep mongodb



查看該套件版本
php --ri mongodb




]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP - 添加到系統啟動 systemctl</title>
    <url>/blog.github.io/2022/08/03/PHP-%E6%B7%BB%E5%8A%A0%E7%B3%BB%E7%B5%B1%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[

Centos7 配置 systemctl-php-fpm 服務

增加 php-fpm 的 pid 設定檔
vim /usr/local/php/etc/php-fpm.conf

; Pid file; Note: the default prefix is /usr/local/php/var; Default Value: nonepid: /var/run/php-fpm.pid



新增 php-fpm 系統服務
touch /usr/lib/systemd/system/php-fpm.service



編輯 php-fpm 系統服務設定
vim /usr/lib/systemd/system/php-fpm.service

[Unit]Description=The PHP FastCGI Process ManagerAfter=syslog.target network.target[Service]Type=forkingPIDFile=/var/run/php-fpm.pidExecStart=/usr/local/php/sbin/php-fpmExecReload=/bin/kill -USR2 $MAINPIDPrivateTmp=true[Install]WantedBy=multi-user.target



重啟系統管理配置服務
systemctl daemon-reload



啟動服務 php-fpm
systemctl start php-fpm




]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP - 如何使用 YUM 安裝</title>
    <url>/blog.github.io/2022/08/03/PHP-%E4%BD%BF%E7%94%A8yum%E5%AE%89%E8%A3%9D/</url>
    <content><![CDATA[

安装依賴

yum -y install gcc gcc-c++



安裝 EPEL 和 Remi存儲庫
yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpmyum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm



安装 yum-utils
這是一組用於管理 yum存儲庫和包的有用程序。它有基本上擴展 yum默認功能 的工具
yum -y install yum-utils



使用 yum 管理 啟用該版本 php

[安装 PHP 7.1]
yum-config-manager --enable remi-php71

[ 安装 PHP 7.2 ]
yum-config-manager --enable remi-php72 

[ 安装 PHP 7.3 ]
yum-config-manager --enable remi-php73





安裝 phpyum -y install php php-mcrypt php-devel php-cli php-gd php-pear php-curl php-fpm php-mysql php-ldap php-zi



查看 php 版本
[root@VM_159_140_centos lnmp]# php -v




]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP - 開啟及關閉錯誤訊息輸出</title>
    <url>/blog.github.io/2022/12/03/PHP-%E9%96%8B%E5%95%9F%E5%8F%8A%E9%97%9C%E9%96%89%E9%8C%AF%E8%AA%A4%E8%A8%8A%E6%81%AF%E8%BC%B8%E5%87%BA/</url>
    <content><![CDATA[

開啟錯誤提示
display_errors: On



關閉錯誤提示
display_errors: Off



輸出全部錯誤
error_reporting E_ALL



除了 Notice 外，全部錯誤輸出
error_reporting E_ALL &amp; ~E_NOTICE



不輸出任何錯誤
error_reporting 0 



]]></content>
      <categories>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PhpStorm - 使用 putty-key pem 連接方式</title>
    <url>/blog.github.io/2022/10/17/PHPstorm-IDEKEY_%E9%80%A3%E6%8E%A5%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[

新增一個 New Project


   


選擇 Create &gt;&gt; Open in new window &gt;&gt; OK


   


打開遠端部署 Development 設定介面


   


按下 + &gt;&gt; Name &gt;&gt; Type: SFTP


   


測試登入 選擇 Test SFTP connection 即可
SFTP host: IPPort : 22            Root path: / User name: jimide            Auth type: OpenSSH or Putty            Private key file: admin-jimide.pem



   


   



]]></content>
      <categories>
        <category>PhpStorm</category>
      </categories>
      <tags>
        <tag>PhpStorm</tag>
      </tags>
  </entry>
  <entry>
    <title>PMA - 環境安裝</title>
    <url>/blog.github.io/2022/11/22/PMA-%E7%92%B0%E5%A2%83%E5%AE%89%E8%A3%9D/</url>
    <content><![CDATA[

PMA 環境搭建

下載 PMA 安裝包wget https://files.phpmyadmin.net/phpMyAdmin/4.9.10/phpMyAdmin-3.4.9-all-languages.tar.gz    tar zxvf phpMyAdmin-3.4.9-all-languages.tar.gz    cp -Rf phpMyAdmin-3.4.9-all-languages /home/phpMyAdmin    cd /home/phpMyAdmin    cp config.sample.inc.php config.inc.php



編輯 PMA 設定檔[ 注意 !! 實測不能單台多套 ]
vim config.inc.php
&lt;?php/* vim: set expandtab sw=4 ts=4 sts=4: *//** * phpMyAdmin sample configuration, you can use it as base for * manual configuration. For easier setup you can use setup/ * * All directives are explained in documentation in the doc/ folder * or at &lt;https://docs.phpmyadmin.net/&gt;. * * @package PhpMyAdmin *//** * This is needed for cookie based authentication to encrypt password in * cookie. Needs to be 32 chars long. *///$cfg[&#x27;blowfish_secret&#x27;]: &#x27;3d21cb29984ee1ebccec07d650032&#x27;; /* YOU MUST FILL IN THIS FOR COOKIE AUTH! *///$cfg[&#x27;blowfish_secret&#x27;]: &#x27;&#x27;;//$cfg[&#x27;UploadDir&#x27;]: &#x27;&#x27;;//$cfg[&#x27;SaveDir&#x27;]: &#x27;&#x27;;$cfg[&#x27;blowfish_secret&#x27;]: &#x27;laurance&#x27;; /* YOU MUST FILL IN THIS FOR COOKIE AUTH! */$cfg[&#x27;PmaAbsoluteUri&#x27;]: &#x27;http://phpmyadmin.project.orz/&#x27;;$cfg[&#x27;UploadDir&#x27;]: &#x27;&#x27;;$cfg[&#x27;SaveDir&#x27;]: &#x27;&#x27;;/** * Servers configuration */$i: 0;/** * First server *///----------------------------------------------------------------------- pma/pma$i++;/* Authentication type */$cfg[&#x27;Servers&#x27;][$i][&#x27;auth_type&#x27;]: &#x27;http&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;host&#x27;]: &#x27;172.16.0.222&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;port&#x27;]: &#x27;3306&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;user&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;password&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;extension&#x27;]: &#x27;mysqli&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;compress&#x27;]: false;$cfg[&#x27;Servers&#x27;][$i][&#x27;AllowNoPassword&#x27;]: true;/* Advanced phpMyAdmin features */$cfg[&#x27;Servers&#x27;][$i][&#x27;pmadb&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;bookmarktable&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;relation&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;table_info&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;table_coords&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;pdf_pages&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;column_info&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;history&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;designer_coords&#x27;]: &#x27;&#x27;;$cfg[&#x27;Servers&#x27;][$i][&#x27;tracking&#x27;]: &#x27;&#x27;;//----------------------------------------------------------------------- pmas/pmas/* Server parameters *///$cfg[&#x27;Servers&#x27;][$i][&#x27;auth_type&#x27;]: &#x27;http&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;host&#x27;]: &#x27;172.16.0.222&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;port&#x27;]: &#x27;3307&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;user&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;password&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;extension&#x27;]: &#x27;mysqli&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;compress&#x27;]: false;//$cfg[&#x27;Servers&#x27;][$i][&#x27;AllowNoPassword&#x27;]: true;/* Advanced phpMyAdmin features *///$cfg[&#x27;Servers&#x27;][$i][&#x27;pmadb&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;bookmarktable&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;relation&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;table_info&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;table_coords&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;pdf_pages&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;column_info&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;history&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;designer_coords&#x27;]: &#x27;&#x27;;//$cfg[&#x27;Servers&#x27;][$i][&#x27;tracking&#x27;]: &#x27;&#x27;;//-----------------------------------------------------------------------/** * phpMyAdmin configuration storage settings. *//* User used to manipulate with storage */// $cfg[&#x27;Servers&#x27;][$i][&#x27;controlhost&#x27;]: &#x27;&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;controlport&#x27;]: &#x27;&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;controluser&#x27;]: &#x27;pma&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;controlpass&#x27;]: &#x27;pmapass&#x27;;/* Storage database and tables */// $cfg[&#x27;Servers&#x27;][$i][&#x27;pmadb&#x27;]: &#x27;phpmyadmin&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;bookmarktable&#x27;]: &#x27;pma__bookmark&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;relation&#x27;]: &#x27;pma__relation&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;table_info&#x27;]: &#x27;pma__table_info&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;table_coords&#x27;]: &#x27;pma__table_coords&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;pdf_pages&#x27;]: &#x27;pma__pdf_pages&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;column_info&#x27;]: &#x27;pma__column_info&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;history&#x27;]: &#x27;pma__history&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;table_uiprefs&#x27;]: &#x27;pma__table_uiprefs&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;tracking&#x27;]: &#x27;pma__tracking&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;userconfig&#x27;]: &#x27;pma__userconfig&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;recent&#x27;]: &#x27;pma__recent&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;favorite&#x27;]: &#x27;pma__favorite&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;users&#x27;]: &#x27;pma__users&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;usergroups&#x27;]: &#x27;pma__usergroups&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;navigationhiding&#x27;]: &#x27;pma__navigationhiding&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;savedsearches&#x27;]: &#x27;pma__savedsearches&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;central_columns&#x27;]: &#x27;pma__central_columns&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;designer_settings&#x27;]: &#x27;pma__designer_settings&#x27;;// $cfg[&#x27;Servers&#x27;][$i][&#x27;export_templates&#x27;]: &#x27;pma__export_templates&#x27;;/** * End of servers configuration *//** * Directories for saving/loading files from server *///$cfg[&#x27;UploadDir&#x27;]: &#x27;&#x27;;//$cfg[&#x27;SaveDir&#x27;]: &#x27;&#x27;;/** * Whether to display icons or text or both icons and text in table row * action segment. Value can be either of &#x27;icons&#x27;, &#x27;text&#x27; or &#x27;both&#x27;. * default: &#x27;both&#x27; *///$cfg[&#x27;RowActionType&#x27;]: &#x27;icons&#x27;;/** * Defines whether a user should be displayed a &quot;show all (records)&quot; * button in browse mode or not. * default: false *///$cfg[&#x27;ShowAll&#x27;]: true;/** * Number of rows displayed when browsing a result set. If the result * set contains more rows, &quot;Previous&quot; and &quot;Next&quot;. * Possible values: 25, 50, 100, 250, 500 * default: 25 *///$cfg[&#x27;MaxRows&#x27;]: 50;/** * Disallow editing of binary fields * valid values are: *   false    allow editing *   &#x27;blob&#x27;   allow editing except for BLOB fields *   &#x27;noblob&#x27; disallow editing except for BLOB fields *   &#x27;all&#x27;    disallow editing * default: &#x27;blob&#x27; *///$cfg[&#x27;ProtectBinary&#x27;]: false;/** * Default language to use, if not browser-defined or user-defined * (you find all languages in the locale folder) * uncomment the desired line: * default: &#x27;en&#x27; *///$cfg[&#x27;DefaultLang&#x27;]: &#x27;en&#x27;;//$cfg[&#x27;DefaultLang&#x27;]: &#x27;de&#x27;;/** * How many columns should be used for table display of a database? * (a value larger than 1 results in some information being hidden) * default: 1 *///$cfg[&#x27;PropertiesNumColumns&#x27;]: 2;/** * Set to true if you want DB-based query history.If false, this utilizes * JS-routines to display query history (lost by window close) * * This requires configuration storage enabled, see above. * default: false *///$cfg[&#x27;QueryHistoryDB&#x27;]: true;/** * When using DB-based query history, how many entries should be kept? * default: 25 *///$cfg[&#x27;QueryHistoryMax&#x27;]: 100;/** * Whether or not to query the user before sending the error report to * the phpMyAdmin team when a JavaScript error occurs * * Available options * (&#x27;ask&#x27; | &#x27;always&#x27; | &#x27;never&#x27;) * default: &#x27;ask&#x27; *///$cfg[&#x27;SendErrorReports&#x27;]: &#x27;always&#x27;;/** * You can find more configuration options in the documentation * in the doc/ folder or at &lt;https://docs.phpmyadmin.net/&gt;. */```   ******   **PMA 設定檔解析**   ```sql$cfg[&#x27;Servers&#x27;][$i][&#x27;auth_type&#x27;]: &#x27;config&#x27;






參數
參數意思



config
安全性最差也最方便，因為你必須將 MySQL 帳號、密碼 儲存在 config 之中，換句話說你不需要輸入帳號密碼即可登入


http
只要使用 MySQL 中建立的有效帳號即可登入


cookie
MySQL帳號、密碼 會儲存在 cookie之中，不過在本次 session結束之後會將密碼刪除


採用 cookie的驗證方式，需要再額外設定 blowfish_secret 用來作為加密的 key





MySQL 設定MySQL 加 帳號 及 權限
CREATE USER &#x27;pma&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;pma&#x27;;    grant all on *.* to &#x27;pma&#x27;@&#x27;%&#x27;;    flush privileges;



Nginx 設定server&#123;       listen      80;       server_name phpmyadmin.project.orz;       index       index.php index.html;       root /home/pma/;       include vhost/file1.conf;       access_log  logs/pma/pma.acc access;&#125;



測試驗證

Windows 本機綁 hosts
172.16.0.222 phpmyadmin.project.orz



phpmyadmin.project.orz 登入
[mysql 帳密登入]



]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>PMA</tag>
      </tags>
  </entry>
  <entry>
    <title>Postgresql - install postgresql-14.7 on centos7</title>
    <url>/blog.github.io/2023/03/21/Postgresql-%E5%AE%89%E8%A3%9Dpostgresql-14_7_on_centos7/</url>
    <content><![CDATA[
自行編譯低版本 PSQL-14.7


安裝依賴套件
yum install gcc gcc-c++ readline-devel zlib-devel openssl openssl-devel



下載安裝 cmake編譯器
wget -t 0 https://github.com/Kitware/CMake/releases/download/v3.23.1/cmake-3.23.1.tar.gztar zxf cmake-3.23.1.tar.gzcd cmake-3.23.1./bootstrap &amp;&amp; gmake &amp;&amp; gmake installcmake --version```  ********下載 `postgresql-14.7 tar包`**```sqlwget https://ftp.postgresql.org/pub/source/v14.7/postgresql-14.7.tar.gz --no-check-certificatetar zxf postgresql-14.7.tar.gzcd postgresql-14.7./configure --prefix=/var/lib/postgresqlmake &amp;&amp; make install



新增 postgres 使用者來執行 DB
useradd postgres



建立存放資料及 LOG 的位置並給予權限 for postgres
cd /var/lib/postgresql/mkdir datamkdir logchown -R postgres.postgres /var/lib/postgresql



添加 psql環境變數
su - postgres -c &quot;vim ~/.bash_profile&quot;
export PGHOME=/var/lib/postgresqlexport PGDATA=/var/lib/postgresql/dataexport PATH=$PATH:$JAVA_HOME/bin:$PGHOME/bin



初始化資料庫及指定存放資料位置
su - postgres -c &quot;/var/lib/postgresql/bin/initdb -D /var/lib/postgresql/data/&quot;



更改設定檔 &amp;&amp; 設定監聽位置
vim /var/lib/postgresql/data/postgresql.conf

listen_addresses: &#x27;*&#x27; 	port: 5432 



設定 使用者 及 IP段
vim /var/lib/postgresql/data/pg_hba.conf
host    all             rd              10.140.0.0/16           password



切換使用者 &amp;&amp; 啟動 PostgreSQL
su - postgres -c &quot;/var/lib/postgresql/bin/pg_ctl start -l /var/lib/postgresql/log/pg_server.log&quot;



切換使用者 &amp;&amp; 重啟 PostgreSQL
su - postgres -c &quot;/var/lib/postgresql/bin/pg_ctl restart&quot;



切換使用者 &amp;&amp; 建立 超級使用者帳號
su - postgres -c &quot;createuser -s -i -d -l -r king&quot;



常用參數



參數
參數代表意思



-s , –superuser
新使用者將是超級使用者


-i , –inherit
新角色將自動繼承其所屬角色的權限。這是預設值


-d , –createdb
將允許新使用者建立資料庫


-l , –login
將允許新使用者登入（即，使用者名稱可以用作初始連線使用者）這是預設值


-r , –createrole
將允許新使用者建立新角色（即，此使用者將具有 CREATEROLE 權限）


切換使用者 &amp;&amp; 建立 普通使用者
su - postgres -c &quot;createuser -d -l -P rd&quot;

ps : -p , --pwprompt 如果有此選項，createuser 將發出新使用者密碼的提示。如果您不打算使用密碼身份驗證，則毌須執行此操作。


切換使用者 &amp;&amp; 進入 psql cmd
su - postgres -c &quot;psql&quot;



設定使用者 rd 對 public 新 Sequences 的預設權限
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT USAGE ON SEQUENCES TO rd;



設定使用者 rd 對 public 新 表 的預設權限
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT USAGE ON TABLES TO rd;

ps : 要先建立 database 才能用使用者連線


官方 yum 安裝: https://jovepater.com/article/centos-7-postgresql-14-installation/
參考: https://pjchender.dev/database/psql-roles-privilege/
參考: https://blog.csdn.net/zou8944/article/details/121528128

]]></content>
      <categories>
        <category>Postgresql</category>
      </categories>
      <tags>
        <tag>Postgresql</tag>
      </tags>
  </entry>
  <entry>
    <title>Postgresql - 常用指令</title>
    <url>/blog.github.io/2023/03/21/Postgresql-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[
PSQL 指令紀錄


連接到 POSTGRESQL 資料庫su - postgres -c &#x27;psql&#x27;

本地使用者連接 POSTGRESQL 資料庫添加環境變數 才能用 psql 連接
psql -d postgres -U  user 

連接到另一台SERVER上的資料庫psql -h 172.16.0.223 -U test1 -d testdb


建立使用者新建立的使用者預設只會繼承 public 角色中所開放的權限，其餘權限都沒有開放
CREATE USER test WITH PASSWORD &#x27;test&#x27;;

禁止使用者登入ALTER ROLE username WITH NOLOGIN;

設定使用者test擁有public預設權限 並有讀取、插入、修改、刪除新表的 預設權限ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT, INSERT, UPDATE, DELETE ON TABLES TO test;

設定使用者test擁有public預設權限 並有使用新sequences的 預設權限ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT USAGE ON SEQUENCES TO test;

把所有角色的 USAGE 權限收回REVOKE USAGE ON SCHEMA public FROM PUBLIC;


建立資料庫 testdbCREATE DATABASE testdb;

移除資料庫每個使用者都能登入的權限REVOKE CONNECT ON DATABASE testdb FROM public;

指定可以登入的使用者 pguser1, pguser2, pgreaderGRANT CONNECT ON DATABASE testdb TO pguser1, pguser2, pgreader;


顯示最大連接數show max_connections;

查看 alter default privileges 預設權限\ddp

列出有效的 schema\dn

查看表結構\d table_name

列出當前資料庫所有表\dt

離開\q

參考:
http://www.enmalvi.com/2022/04/03/postgresql-sql/

]]></content>
      <categories>
        <category>Postgresql</category>
      </categories>
      <tags>
        <tag>Postgresql</tag>
      </tags>
  </entry>
  <entry>
    <title>Prometheus - MySQL 監控建立</title>
    <url>/blog.github.io/2022/12/06/Prometheus-MySQL%E7%9B%A3%E6%8E%A7+grafana%E5%B1%95%E7%A4%BA/</url>
    <content><![CDATA[

MySQL 建立 exporter帳號
create user &#x27;exporter&#x27;@&#x27;%&#x27; identified by &#x27;exporter&#x27;;GRANT REPLICATION CLIENT, PROCESS ON *.* TO &#x27;exporter&#x27;@&#x27;%&#x27;;GRANT SELECT ON performance_schema.* TO &#x27;exporter&#x27;@&#x27;%&#x27;;flush privileges;



下載 agent
wget https://github.com/prometheus/mysqld_exporter/releases/download/v0.13.0/mysqld_exporter-0.13.0.linux-amd64.tar.gztar zxvf mysqld_exporter-0.13.0.linux-amd64.tar.gz  cd mysqld_exporter-0.13.0.linux-amd64/



在 mysqld_exporter 這層放置設定檔 (這邊是多套,所以分開寫)
vim mysqld_exporter-0.13.0.linux-amd64/.my.cnf
[client]user=exporter   password=exporterhost=172.16.0.222   port=3306   [client]   user=exporter   password=exporter   host=172.16.0.222   port=3307



將 exporter 寫入 systemctl
vim /usr/lib/systemd/system/mysqld_export.service
[Unit]   Description=Mysqld_exporter   After=network-online.target   [Service]   Type=simple   ExecStart=/root/prometheus/mysqld_exporter-0.13.0.linux-amd64/mysqld_exporter \   --config.my-cnf=/root/prometheus/mysqld_exporter-0.13.0.linux-amd64/.my.cnf   Restart=on-failure   StartLimitInterval=1   RestartSec=3   [Install]   WantedBy=multi-user.target



重啟 systemctl 
systemctl daaemon-reload



開啟 agent
systemctl start mysqld_export



驗證一下
curl localhost:9104/metrics



   



]]></content>
      <categories>
        <category>Prometheus</category>
      </categories>
      <tags>
        <tag>Prometheus</tag>
      </tags>
  </entry>
  <entry>
    <title>如何將 CentOS6 升級 python2.6.6 至 2.7</title>
    <url>/blog.github.io/2023/06/03/Python2_6_6%E5%8D%87%E7%B4%9A%E8%87%B3Python2_7-CentOS6/</url>
    <content><![CDATA[
CentOS6 預設 python版本為2.6.6如何安裝 python2.7 pip 工具


安裝 Python2.7
cd /usr/local/srcyum install openssl-devel zlib-devel readline-devel sqlite-devel -ywget https://www.python.org/ftp/python/2.7.10/Python-2.7.10.tgztar -zxvf Python-2.7.10.tgz



cd Python-2.7.10./configure --enable-shared --enable-loadable-sqlite-extensions --prefix=/usr/local/python27 --with-zlib --with-sslvim ./Modules/Setup	# 將以下內容去掉註解zlib zlibmodule.c -I$(prefix)/include -L$(exec_prefix)/lib -lzmake &amp;&amp; make install



cd /usr/bin/ls python* -lmv /usr/bin/python /usr/bin/python2.6.6ln -s /usr/local/python27/bin/python2.7 /usr/bin/python

執行 python -V 遇到如下報錯
python: error while loading shared libraries: libpython2.7.so.1.0: cannot open shared object file: No such file or directory

原因：linux系統默認沒有把/usr/local/python27/lib路徑加入動態庫搜索路徑

解決方法
vim /etc/ld.so.conf	# 添加以下內容/usr/local/python27/libldconfig -v	# 生效python -VPython 2.7.10



解決 yum 兼容性問題:
因為 yum 是不兼容 Python 2.7 的，所以 yum 不能正常工作，我們需要指定 yum 的 Python 為 2.6

vim /usr/bin/yum	# 第一行修改為 python2.6.6#!/usr/bin/python2.6.6



安裝 python2.7 pip工具:wget https://bootstrap.pypa.io/pip/2.7/get-pip.pypython get-pip.pymv /usr/bin/pip /usr/bin/pip2.6.6ln -s /usr/local/python27/bin/pip2.7 /usr/bin/pippip -Vpip 20.3.4 from /usr/local/python27/lib/python2.7/site-packages/pip (python 2.7)



]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache - 如何記錄真實IP</title>
    <url>/blog.github.io/2024/01/04/Python2_7%E5%8D%87%E7%B4%9A%E6%88%90Python3_6-CentOS7/</url>
    <content><![CDATA[

下載模組

 wget https://github.com/ttkzw/mod_remoteip-httpd22/archive/refs/heads/master.zipunzip mod_remoteip-httpd22-master.zipcd mod_remoteip-httpd22-masterapxs -i -c -n mod_remoteip.so mod_remoteip.c



修改設定檔 (在最下面新增模組)LoadModule remoteip_module modules/mod_remoteip.so



修改紀錄 LOG的格式 (修改為以下)LogFormat &quot;%h %&#123;X-Forwarded-For&#125;i %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot;&quot; combinedLogFormat &quot;%h %&#123;X-Forwarded-For&#125;i %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; commonLogFormat &quot;%h %a %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot; %I %O&quot; combinedio





]]></content>
      <categories>
        <category>Apache</category>
      </categories>
      <tags>
        <tag>Apache</tag>
      </tags>
  </entry>
  <entry>
    <title>Rclone - 啟動腳本 {CentOS7}</title>
    <url>/blog.github.io/2023/02/01/Rclone%E5%95%9F%E5%8B%95%E8%85%B3%E6%9C%AC_%7BCentOS7%7D/</url>
    <content><![CDATA[

[官方 Global Flags] https://rclone.org/flags/?utm_source=ld246.com
[參考文獻] https://ld246.com/article/1600853705300


cat &lt;&lt;EOF |tee /usr/lib/systemd/system/rclone.service# User service for Rclone mounting## Place in ~/.config/systemd/user/# File must include the &#x27;@&#x27; (ex rclone@.service)# As your normal user, run #   systemctl --user daemon-reload# You can now start/enable each remote by using rclone@&lt;remote&gt;#   systemctl --user enable rclone@drive#   systemctl --user start rclone@drive#   Global Flags https://rclone.org/flags/?utm_source=ld246.com[Unit]Description=rclone: Remote FUSE filesystem for cloud storage configDocumentation=man:rclone(1)After=network-online.targetWants=network-online.targetAssertPathIsDirectory=/home/web-note[Service]Type=notifyExecStartPre=/bin/mkdir -p /home/web-noteExecStart= \  /usr/bin/rclone mount -P \    --config /root/.config/rclone/rclone.conf \    --allow-non-empty \    --allow-other \    --vfs-cache-mode full \    --vfs-cache-max-size 500M \    --dir-cache-time 5m \    --poll-interval 1m \    --vfs-read-chunk-size-limit 128M \    --vfs-read-chunk-size-limit off \    --log-level INFO \    --log-file /var/log/rclone/rclone.log \    --bwlimit 0 \    --umask 022 \    hward: /home/web-noteExecStop=/bin/fusermount -uz /home/web-noteRestart=alwaysRestartSec=10[Install]WantedBy=default.targetEOF



設置開機啟動
systemctl enable rclone



常用參數


|  Rclone 常用參數	                                        | 功能								                                                                                            ||  —————————————————– 	| —————————————————————————————————————               ||  Type&#x3D;notify  								        	| 掛載點被成功配置之後 service 會進行啟動狀態						                                                            ||  -P                       								| 顯示實時速度                                                                                                    			   	||  –allow-non-empty 									    | 允許掛載到非空目錄（Not Windows）		                                                                                        ||  –allow-other									        | 允許其他用戶訪問				                                    	                                                        ||  –vfs-cache-mode full								    | 緩存模式 off|minimal|writes|full (default off)						                                                        ||  –vfs-cache-max-size 500M 						    	| 緩存中對象的最大總大小（默認關閉）		                                                                                    ||  –dir-cache-time 5m   							    	| 緩存時間							                            	                                                            ||  –poll-interval 1m 				                        | 在輪詢更改之間等待的時間。 必須小於 dir-cache-time	                                                                        ||  –vfs-read-chunk-size-limit off                          | 最大緩存大小 (默認是 “off”)                                                                                                   ||  –log-level INFO 									    | 允許掛載到非空目錄（Not Windows）		                                                                                        ||  –log-format LIST									    | 可配置 date, time, microseconds, longfile, shortfile, UTC. 默認是 “date,time”				                                ||  –log-file &#x2F;var&#x2F;log&#x2F;rclone&#x2F;rclone.log					| 緩存模式 off|minimal|writes|full (default off)						                                                        ||  –bwlimit 40M 						    	            | 限制速度40MB		                                                                                                            ||  –umask 022   							    	        | 每一個新產生的檔案會是644 (rw-r–r–)							                            	                                ||  Restart&#x3D;always 				                            | 自動啟動	                                                                                                                    |

]]></content>
      <categories>
        <category>Rclone</category>
      </categories>
      <tags>
        <tag>Rclone</tag>
      </tags>
  </entry>
  <entry>
    <title>Rclone - 掛載 google drive 作為本地硬碟使用 </title>
    <url>/blog.github.io/2023/02/01/Rclone%E6%8E%9B%E8%BC%89google_drive%E4%BD%9C%E7%82%BA%E6%9C%AC%E5%9C%B0%E7%A1%AC%E7%A2%9F%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[

掛載 google drive 作為本地硬碟使用 (mount google drive)

Rclone 官方教學


設定並驗證好 rclone步驟 :

設定步驟請參考


安裝依賴
yum install fuse



將 drive mount 到本地 linux
rclone mount  &lt;gdrive剛剛輸入的代稱&gt;:&lt;根目錄以下的雲端路徑&gt; &lt;mount 本地的路徑&gt;&gt;rclone mount  &lt;gdrive剛剛輸入的代稱&gt;:&lt;根目錄以下的雲端路徑&gt; &lt;mount 本地的路徑&gt;
rclone mount hward: /home/web-note --allow-other --allow-non-empty --vfs-cache-mode full --daemon



取消掛載指令
fusermount -qzu &#123;本地路徑&#125;





Mount 之前





Mount 之後





常用語法

|  rclone命令範例	                                        | 功能								                                                                                            ||  —————————————————– 	| —————————————————————————————————————               ||  –allow-other								        	| 允許非當前 rclone 用戶外其它用戶進行訪問						                                                            	||  –attr-timeout 5m        								| 文件屬性緩存，（大小，修改時間等）的時間。如果 VPS 配置比較低，建議適當提高這個值，避免過多內核交互，降低資源佔用			   	||  -vfs-cache-mode full 									| 開啟 VFS 文件緩存，可減少 rclone 與 API 交互，同時可提高文件讀寫效率		                                                    ||  –vfs-cache-max-age 24h									| VFS 文件緩存時間，這裡設置 24 小時，如果文件很少更改，建議設置更長時間				                                    	||  –vfs-cache-max-size 10G								    | VFS文件緩存上限大小，建議不超過當前空餘磁盤的50%						                                                        ||  vfs-read-chunk-size-limit 100M							| 分塊讀取大小，這裡設置的是100M，可提高文件讀的效率，比如1G的文件，大致分為10個塊進行讀取，但與此同時API請求次數也會增多		||  –buffer-size 100M   							    	| 內存緩存，如果您內存比較小，可降低此值，如果內存比較大，可適當提高							                            	||  –daemon				                                   	| 指後台方式運行	                                                                                                            |



]]></content>
      <categories>
        <category>Rclone</category>
      </categories>
      <tags>
        <tag>Rclone</tag>
      </tags>
  </entry>
  <entry>
    <title>Rclone - 安裝 Rclone &amp;&amp; 如何遠端備份至雲端 drive</title>
    <url>/blog.github.io/2022/11/27/Rclone%E9%81%A0%E7%AB%AF%E5%82%99%E4%BB%BD%E8%87%B3%E9%9B%B2%E7%AB%AF_Drive/</url>
    <content><![CDATA[

安裝依賴
yum install curl unzip man-db



安裝 Rclone
curl https://rclone.org/install.sh | bash






建立設定檔並進入交互式操作
rclone config



回答 n 以建立新的遠端服務 
name 這邊以 goodle-drive 示範





打入 Google Drive 對應序號 18









client_id  
通常直接按 enter 不需填入

client_secret  
通常直接按 enter 不需填入

scope  
選 1 獲取全部權限







root_folder_id  
通常直接按 enter 不需填入

service_account_file  
通常直接按 enter 不需填入

Edit advanced config ?  
選 n 不需要進階設定







Use web browser to automatically authenticate rclone with remote ?  
選 n 遠程取 Token

config_token&gt;  
看到這個後,需至 windows 介面登陸取 token



取 Token 看下面操作 





以下至 Windows 進行操作，驗證登入取 TOKEN


在本地 Windows 下載 rcloneRclone Windows 載點


載完解壓縮至慣用資料夾


   


WIN + X + A 呼叫出 Powershell


cd 至剛剛壓縮的資料夾底下 [.exe執行檔這層]


執行語法 
.\rclone authorize &quot;要驗證的雲端&quot;

ps. google_drive 為 drive    


 


驗證完成後會出現以下畫面


 


最後將剛剛 powershell 驗證過的 TOKEN 貼入 LINUX


 



Configure this as a Shared Drive (Team Drive)?選 n 不配置為共享

Keep this “euorg” remote?選 y 確認此配置


常用語法 (以 dropbox 為例)

|  rclone命令範例	                                        | 功能								    ||  —————————————————– 	| ————————————- ||  rclone lsd dropbox:路徑									| 列出資料夾						  	||  rclone ls dropbox:路徑									| 列出檔案 (路徑，大小)				   	||  rclone lsl dropbox:路徑									| 列出檔案的修改時間、路徑、大小等		||  rclone size dropbox:路徑									| 路徑 的檔案大小合計					||  rclone mkdir dropbox:路徑								| 建立資料夾 路徑						||  rclone rmdir dropbox:路徑								| 移除資料夾 路徑						||  rclone delete dropbox:路徑								| 刪除檔案								||  rclone –min-size 100M lsl dropbox:doc					| 列出 &#x2F;doc 資料夾裡超過100MB的檔案		||  rclone –dry-run –min-size 100M delete dropbox:doc		| 測試一下會刪掉那些檔					||  rclone –min-size 100M delete dropbox:doc				| 確定刪除								||  rclone copy d:\doc\test.doc dropbox:doc					| 拷貝檔案								||  rclone copy dropoox:doc dropbox:backup&#x2F;20160315			| 直接在Dropbox上拷貝檔案				||  rclone sync d:\doc dropbox:doc							| 同步處理								||  rclone -v												| 顯示所有指令與選項之說明				|



]]></content>
      <categories>
        <category>Rclone</category>
      </categories>
      <tags>
        <tag>Rclone</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis - Another Redis Desktop Manager 建立遠端連線</title>
    <url>/blog.github.io/2022/10/13/Redis-Another_Redis_Desktop_Manager%E5%BB%BA%E7%AB%8B%E9%81%A0%E7%AB%AF%E9%80%A3%E7%B7%9A/</url>
    <content><![CDATA[

Another Redis Desktop Manager for windows 載點


建立新連線





測試成功






]]></content>
      <categories>
        <category>Cache</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis - 安裝及配置教學</title>
    <url>/blog.github.io/2022/09/30/Redis-Redis%E5%AE%89%E8%A3%9D%E6%95%99%E5%AD%B8/</url>
    <content><![CDATA[

Index of redis 載點


下載完成後解壓
tar zxvf redis-4.0.6.tar.gz    cd /root/redis-4.0.6    make MALLOC=libc    make PREFIX=/usr/local/redis install



redis 設定檔配置
mkdir /usr/local/redis/etc/    cp redis.conf /usr/local/redis/etc/    cd /usr/local/redis/bin/    cp redis-benchmark redis-cli redis-server /usr/bin/



修改 redis 設定
vim /usr/local/redis/etc/redis.conf    bind 0.0.0.0    daemonize yes    requirepass (password設置)



redis ( 腳本 ) 
ps. 若有改 port 或設置密碼 腳本也需要更改
vim redis
#!/bin/bash#chkconfig: 2345 80 90# Simple Redis init.d script conceived to work on Linux systems# as it does use of the /proc filesystem.PATH=/usr/local/bin:/sbin:/usr/bin:/binREDISPORT=6379EXEC=/usr/local/redis/bin/redis-serverREDIS_CLI=/usr/local/redis/bin/redis-cliPIDFILE=/var/run/redis_6379.pidCONF=&quot;/usr/local/redis/etc/redis.conf&quot;#PW=(password)case &quot;$1&quot; instart)if [ -f $PIDFILE ]thenecho &quot;$PIDFILE exists, process is already running or crashed&quot;elseecho &quot;Starting Redis server...&quot;$EXEC $CONFfiif [ &quot;$?&quot;=&quot;0&quot; ]thenecho &quot;Redis is running...&quot;fi;;stop)if [ ! -f $PIDFILE ]thenecho &quot;$PIDFILE does not exist, process is not running&quot;elsePID=$(cat $PIDFILE)echo &quot;Stopping ...&quot;#$REDIS_CLI -p -a (password) $REDISPORT --no-auth-warning SHUTDOWN$REDIS_CLI -p  $REDISPORT SHUTDOWNwhile [ -x $&#123;PIDFILE&#125; ]doecho &quot;Waiting for Redis to shutdown ...&quot;sleep 1doneecho &quot;Redis stopped&quot;fi;;restart|force-reload)$&#123;0&#125; stop$&#123;0&#125; start;;*)echo &quot;Usage: /etc/init.d/redis &#123;start|stop|restart|force-reload&#125;&quot; &gt;&amp;2exit 1esac



複製腳本至啟動檔位置,並給予權限
cp redis /etc/init.d/    chmod 755 /etc/init.d/redis



添加至開機啟動 (centos 6)
chkconfig --add redis    chkconfig --level 2345 redis on    chkconfig --list |grep redis



添加至開機啟動 (centos 7)
systemctl enable redis    systemctl is-enabled redis   // 檢查 redis 是否設置為開機啟動```    ********開啟服務**   ```sqlservice redis start



若出現 ERROR :“Warning: Using a password with ‘-a’ or ‘-u’ option on the command line interface may not be safe”

加上參數即可: --no-auth-warning



]]></content>
      <categories>
        <category>Cache</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis - 主從跟隨建立</title>
    <url>/blog.github.io/2023/01/20/Redis-%E4%B8%BB%E5%BE%9E%E8%B7%9F%E9%9A%A8%E5%BB%BA%E7%AB%8B/</url>
    <content><![CDATA[

Redis 主從設定只需更動 Slave 設定即可


Slave Server:

關閉 redis-slave-server




修改 redis 設定檔
vim /usr/local/redis/etc/redis.conf



將 redis 編號
:set nu



在設定檔的第 327 行 增加設定 REPLICATION 區塊
slave-read-only no



註解第 326 行 設定
#replica-read-only yes



再開啟 redis 服務
systemctl start redis



登入並將 Slave 資料清空
redis-cli -h 127.0.0.1 -p 6739 -a 密碼    flushall    OK



再將服務關閉
systemctl stop redis



在設定檔的第 313 行 增加設定
slave-serve-stale-data yes



註解第 312 行設定
#replica-serve-stale-data yes



在設定檔的第 290 &amp; 291 行增加設定 (Master資訊)
slaveof 172.16.0.222 6739    masterauth passwd



在設定檔的第 327 行 修改設定
slave-read-only yes



開啟 redis 服務
systemctl start redis



進去查看是否已重跟
redis-cli -h 127.0.0.1 -p 9736 -a 密碼    127.0.0.1:9736&gt; info Replication



以下參數要是這樣 才算正常跟隨
master_link_status:up    master_last_io_seconds_ago:0    master_sync_in_progress:0






PS:重新跟隨狀態會比較慢更新 (大約要等 2分鐘 狀態才會變成 up)



]]></content>
      <categories>
        <category>Cache</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis - 安裝 reids-dump 及備份</title>
    <url>/blog.github.io/2022/10/22/Redis-%E5%AE%89%E8%A3%9Dreids-dump%E5%82%99%E4%BB%BD/</url>
    <content><![CDATA[

需先安裝 redis-cli

安裝 ruby跟 gem
yum -y install ruby ruby-develyum -y install rubygems



使用 gem 裝 rvm


載入 來源及憑證
gem sources -a http://mirrors.aliyun.com/rubygems/gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB






使用腳本安裝
curl -sSL https://get.rvm.io | bash -s stable






若報錯 ERROR : 讀不到憑證 再重新載入一次即可

curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -curl -sSL https://rvm.io/pkuczynski.asc | gpg2 --import -



再重新安裝一次
curl -sSL https://get.rvm.io | bash -s stable






載入 rvm腳本
source /etc/profile.d/rvm.sh



rvm版本 確認
rvm -v






再用 rvm 升級 ruby

安裝 ruby 2.5 版
rvm install 2.5



ruby 版本確認


ruby --version






再用 gem安裝 redis-dump
gem install redis-dump






若報錯 ERROR : 需要再安裝 yajl-ruby





重新再安裝一次即可
gem install yajl-ruby -v 1.4.1gem install redis-dump






redis 備份 及 匯入語法 ( 可以使用別台的 IP 遠端備份 )

備份語法
redis-dump -u 127.0.0.1:9736 -a &#x27;redisPasword&#x27; &gt; /root/info-redis-bak.json


匯入語法
&lt;info-redis-bak.json redis-load -u 127.0.0.1:9736



]]></content>
      <categories>
        <category>Cache</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis - 常用指令</title>
    <url>/blog.github.io/2023/01/19/Redis-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[

常用語法




指令
說明



keys *
查看所有鍵


exists 
判斷某個鍵是否存在


type 
查看鍵的類型


del 
刪除某個鍵


expire  
為鍵設置過期時間


ttl 
查看還有多少秒過期


dbsize
查看當前數據庫的key的數量




刪除指令




指令
說明



flushdb
清空當前庫


flushall
清空所有庫





]]></content>
      <categories>
        <category>Cache</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis - 如何設置 Redis 密碼</title>
    <url>/blog.github.io/2022/10/13/Redis-%E8%A8%AD%E7%BD%AERedis%E5%AF%86%E7%A2%BC/</url>
    <content><![CDATA[

方法一

修改 redis 設定檔 (requirepass 參數)
PWD: /usr/local/redis/etc/redis.conf



 


修改完之後重啟服務
service redis restart



方法二

進服務修改 Password (此方法 Redis 重啟後，密碼會失效)
進入 redis cmd 設定密碼
config set requirepass 123456



查詢密碼
config get requirepass



驗證密碼
auth 123456
config get requirepass        1) &quot;requirepass&quot;    2) &quot;123456&quot;


登入指令
redis-cli -p 6379 -a test123
redis 127.0.0.1:6379&gt; auth test123




]]></content>
      <categories>
        <category>Cache</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>Rsync - 如何在 Windows 和 Linux 間進行文件同步操作 (在 Linux 下語法)</title>
    <url>/blog.github.io/2023/06/10/Rsync-%E5%9C%A8Windows%E5%92%8CLinux%E9%96%93%E9%80%B2%E8%A1%8C%E6%96%87%E4%BB%B6%E5%90%8C%E6%AD%A5%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[
來源 : Rsync-server: Windows 172.16.XXX.XXX
目的 : Rsync-client: Linux 172.16.XX.XX


Windows 設置 Rsync Server端
安裝 cwRsyncServer
cwRsyncServer 下載地址

解壓後,安裝執行檔 [安裝過程會輸入需要同步的帳號及密碼]


Rsync Server 端設定
到需要同步的目錄下, 新建剛剛的帳號 rsync , 並給予該目錄的權限





修改 rsyncd.conf 預設路徑: C:\Program Files (x86)\ICW

[mypath]path: /cygdrive/c/Users/Laurance/Desktop/TESTread only: falsetransfer logging: yesauth users: rsyncsecrets file: etc/rsyncd.secretsuid: 0gid: 0


在目錄 etc 裡面新建密碼文件  文件名稱: rsyncd.secrets

格式為: rsync:XXXXXX



將 Rsync 服務設置為自動
開啟 Windows 搜尋 系統管理工具



點擊 服務 &gt; 找到 RsyncServer &gt; 右鍵點選內容 將啟動類型改為 自動




Windows 開啟火牆 rsync port: 873
開啟 Windows內建火牆 &gt; 點選進階設定 &gt; 點選輸入規則 &gt; 點選新增規則



新建火牆規則: TCP 873 Port






Linux 設置 Rsync Client端
安裝 Rsync Client
yum install rsync



設置 Client 端 密碼文件
echo &quot;XXXXX&quot; &gt; /root/hugo-server/rsync.passwordchmod 600 /root/hugo-server/rsync.password

ps. 若沒設置權限 600 會報錯: ERROR: password file must not be other-accessible


測試同步:
rsync -vzrtopg --password-file=rsync.password --port=873 --progress --delete rsync@172.16.XX.XX::mypath /root/test



Rsync 參數說明



參數
代表意思



-v
顯示詳細資訊


-z
壓縮傳輸資料


-r
子目錄遞迴


-t
複製時間屬性


-o
複製擁有者屬性


-p
複製檔案權限


-g
複製群組屬性



]]></content>
      <categories>
        <category>Rsync</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Rsync</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux - 如何設定 Rsyslog 日誌遠端集中式管理</title>
    <url>/blog.github.io/2022/12/21/Rsyslog%E6%97%A5%E8%AA%8C%E9%81%A0%E7%AB%AF%E9%9B%86%E4%B8%AD%E5%BC%8F%E7%AE%A1%E7%90%86/</url>
    <content><![CDATA[


透過 Rsyslog服務同步寫 LOG 至 LOG機 並使用排程管理


查看 rsyslog 相關配置   
rpm -qc rsyslog

/etc/logrotate.d/syslog/etc/rsyslog.conf/etc/sysconfig/rsyslog



查看版本
rsyslogd -v

rsyslogd 8.24.0-57.el7_9.3, compiled with:		PLATFORM:				x86_64-redhat-linux-gnu		PLATFORM (lsb_release -d):				FEATURE_REGEXP:				Yes		GSSAPI Kerberos 5 support:		Yes		FEATURE_DEBUG (debug build, slow code):	No		32bit Atomic operations supported:	Yes		64bit Atomic operations supported:	Yes		memory allocator:			system default		Runtime Instrumentation (slow code):	No		uuid support:				Yes		Number of Bits in RainerScript integers: 64



CLIENT 端設定

rsyslog 設定檔配置
vim /etc/rsyslog.conf
# rsyslog configuration file# For more information see /usr/share/doc/rsyslog-*/rsyslog_conf.html# If you experience problems, see http://www.rsyslog.com/doc/troubleshoot.html#### MODULES ##### The imjournal module bellow is now used as a message source instead of imuxsock.$ModLoad imuxsock # provides support for local system logging (e.g. via logger command)$ModLoad imjournal # provides access to the systemd journal#$ModLoad imklog # reads kernel messages (the same are read from journald)#$ModLoad immark  # provides --MARK-- message capability#$ModLoad imfile# Provides UDP syslog reception#$ModLoad imudp#$UDPServerRun 514# Provides TCP syslog reception#$ModLoad imtcp#$InputTCPServerRun 514#### GLOBAL DIRECTIVES ##### Where to place auxiliary files$WorkDirectory /var/lib/rsyslog# Use default timestamp format$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat# File syncing capability is disabled by default. This feature is usually not required,# not useful and an extreme performance hit#$ActionFileEnableSync on# Include all config files in /etc/rsyslog.d/$IncludeConfig /etc/rsyslog.d/*.conf# Turn off message reception via local log socket;# local messages are retrieved through imjournal now.$OmitLocalLogging on# File to store the position in the journal$IMJournalStateFile imjournal.state#### RULES ##### Log all kernel messages to the console.# Logging much else clutters up the screen.#kern.*                                                 /dev/console# Log anything (except mail) of level info or higher.# Don&#x27;t log private authentication messages!*.info;mail.none;authpriv.none;cron.none                /var/log/messages# The authpriv file has restricted access.authpriv.*                                              /var/log/secure.log# Log all the mail messages in one place.mail.*                                                  -/var/log/maillog.log# Log cron stuffcron.*                                                  /var/log/cron.log# Everybody gets emergency messages*.emerg                                                 :omusrmsg:*# Save news errors of level crit and higher in a special file.uucp,news.crit                                          /var/log/spooler.log# Save boot messages also to boot.loglocal7.*                                                /var/log/boot.log#*.* 							                        @@172.16.0.223:514:msg, contains, &quot;PHP&quot;					                @172.16.0.223       #紀錄在messages裡有&quot;PHP&quot;關鍵字的LOG#include(file=&quot;/etc/rsyslog.d/*.conf&quot;)#:programname,isequal,&quot;dhclient&quot;                         /var/log/dhclient.log#:programname,isequal,&quot;ec2net&quot;                           /var/log/dhclient.log# ### begin forwarding rule #### The statement between the begin ... end define a SINGLE forwarding# rule. They belong together, do NOT split them. If you create multiple# forwarding rules, duplicate the whole block!# Remote Logging (we use TCP for reliable delivery)## An on-disk queue is created for this action. If the remote host is# down, messages are spooled to disk and sent when it is up again.#$ActionQueueFileName fwdRule1 # unique name prefix for spool files#$ActionQueueMaxDiskSpace 1g   # 1gb space limit (use as much as possible)$ActionQueueSaveOnShutdown on # save messages to disk on shutdown#$ActionQueueType LinkedList   # run asynchronously#$ActionResumeRetryCount -1    # infinite retries if host is down# remote host is: name/ip:port, e.g. 192.168.0.1:514, port optional#*.* @@remote-host:514# ### end of the forwarding rule ###$IncludeConfig /etc/rsyslog.d/*.conf



rsyslog 服務重啟
systemctl restart rsyslog



nginx 設定檔配置 ( 配置要寫入 LOG機 的服務 LOG )
web-server-log
server &#123;    listen 1515;    listen [::]:1515;    server_name note.laurance.com;        location  / &#123;#       auth_basic      &quot;authentication&quot;;#       auth_basic_user_file conf/mypasswords/.hugopass.dev;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_redirect off;        proxy_http_version 1.1;        proxy_pass http://127.0.0.1:1313;        proxy_set_header X_FORWARDED_HOST $host;        proxy_set_header Host $http_host;        proxy_ignore_client_abort on;        proxy_read_timeout 300;        proxy_ignore_headers &quot;Cache-Control&quot;;        add_header X-Cache &quot;$upstream_cache_status from $server_addr&quot;;        add_header Cache-Control  max-age=60;        proxy_cache_valid  304 1m;#       proxy_cache two;        proxy_cache_key $host$uri$is_args$args;  &#125;#    auth_basic      &quot;authentication&quot;;#    auth_basic_user_file conf/mypasswords/.hugopass.dev;    access_log logs/hugo-server/hugo-server.acc access;    access_log  syslog:server=172.16.0.223:514,tag=note_laurance_orz  access;&#125;



nginx 服務重啟
/usr/local/web/nginx/sbin/nginx -t    /usr/local/web/nginx/sbin/nginx -s reload



php 設定檔配置定義 error_log 位置及層級
vim /usr/local/web/php/etc/php-fpm.conf






SERVER 端設置

更改 rsyslog 設定檔參數
(-c 後為版本號)
vim /etc/sysconfig/rsyslog

SYSLOGD_OPTIONS=&quot;-c 5&quot;






rsyslog 設定檔配置
vim /etc/rsyslog.conf
# rsyslog configuration file# For more information see /usr/share/doc/rsyslog-*/rsyslog_conf.html# If you experience problems, see http://www.rsyslog.com/doc/troubleshoot.html#### MODULES ##### The imjournal module bellow is now used as a message source instead of imuxsock.$ModLoad imuxsock # provides support for local system logging (e.g. via logger command)$ModLoad imjournal # provides access to the systemd journal#$ModLoad imklog # reads kernel messages (the same are read from journald)#$ModLoad immark  # provides --MARK-- message capability# Provides UDP syslog reception$ModLoad imudp$UDPServerRun 514# Provides TCP syslog reception$ModLoad imtcp$InputTCPServerRun 514#### GLOBAL DIRECTIVES ##### Where to place auxiliary files$WorkDirectory /var/lib/rsyslog# Use default timestamp format$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat# File syncing capability is disabled by default. This feature is usually not required,# not useful and an extreme performance hit#$ActionFileEnableSync on# Include all config files in /etc/rsyslog.d/$IncludeConfig /etc/rsyslog.d/*.conf# Turn off message reception via local log socket;# local messages are retrieved through imjournal now.$OmitLocalLogging on# File to store the position in the journal$IMJournalStateFile imjournal.state#### RULES ##### Log all kernel messages to the console.# Logging much else clutters up the screen.#kern.*                                                 /dev/console# Log anything (except mail) of level info or higher.# Don&#x27;t log private authentication messages!*.info;mail.none;authpriv.none;cron.none                /var/log/messages# The authpriv file has restricted access.authpriv.*                                              /var/log/secure# Log all the mail messages in one place.mail.*                                                  -/var/log/maillog# Log cron stuffcron.*                                                  /var/log/cron# Everybody gets emergency messages*.emerg                                                 :omusrmsg:*# Save news errors of level crit and higher in a special file.uucp,news.crit                                          /var/log/spooler# Save boot messages also to boot.log#local7.*                                                /var/log/boot.log#:programname,isequal,&quot;dhclient&quot;                         /var/log/dhclient.log#:programname,isequal,&quot;ec2net&quot;                           /var/log/dhclient.log# ### begin forwarding rule #### The statement between the begin ... end define a SINGLE forwarding# rule. They belong together, do NOT split them. If you create multiple# forwarding rules, duplicate the whole block!# Remote Logging (we use TCP for reliable delivery)## An on-disk queue is created for this action. If the remote host is# down, messages are spooled to disk and sent when it is up again.#$ActionQueueFileName fwdRule1 # unique name prefix for spool files#$ActionQueueMaxDiskSpace 1g   # 1gb space limit (use as much as possible)#$ActionQueueSaveOnShutdown on # save messages to disk on shutdown#$ActionQueueType LinkedList   # run asynchronously#$ActionResumeRetryCount -1    # infinite retries if host is down# remote host is: name/ip:port, e.g. 192.168.0.1:514, port optional#*.* @@remote-host:514# ### end of the forwarding rule ###$IncludeConfig /etc/rsyslog.d/*.conf```    ******   **在 `/etc/rsyslog.d` 目錄下建立 `xxx.conf` 定義 Client 端 log 的標籤及路徑**   ```sqlvim /etc/rsyslog.d/note_laurance.conf
:syslogtag, contains, &quot;note_laurance_orz&quot; /home/note-laurance-log/note.laurance.log    &amp; stop

vim /etc/rsyslog.d/php_error.conf
if  $msg contains &#x27;PHP&#x27;  then /home/note-laurance-log/php_errors.acc&amp; stop



rsyslog 服務重啟
systemctl restart rsyslog



建立每天排程 LOG輪詢建立排程設定檔 shell
vim /root/logrotate/logrotate.sh
#!/bin/bash/usr/sbin/logrotate /root/logrotate/weblog  // 若帶參數 -f 為強制執行

vim /root/logrotate/weblog
/home/note-laurance-log/*.log &#123;           daily           rotate 30           create           sharedscripts           postrotate           /bin/systemctl restart rsyslog.service           endscript&#125;/home/note-laurance-log/*.acc &#123;           daily           rotate 30           create           sharedscripts           postrotate           /bin/systemctl restart rsyslog.service           endscript&#125;



建立排程
crontab -e
10 05 * * * sh /root/logrotate/logrotate.sh



確認排程寫入
crontab -l



驗證:

訪問 note.laurance.com:1515 可以看到 LOG 被同步寫進指定位置了





Rsyslog 官方文件

]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Rsyslog</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN - error - SQLite compiled for 3.19.2, but running with 3.6.20</title>
    <url>/blog.github.io/2022/08/04/SVN-error_SQLite_compiled_for3_19_2_but_running_with_3_6_20/</url>
    <content><![CDATA[

svn: SQLite compiled for 3.19.2, but running with 3.6.20
svn: E200029: Couldn&#x27;t perform atomic initializationsvn: E200030: SQLite compiled for 3.19.2, but running with 3.6.20
這是因為編譯 SVN 用的版本 sqlite 3.19.2 和系統中已安裝的 sqlite 3.6.20 版本不一致導致


解決方法

從輸出中看出目前使用的 sqlite 版本
cd /usr/local/svn/binldd svn

libsqlite3.so.0:&gt; /usr/lib64/libsqlite3.so.0 (0x00007f0f8572d000)



找到 libsqlite3.so.0 並將它從新 link
find / -name libsqlite3.so.0 -print/usr/local/sqlite/lib/libsqlite3.so.0/usr/local/sqlite-autoconf-3190200/.libs/libsqlite3.so.0/usr/local/lib/libsqlite3.so.0/usr/lib64/libsqlite3.so.0

mv libsqlite3.so.0 libsqlite3.so.0.oldln -s /usr/local/lib/libsqlite3.so.0 libsqlite3.so.0




]]></content>
      <categories>
        <category>SVN</category>
      </categories>
      <tags>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN - error - undefined symbol: svn_fs_util__version</title>
    <url>/blog.github.io/2022/08/04/SVN-error_symbol_lookup/</url>
    <content><![CDATA[

svn: symbol lookup error: &#x2F;usr&#x2F;local&#x2F;lib&#x2F;libsvn_fs_x-1.so.0: undefined symbol: svn_fs_util__version

這是因為系统中装了rpm 版 的 subversion 跟 APR , 引起版本混乱 , 清理掉即可


rpm -qa|grep subversion    rpm -e --nodeps subversion-libs-1.7.14-16.el7.x86_64    rpm -qa|grep apr    echo &#x27;/usr/local/APR/lib&#x27;&gt;&gt;/etc/ld.so.conf    echo &#x27;/usr/local/ARP-util/lib&#x27;&gt;&gt;/etc/ld.so.conf    ldconfig    svnadmin create --pre-1.6-compatible /home/svn/note




]]></content>
      <categories>
        <category>SVN</category>
      </categories>
      <tags>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN - error 你必須先更新你的工作副本</title>
    <url>/blog.github.io/2022/10/05/SVN-error%E4%BD%A0%E5%BF%85%E9%A0%88%E5%85%88%E6%9B%B4%E6%96%B0%E4%BD%A0%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%89%AF%E6%9C%AC/</url>
    <content><![CDATA[

SVN 送交時失敗跳 error : &quot;你必須先更新你的工作副本&quot;


    


按確定之後，會自動跳出 作業失敗-請先更新的視窗 , 再點選更新即可


   



]]></content>
      <categories>
        <category>SVN</category>
      </categories>
      <tags>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN - 刪除早期版本庫 (記得先備份!!!)</title>
    <url>/blog.github.io/2022/12/26/SVN-%E5%88%AA%E9%99%A4%E6%97%A9%E6%9C%9F%E7%89%88%E6%9C%AC%E5%BA%AB_(%E8%A8%98%E5%BE%97%E5%85%88%E5%82%99%E4%BB%BD!!!)/</url>
    <content><![CDATA[
svn-dump 太肥導致硬碟爆了,因此決定瘦身一下


查看目前版本號
svnlook youngest /home/svn/mis-note



保留 130-138 版本號 的 dump
svnadmin dump /home/svn/mis-note -r 130:138 &gt; repo_dump_130-138.dmp 2&gt;repo_dump_130-138.log



將舊的庫移成 XXX.bak
mv mis-note/ mis-note-20230105.bak/



建立新庫
svnadmin create /home/svn/mis-note



將設定檔複製過來
cp -r ../mis-note-20230105.bak/conf .



查看乾淨庫的容量
du -hs mis-note



導入 dump
svnadmin load /home/svn/mis-note &lt; repo_dump_130-138.dmp &gt;repo_load_130-138.log 2&gt;repo_load_130-138.errlog



看一下新庫容量有沒有增加
du -hs mis-note



svn-server 重啟
pkill svnservesvnserve -d /usr/local/bin/svnserve --daemon --pid-file=/var/run/svnserve.pid



Client 端 (Windows): 砍掉舊有的SVN資料夾 , 並取出新資料夾

]]></content>
      <categories>
        <category>SVN</category>
      </categories>
      <tags>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN - SERVER - 安裝教學 (CentOS7)</title>
    <url>/blog.github.io/2022/10/06/SVN-%E5%AE%89%E8%A3%9D%E6%95%99%E5%AD%B8_(CentOS7)/</url>
    <content><![CDATA[

安裝依賴及 SVN 套件
yum install apr* gcc zlib-devel automake autoconf libtool makewget https://archive.apache.org/dist/subversion/subversion-1.10.8.tar.gz    tar zxvf subversion-1.10.8.tar.gz    cd subversion-1.10.8    mkdir sqlite-amalgamationcd ../wget https://www.sqlite.org/2022/sqlite-autoconf-3400000.tar.gz --no-check-certificate tar zxvf sqlite-autoconf-3400000.tar.gz    cd subversion-1.10.8/sqlite-amalgamation    cp -r ../../sqlite-autoconf-3400000/* .



編譯安裝 svn-server
cd .././configure --prefix=/usr/local/svn --without-berkeley-db --with-lz4=internal --with-utf8proc=internalmake &amp;&amp; make install cp /usr/local/svn/bin/* /usr/local/bin/



啟動 svnserve
svnserve -d /usr/local/bin/svnserve --daemon --pid-file=/var/run/svnserve.pid



增加 svn 啟動身分
adduser svnpasswd svn



建立資料庫
svnadmin create /home/svn/project/



增加使用者與密碼
vim /home/svn/project/conf/passwd
[users]laurance: yoyoyo



增加權限
vim /home/svn/project/conf/auth

[/]laurance: rw



修改設定檔
vim /home/svn/project/conf/svnserve.conf

[general]anon-access=readauth-access=writepassword-db=passwdauthz-db=authzrealm=/home/svn/nowblog[sasl]



重啟 svn-server



]]></content>
      <categories>
        <category>SVN</category>
      </categories>
      <tags>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN - 更新時發生衝突如何解決</title>
    <url>/blog.github.io/2022/09/13/SVN-%E6%9B%B4%E6%96%B0%E6%99%82%E7%99%BC%E7%94%9F%E8%A1%9D%E7%AA%81%E5%A6%82%E4%BD%95%E8%A7%A3%E6%B1%BA/</url>
    <content><![CDATA[

在標示了衝突的那個檔案上點滑鼠左鍵兩下
會自動開啟內建的合併工具


   


左邊區塊是版本庫的檔案  
右邊區塊是本機副本的檔案  
底下區塊是合併後的結果，看得出來有一堆問號的部份就是無法自動合併的區塊 (也就是衝突)  


   


在左邊區塊衝突的部分按 滑鼠右鍵 就可以跳出相關的快顯功能表
     


手動選擇後在下方的窗格會顯示合併後的結果
   


將所有的衝突都處理完畢後按工具列上的圖示
     



]]></content>
      <categories>
        <category>SVN</category>
      </categories>
      <tags>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN - 綠色勾勾消失解決方法</title>
    <url>/blog.github.io/2022/08/03/SVN-%E7%B6%A0%E8%89%B2%E5%8B%BE%E5%8B%BE%E6%B6%88%E5%A4%B1/</url>
    <content><![CDATA[

在 windows 上操作

打開 windows 登陸編輯程式中的 ShellIconOverlayIdentifiers
Win + R &gt;&gt; regedit &gt;&gt; HKEY_LOCAL_MACHINE -&gt; SOFTWARE -&gt; Microsoft -&gt; Windows -&gt; CurrentVersion -&gt; Explorer -&gt; ShellIconOverlayIdentifiers 



查看註冊表中是否有 Tortoisesvn 相關選項,如果有則將 Tortoisesvn 相關移到最前端,將首字母改爲數字或者空格 


如果註冊表中沒有 Tortoisesvn 則將 Tortoisesvn導入到註冊表 , 具體內容爲以下

打開註冊表  HKEY_LOCAL_MACHINE -&gt; SOFTWARE -&gt; Microsoft -&gt; Windows -&gt; CurrentVersion -&gt; Explorer -&gt; ShellIconOverlayIdentifiers

將 ShellIconOverlayIdentifiers 匯出

使用編輯器打開匯出的文件 xxx.reg 並加入以下內容儲存:
Windows Registry Editor Version 5.00)

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\1TortoiseNormal]@=&quot;&#123;C5994560-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\2TortoiseModified]@=&quot;&#123;C5994561-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\3TortoiseConflict]@=&quot;&#123;C5994562-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\4TortoiseLocked]@=&quot;&#123;C5994563-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\5TortoiseReadOnly]@=&quot;&#123;C5994564-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\6TortoiseDeleted]@=&quot;&#123;C5994565-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\7TortoiseAdded]@=&quot;&#123;C5994566-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\8TortoiseIgnored]@=&quot;&#123;C5994567-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\9TortoiseUnversioned]@=&quot;&#123;C5994568-53D9-4125-87C9-F193FC689CB2&#125;&quot;[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\Offline Files]@=&quot;&#123;750fdf0e-2a26-11d1-a3ea-080036587f03&#125;&quot;





重啓 Explorer 
CND :  taskkill /f /im explorer.exe &gt; start explorer.exe    PW :  stop-process -name explorer -force



HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers\ 
001Tortoise1Normal001Tortoise2Modified001Tortoise3Conflict001Tortoise4Locked001Tortoise5ReadOnly001Tortoise6Deleted001Tortoise7Added001Tortoise8Ignored001Tortoise9Unversioned






]]></content>
      <categories>
        <category>SVN</category>
      </categories>
      <tags>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN - Linux 解決每次 commit 都需要輸入密碼</title>
    <url>/blog.github.io/2023/02/04/SVN-%E8%A7%A3%E6%B1%BASVN%E6%AF%8F%E6%AC%A1%E9%83%BD%E9%9C%80%E8%A6%81%E8%BC%B8%E5%85%A5%E5%AF%86%E7%A2%BC/</url>
    <content><![CDATA[

刪除原本緩存密碼的文件
rm -f ~/.subversion/auth/svn.simple/*



執行一次 “svn update” 讓密碼緩存文件重新生成
cd nowblog-2023-02-08/     svn up --username laurance



修改緩存目錄下的文件
vim ~/.subversion/auth/svn.simple/1b47431ba1edd4463343286aca5a7e1
K 15svn:realmstringV 43&lt;svn://192.168.168.1:3690&gt;K 8passtypeV 6simpleK 8usernameV 8lauranceK 8passwordV 10XXXXXX   (password)END



{ passtype 固定是 simple  ,  K 和 V 後面的數字分別代表 key 和 value 的長度 }

參考文件

]]></content>
      <categories>
        <category>SVN</category>
      </categories>
      <tags>
        <tag>SVN</tag>
      </tags>
  </entry>
  <entry>
    <title>Sectigo - 改簽 SSL 教學</title>
    <url>/blog.github.io/2022/10/03/Sectigo-%E6%94%B9%E7%B0%BDSSL%E6%95%99%E5%AD%B8/</url>
    <content><![CDATA[
Sectigo 如何將 SSL 改簽給其他域名


進入Sectigo 後台，並點選訂單管理 Gaia Information Technology Corp. Reseller

!(https://s2.loli.net/2024/04/29/bhoHuQdFzG4TDfP.png)


點選訂單報告 Report on Your Orders




以簽發日期查詢訂單編號

!(https://s2.loli.net/2024/04/29/ERKXPFI3vsM2eDW.png)


用訂單編號搜索憑證更換CSR

   


進入管理層並點選訂單管理操作 Validation Manager Order Search

!(https://s2.loli.net/2024/04/29/BQKirleHn9YmTdR.png)


輸入剛查詢的訂單編號進入修改

   


點選修改 Submit your CSR  並將 CSR 黏貼進入，後面一直按CONTINUE即可

   


   


憑證簽發完後，Mail 會收到 Sectigo 寄來的 zip包

   


下載後會有 4隻檔案
將 AAA CertificateServices.crt 裡面的內容全部貼進 STAR_XXX_net.crt 的下面，並更名為域名.crt
再將 域名.crt 複製到網頁主機裡ps. 注意：STAR_XXX_net.crt內容一定要再上方，否則驗證不會過)


   


   



]]></content>
      <categories>
        <category>SECTIGO</category>
      </categories>
      <tags>
        <tag>SECTIGO</tag>
      </tags>
  </entry>
  <entry>
    <title>VPN - 建置 SOCKS5 (SS5) 代理</title>
    <url>/blog.github.io/2022/12/26/VPN-%E5%BB%BA%E7%BD%AESOCKS5_SS5%E4%BB%A3%E7%90%86/</url>
    <content><![CDATA[

安裝編譯 SS5

從官網下載源碼
wget https://nchc.dl.sourceforge.net/project/ss5/ss5/3.8.9-8/ss5-3.8.9-8.tar.gz



安裝依賴
yum -y install pam-devel openldap-devel cyrus-sasl-devel openssl-devel gcc automake make



解壓、編譯、安裝
tar xvf ss5-3.8.9-8.tar.gz    cd ss5-3.8.9    ./configure &amp;&amp; make &amp;&amp; make install



修改 SS5 設定檔

修改認證方式
vim /etc/opt/ss5/ss5.conf



無帳號密碼的設定
 auth    0.0.0.0/0               -              -permit -       0.0.0.0/0       -       0.0.0.0/0       -       -       -       -       -



有帳號密碼的設定
auth    0.0.0.0/0               -              upermit u        0.0.0.0/0       -       0.0.0.0/0       -       -       -       -       -



加入 user 及 password
vim /etc/opt/ss5/ss5.passwd
laurance lau888



修改 ss5 啟動 port
vim /etc/sysconfig/ss5
SS5_OPTS=&quot; -u root -b 0.0.0.0:8080&quot;



新增 ss5 執行檔權限
chmod 755 /etc/rc.d/init.d/ss5



啟動服務
systemctl restart ss5



查看啟動 LOG
more /var/log/ss5/ss5.log



使用 Chrome 套件 &amp; SS5 翻牆

Chrome 新增套件: Proxy SwitchyOmega


   



]]></content>
      <categories>
        <category>VPN</category>
      </categories>
      <tags>
        <tag>SOCKS5</tag>
      </tags>
  </entry>
  <entry>
    <title>VPN - 建置 XL2TPD + IPSec 服務 by DOCKER &amp;&amp; CentOS 7</title>
    <url>/blog.github.io/2022/12/27/VPN-%E5%BB%BA%E7%BD%AE_XL2TPD+IPSec%E6%9C%8D%E5%8B%99/</url>
    <content><![CDATA[

安裝 Docker

安裝最新版 Docker
wget -qO- get.docker.com | bash 



 


查看版本
docker version 



 


啟動服務
systemctl start docker 



查看狀態
systemctl status docker



使用 Docker 安裝 L2TP

拉取鏡像
docker pull teddysun/l2tp



建立環境參數設定檔
vim /etc/l2tp.env
VPN_IPSEC_PSK=1234567890VPN_USER=lauranceVPN_PASSWORD=lau888VPN_PUBLIC_IP=XX.XX.XX.XXVPN_L2TP_NET=192.168.18.0/24VPN_L2TP_LOCAL=192.168.18.1VPN_L2TP_REMOTE=192.168.18.10-192.168.18.250VPN_XAUTH_NET=192.168.20.0/24VPN_XAUTH_REMOTE=192.168.20.10-192.168.20.250VPN_DNS1=8.8.8.8VPN_DNS2=9.9.9.9VPN_SHA2_TRUNCBUG=



參數解析




參數
參數代表意義



VPN_IPSEC_PSK
預共享密鑰


VPN_USER
默認的登錄用戶名


VPN_PASSWORD
默認的登錄用戶密碼


VPN_PUBLIC_IP
指定公網 IP 地址，當你的 VPS 有多個公網 IP 時，可能需要手動指定一下


VPN_L2TP_NET
內網 L2TP 網段範圍，默認為 192.168.18.0&#x2F;24，一般此處留空即可


VPN_L2TP_LOCAL
內網 L2TP 網關 IP，默認為 192.168.18.1，一般此處留空即可


VPN_L2TP_REMOTE
內網 L2TP 網段分配給連接的 IP 段，默認為 192.168.18.10-192.168.18.250，一般此處留空即可


VPN_XAUTH_NET
內網 XAUTH 網段範圍，默認為 192.168.20.0&#x2F;24，一般此處留空即可


VPN_XAUTH_REMOTE
內網 XAUTH 網段分配給連接的 IP 段，默認為 192.168.20.10-192.168.20.250，一般此處留空即可


VPN_DNS1
默認 DNS 服務器，8.8.8.8，一般此處留空即可


VPN_DNS2
默認 DNS 服務器，8.8.4.4，一般此處留空即可



Android 6 和 7 如果遇到連接問題，嘗試在 &#x2F;etc&#x2F;ipsec.conf 中設置 sha2-truncbug&#x3D;yes (默認為 no)  

可以在 &#x2F;etc&#x2F;l2tp.env 文件中添加 VPN_SHA2_TRUNCBUG&#x3D;yes，然後重新創建 Docker 容器。


啟動容器
docker run -d --privileged -p 500:500/udp -p 4500:4500/udp --name l2tp --restart=always --env-file /etc/l2tp.env -v /lib/modules:/lib/modules teddysun/l2tp



查看啟動 LOG
docker logs l2tp



查看 ipsec status 輸出
docker exec -it l2tp ipsec status



管理 VPN 用户

列出所有 user &amp; password
docker exec -it l2tp l2tpctl -l



新增 user
docker exec -it l2tp l2tpctl -a



刪除 user
docker exec -it l2tp l2tpctl -d



修改 user 密碼
docker exec -it l2tp l2tpctl -m



查看 libreswan 和 xl2tpd 版本 
docker exec -it l2tp l2tpctl -v 
Linux Libreswan 3.32 (netkey) on 3.10.0-1160.76.1.el7.x86_64xl2tpd version:  xl2tpd-1.3.15



Windows 10 下连接 L2TP VPN

修改 VPN 協議
  



Configure a L2TP&#x2F;IPsec server behind a NAT-T device

win + R 輸入 regedit

路徑: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PolicyAgent

新增一組機碼 &gt;&gt; DWORD（32 位）值 &gt;&gt; AssumeUDPEncapsulationContextOnSendRule &gt;&gt; 值設定為 2 (1 不會過)



PHONE 下连接 L2TP VPN

Android 版本小於或等於 7 時，建議選擇 IPSec Xauth PSK (Cisco IPsec) 模式連接


   參考文件
   參考文件






L2TP&#x2F;IPSec 一鍵安裝腳本

腳本下載
wget -O StackScript.zip https://files.cnblogs.com/files/think8848/StackScript.zip



解壓並給予權限
unzip StackScript.zipchmod 755 StackScript



執行腳本
/bin/bash -x StackScriptvim /etc/ipsec.secrets# 建立預先拱享金鑰vim /etc/ppp/chap-secrets# 建立使用者及密碼systemctl restart ipsec xl2tpd# 重啟服務ipsec verify # 測試 ipsec 狀態 (沒有 failed 就算正常)



# 常用文件檔位置/etc/ipsec.conf/etc/ipsec.secrets/etc/ppp/chap-secrets/etc/xl2tpd/xl2tpd.conf



# 火牆規則extif=&quot;eth0&quot;extlp=&quot;ppp0&quot;INNET=&quot;192.168.42.0/24&quot;iptables -A service -i $extif -p UDP --dport  1701 -j ACCEPT            # PPTPiptables -A service -i $extif -p UDP --dport  500 -j ACCEPT             # IPSECiptables -A service -i $extif -p UDP --dport  4500 -j ACCEPT            # XL2TPiptables -A service -i $extif -p 50 -j ACCEPT                           # XL2TPiptables -t nat -A POSTROUTING -o $extif -s $INNET -j MASQUERADE        # 轉送VPN流量iptables -t nat -A POSTROUTING -o $extlp -j MASQUERADE



指令說明l2tp -a (Add a user)  # 新增用戶l2tp -d (Delete a user) # 刪除用戶l2tp -l (List all users)  # 列出所有用戶l2tp -m (Modify a user password) # 修改現有用戶密碼l2tp -h # 列出幫助訊息ipsec status  # 查看 IPSec 運行狀態ipsec verify  # 查看 IPSec 檢查結果systemctl start|stop|restart|status ipsec # 啟動 IPSecsystemctl start|stop|restart xl2tpd   # 啟動 L2TP



參考文件

]]></content>
      <categories>
        <category>VPN</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>XL2TPD</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - CMD 常用指令</title>
    <url>/blog.github.io/2022/08/10/Windows-CMD%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[




動作
LINUX
WINDOWS



進入目錄
cd
cd


創建目錄
mkdir
md


當前目錄
pwd
cd


展示目錄
ls
dir


移除目錄
rm
del


打印文件
lp
print


複製文件
cp
copy


移動文件
mv
ren


指令查詢
man
help


顯示環境變數
env
set


設置環境變數
setenv
set


打印文件
lp
print





]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - Chrome 長截圖教學</title>
    <url>/blog.github.io/2022/09/14/Windows-Chrome%E9%95%B7%E6%88%AA%E5%9C%96%E6%95%99%E5%AD%B8/</url>
    <content><![CDATA[

方法1. 透過內建Chrome截圖實驗功能

步驟 1. 開啟 Google Chrome 網頁後，直接在網址列輸入 chrome://flags/ 會立即打開 Chrome實驗性功能


   


步驟 2. 直接搜尋Desktop Screenshots Desktop Sharing Hub in Omnibox Desktop Sharing Hub in App Menu 三項功能，全改為Enabled後，按下Relaunch重啟 Google Chrome 瀏覽器，就會啟用內建Chrome截圖快捷鍵隱藏功能


   


步驟 3. 如果要截圖時，直接點擊 Chrome 網址列右側的分享圖示，再點選螢幕截圖功能


     


方法2. 用內建Chrome 長截圖功能

步驟1. 開啟 Google Chrome 瀏覽器後，先進入想要長截圖網頁，直接利用鍵盤按下F12快捷鍵，顯示開發人員資訊畫面


   


步驟2. 接下來再利用快捷鍵呼叫 Chrome瀏覽器指令選單,並輸入長截圖指令  


       



長截圖指令解析




長截圖指令
指令代表意思



Capture full size screenshot
長截圖


Capture screenshot
一般截圖


Capture node screenshot
預覽截圖


Capture area screenshot
自選區域截圖





]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - win10 無法建立VPN連線</title>
    <url>/blog.github.io/2022/09/27/Windows-Windows_10%E7%84%A1%E6%B3%95%E5%BB%BA%E7%AB%8BVPN%E9%80%A3%E7%B7%9A/</url>
    <content><![CDATA[

連 VPN 時出現以下錯誤訊息

   


解決方法

1. Win + R 輸入 regedit

   


2.尋找此路徑 HKEYLOCALMACHINE\SYSTEM\CurrentControlSet\Services\PolicyAgent

   


3.新增一組機碼 類型:DWORD (32-bit) 
名稱:AssumeUDPEncapsulationContextOnSendRule


4.並且將值設定為2

5.重開機


]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - bat 批處理腳本中文亂碼問題解決</title>
    <url>/blog.github.io/2023/03/02/Windows-bat%E6%89%B9%E8%99%95%E7%90%86%E8%85%B3%E6%9C%AC%E4%B8%AD%E6%96%87%E4%BA%82%E7%A2%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E6%B1%BA/</url>
    <content><![CDATA[

bat 處理腳本如下

@echo off

ECHO 正在重置 Studio 3T 的使用日期...

FOR /f &quot;tokens=1,2,* &quot; %%i IN (&#39;reg query &quot;HKEY_CURRENT_USER\Software\JavaSoft\Prefs\3t\mongochef\enterprise&quot; ^| find /V &quot;installation&quot; ^| find /V &quot;HKEY&quot;&#39;) DO ECHO yes | reg add &quot;HKEY_CURRENT_USER\Software\JavaSoft\Prefs\3t\mongochef\enterprise&quot; /v %%i /t REG_SZ /d &quot;&quot;

ECHO 重置完成, 按任意键退出......

pause&gt;nul

exit



CMD 執行腳本時出現亂碼





解決方法


將 bat執行檔 另存為 ANSI編碼格式





再次運行,亂碼問題已解決






]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - win10 專業版金鑰</title>
    <url>/blog.github.io/2023/03/20/Windows-win10%E5%B0%88%E6%A5%AD%E7%89%88%E9%87%91%E9%91%B0/</url>
    <content><![CDATA[

Windows 10 專業版金鑰啟用方法  2023-03-20 實測有效


{Step 1} 叫出 PSW (使用管理者身分)
WIN + X + A



{Step 2} 輸入已下指令
slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX     slmgr /skms kms.03k.org     slmgr /ato



啟用成功


]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows-使用PSW查詢路徑下的目錄大小</title>
    <url>/blog.github.io/2024/06/02/Windows-%E4%BD%BF%E7%94%A8PSW%E6%9F%A5%E8%A9%A2%E8%B7%AF%E5%BE%91%E4%B8%8B%E7%9A%84%E7%9B%AE%E9%8C%84%E5%A4%A7%E5%B0%8F/</url>
    <content><![CDATA[Windows - 使用 PSW查詢路徑下的目錄大小

#### WIN + X +A  -&gt;&gt;&gt;&gt; 叫出 PSW



cd 至該路徑

將已下代碼貼上




**
Get-ChildItem |Format-Table  -AutoSize Mode, LastWriteTime, Name,     @&#123; Label=&quot;Length&quot;; alignment=&quot;Left&quot;;       Expression=&#123;                    if($_.PSIsContainer -eq $True)                        &#123;(New-Object -com  Scripting.FileSystemObject).GetFolder( $_.FullName).Size&#125;                      else                        &#123;$_.Length&#125;                  &#125;     &#125;;
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 使用 WinSCP 腳本同步 Windows目錄到 Linux (在 Windows 下語法)</title>
    <url>/blog.github.io/2023/05/22/Windows-%E4%BD%BF%E7%94%A8WinSCP%E8%85%B3%E6%9C%AC%E5%9C%A8win10%E5%92%8Clinux%E4%B9%8B%E9%96%93%E5%AF%A6%E6%99%82%E5%90%8C%E6%AD%A5%E9%A0%85%E7%9B%AE%E4%B8%A6%E6%8E%92%E9%99%A4%E7%9B%AE%E9%8C%84/</url>
    <content><![CDATA[

WinSCP 載點安裝 官網下載最新版本

安裝完成可添加環境變數,指令就不用帶絕對路徑了


如何 排除目錄 或 隱藏檔

開啟 winscp 點選 指令 &gt; 同步 &gt; 傳送設定 &gt; 檔案遮罩 &gt; 編輯 &gt; 記下遮罩代碼





如何下 CMD 同步目錄

WinSCP 登入虛擬機後 , 點選 工作階段 &gt; 產生工作階段URL / 程式碼 &gt; 記下工作階段URL





開啟 CMD 進入 WinSCP 介面


Win + R + CMD 快捷開啟
輸入 winscp 執行檔路徑及指令
&quot;C:\Program Files (x86)\WinSCP\WinSCP.com&quot;






將 winscp 產生的 工作階段 URL 輸入





輸入同步語法


同步目錄語法 # 雙向同步synchronize both &quot;C:\Users\Laurance\Desktop\XXXXX&quot; /root/test/test/winscp


同步目錄語法 # 同步遠端檔案到本地synchronize local &quot;C:\Users\Laurance\Desktop\XXXXX&quot; /root/test/test/winscp


同步目錄語法 # 同步本地檔案到遠端synchronize remote  &quot;C:\Users\Laurance\Desktop\Mis-Note (TEST)\TEST\wh-8.com&quot; /root/test/test/winscpORsynchronize remote -delete &quot;C:\Users\Laurance\Desktop\Mis-Note (TEST)\TEST\wh-8.com&quot; /root/test/test/winscp






如何使用 WinSCP 腳本在win10和linux之間實時同步項目並排除目錄  

建立一支執行 winscp語法的 rsync.txt


open sftp://USER:PASSWORD@172.16.0.222/ -hostkey=&quot;ssh-ed25519 255 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXsynchronize remote &quot;C:\Users\Laurance\Desktop\XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot; /root/test/test/winscp -filemask=&quot;| .*; test.txt&quot;exit



再建立一支執行 CMD語法的 sync.bat


@echo onset filepath=%~dp0WinSCP /script=&quot;%filepath%\rsync.txt&quot; /log=&quot;%filepath%\rsync_log.txt&quot;pause




]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 如何去除鎖定畫面上的 YT 播放資訊</title>
    <url>/blog.github.io/2023/06/20/Windows-%E5%A6%82%E4%BD%95%E5%8E%BB%E9%99%A4%E9%8E%96%E5%AE%9A%E7%95%AB%E9%9D%A2%E4%B8%8A%E7%9A%84%E6%92%AD%E6%94%BE%E8%B3%87%E8%A8%8A/</url>
    <content><![CDATA[

目前測試 Firefox 可以隱藏 (其餘 chrome edge 測試不行)

啟動 Firefox 瀏覽器 在 URL 位置 上輸入



about:config




搜尋:  media.hardwaremediakeys.enabled




將其設置為 false 重啟即可









**以下 Chrome 已失效**



解決 Windows 10  鎖定畫面上 不要顯示正在播放的 Youtube 

啟動 chrome 瀏覽器 在 URL 位置 上輸入



chrome://flags/#hardware-media-key-handling




搜尋:  Media Session enterpictureinpicture action




將其設置為 Disabled










Hardware Media Key Handling 已經棄用






重啟 Chrome 生效



]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 如何建立排程讓 SVN 自動送交</title>
    <url>/blog.github.io/2023/05/30/Windows-%E5%A6%82%E4%BD%95%E5%BB%BA%E7%AB%8B%E6%8E%92%E7%A8%8B%E8%AE%93SVN%E8%87%AA%E5%8B%95%E9%80%81%E4%BA%A4/</url>
    <content><![CDATA[

Windows 設定批次檔讓 svn 自動 commit  

在要送交的目錄裡面一層 建立放批次檔的目錄


建立要 commit 的批次檔 (此批次檔為先 update 之後再 commit , 因此 若有刪除檔案需先手動 commit)


@echo off:startsetlocal ENABLEDELAYEDEXPANSIONset TD=%~dp0cd /d %TD%/../ :SVN_UPDATEsvn update :SVN_ADD_NOTUNDERCONTROLFOR /F &quot;usebackq delims=&quot; %%i IN (`svn status`) DO (  set LN=&quot;%%i&quot;  set FC=!LN:~1,1!  set FN=!LN:~9,-1!  IF &quot;!FC!&quot;==&quot;?&quot; (    svn add &quot;!FN!&quot;  )) :SVN_COMMITset MSG=&quot;%date% %time%&quot;echo &quot;----------------------------------------&quot; &gt;&gt; &quot;%TD%/svn_log.txt&quot;echo %MSG% &gt;&gt; &quot;%TD%/svn_log.txt&quot;svn commit -m %MSG% &gt;&gt; &quot;%TD%/svn_log.txt&quot; :end



建立 windows 每日排程 執行 svn commit

Win + R 輸入 taskschd.msc 並點選 建立基本工作





輸入排程的名稱及描述





輸入執行排程要間隔的時間





輸入要執行的動作 (這邊選擇執行剛建立的批次檔)





輸入批次檔的路徑即可





確認觸發程序及時間後,點選完成即可






]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 如何建立環境變數 (WinSCP)</title>
    <url>/blog.github.io/2023/05/21/Windows-%E5%A6%82%E4%BD%95%E5%BB%BA%E7%AB%8B%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8/</url>
    <content><![CDATA[

Windows 10 將 WinSCP 加入環境變數步驟  

點選 控制台 &gt; 系董及安全性 &gt; 系統




點選 進階系統設定




點選 進階 &gt; 環境變數




在 系統變數 中找到 Path &amp; 並點選 編輯




點選 新增 &gt; 將程式執行檔路徑填入 &gt; 確定





]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 如何關閉晃動視窗不再最小化其他視窗</title>
    <url>/blog.github.io/2023/06/21/Windows-%E5%A6%82%E4%BD%95%E9%97%9C%E9%96%89%E6%99%83%E5%8B%95%E8%A6%96%E7%AA%97%E4%B8%8D%E5%86%8D%E6%9C%80%E5%B0%8F%E5%8C%96%E5%85%B6%E4%BB%96%E8%A6%96%E7%AA%97/</url>
    <content><![CDATA[

每次一不小心晃到視窗就給我全部最小化 , 因此特別紀錄一下  

如何關閉 Aero Shake

Windows + R 開啟執行 , 並輸入 gpedit.msc





選取 使用者設定 &gt;&gt; 系統管理範本 &gt;&gt; 桌面 , 右邊點擊 關閉 Aero 搖動視窗最小化滑鼠手勢





點擊 已啟用 並 套用 &amp; 確定





ps: 停用或未設定這個規則 , 都會開啟 Aero Shake



]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 安裝影片下載工具 youtube-dl</title>
    <url>/blog.github.io/2023/02/15/Windows-%E5%AE%89%E8%A3%9D%E5%BD%B1%E7%89%87%E4%B8%8B%E8%BC%89%E5%B7%A5%E5%85%B7youtube-dl/</url>
    <content><![CDATA[

Windows 安裝 youtube-dl 紀錄

官方網站


〔Step 1〕官網安裝套件

Windows 需安裝以下套件
Microsoft Visual C++ 2010 Service Pack 1 Redistributable Package (x86)  
Windows exe (youtube-dl for windows)





〔Step 2〕將 youtube-dl 設定成環境變數

將 “youtube-dl.exe” 移至路徑 %USERPROFILE%\AppData\Local\Microsoft\WindowsApps 裡


Windows 預設環境變數路徑  
%USERPROFILE%\AppData\Local\Microsoft\WindowsApps   






〔Step 3〕確認上述路徑有在 PATH 中









〔Step 4〕驗證: 打開 CMD 輸入 youtube-dl --version




〔Step 5〕測試下載影片

直接下載
youtube-dl u5ZsoP8FZUQ



查詢影片可下載的畫質清單
youtube-dl -F u5ZsoP8FZUQ






上述指令找到 format code 後，使用下列指令下載指定的畫質影片
youtube-dl -f 401 u5ZsoP8FZUQ



下載成音樂 --audio-format 指定輸出格式，預設值為 best
youtube-dl -x --audio-format mp4 u5ZsoP8FZUQ




]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>youtube-dl</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 安裝影片下載工具 yt-dlp 及 Chocolatey</title>
    <url>/blog.github.io/2023/03/02/Windows-%E5%AE%89%E8%A3%9D%E7%A8%8B%E5%BC%8F--Chocolatey/</url>
    <content><![CDATA[

環境: Win10 , Powershell 版本: 5.1.19041.1682

安裝 Chocolatey

使用 Powershell 查看 PSVersion 版本
psversiontable
Name                           Value----                           -----PSVersion                      5.1.19041.1682PSEdition                      DesktopPSCompatibleVersions           &#123;1.0, 2.0, 3.0, 4.0...&#125;BuildVersion                   10.0.19041.1682CLRVersion                     4.0.30319.42000WSManStackVersion              3.0PSRemotingProtocolVersion      2.3SerializationVersion           1.1.0.1



在 powershell 中輸入以下指令下載 Chocolatey
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol: [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString(&#x27;https://chocolatey.org/install.ps1&#x27;))






下載完成可用指令查看 help
choco -?






使用 choco 下載 yt-dlpchoco install yt-dlp







]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>yt-dlp</tag>
        <tag>Chocolatey</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 安裝轉檔工具 FFmpeg</title>
    <url>/blog.github.io/2023/02/15/Windows-%E5%AE%89%E8%A3%9D%E8%BD%89%E6%AA%94%E5%B7%A5%E5%85%B7FFmpeg/</url>
    <content><![CDATA[
影音轉檔教學 mov&#x2F;mp4 轉檔


Windows  FFmpeg 安裝紀錄官方網站


〔Step 1〕先去官網下載 FFmpeg






〔Step 2〕將載好的 zip包解壓縮




裡面應該要有這些檔案





〔Step 3〕進去到 .&#x2F;bin 這層目錄並將路徑複製到環境變數中




〔Step 4〕打開控制台 &gt; 系統及安全性 &gt; 系統 &gt; 進階系統設定






〔Step 5〕打開環境變數 &gt; 系統變數 &gt; Path &gt; 編輯 &gt; 新增





將 〔Step 3〕 複製的路徑貼入






〔Step 6〕驗證: 打開 CMD 輸入 ffmpeg -version




〔Step 7〕將 mp4 轉成 mov





]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows - 設定 BIOS 透過內顯與獨顯做多螢幕輸出</title>
    <url>/blog.github.io/2022/08/10/Windows-%E9%80%8F%E9%81%8E%E5%85%A7%E9%A1%AF%E8%88%87%E7%8D%A8%E9%A1%AF%E5%81%9A%E5%A4%9A%E8%9E%A2%E5%B9%95%E8%BC%B8%E5%87%BA/</url>
    <content><![CDATA[

進入BIOS

按F7進入進階模式





點選Advanced 頁面，進入System Agent (SA) Configuration





在System Agent (SA) Configuration底下點選Graphics Configuration





進入Graphics Configuration項目後，把iGPU Multi-Monitor選項設定為Enable


Primary Display可以設定螢幕顯示方式  

1. 為自動偵測 Auto 

2. 獨立顯示卡 PCIE 輸出  

3. 內建顯示 iGPU 輸出





按 F10 儲存後重新開機

WIN+X+M 進入裝置管理員

在裝置管理員，可以看到 內建顯示晶片 和 外接獨立顯示卡 兩個顯示卡輸出裝置    

]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>XenServer - 安装教學</title>
    <url>/blog.github.io/2022/08/15/XEN-%E5%AE%89%E8%A3%85XenServer/</url>
    <content><![CDATA[
Citrix XenServer 7.2 虛擬化集群搭建


Xenserver 安裝步驟





























]]></content>
      <categories>
        <category>XenCenter</category>
      </categories>
      <tags>
        <tag>XenCenter</tag>
      </tags>
  </entry>
  <entry>
    <title>XenServer - 如何擴充 root 磁區</title>
    <url>/blog.github.io/2022/08/03/XEN-%E6%93%B4%E5%85%85root%E7%A3%81%E5%8D%80/</url>
    <content><![CDATA[

Citrix XenCenter (Client)

進入 xencenter 增加該機器硬碟容量

選擇要增加硬碟容量的機器,找到 storage 選單

選擇該磁區 /dev/xvda 右鍵點選 Add...

填入要新增的容量,並按 add


進入該台機器分配磁區

查看各區硬碟
df -h


查看總硬碟有無新增 30G
fdisk -l


檢視已經存在的pv（物理卷）
pvdisplay


檢視當前已經存在的vg（邏輯卷組）
vgdisplay


檢視已經存在的lv（邏輯卷）
lvdisplay


把&#x2F;dev&#x2F;xvdb加入與&#x2F;目錄相同的vg（邏輯卷組）
vgextend centos /dev/xvdb


擴容lv（邏輯卷）
lvextend -L +30.0GB -n /dev/mapper/centos-root


使其生效
xfs_growfs /dev/mapper/centos-root 


再次查看磁區已新增
df -h




]]></content>
      <categories>
        <category>XenCenter</category>
      </categories>
      <tags>
        <tag>XenCenter</tag>
      </tags>
  </entry>
  <entry>
    <title>XenServer - win10 無法傳 ISO 映像檔問題</title>
    <url>/blog.github.io/2022/08/03/XEN-%E7%84%A1%E6%B3%95%E5%82%B3ISO%E6%98%A0%E5%83%8F%E6%AA%94/</url>
    <content><![CDATA[

開啟 windoes 元件

samba


]]></content>
      <categories>
        <category>XenCenter</category>
      </categories>
      <tags>
        <tag>XenCenter</tag>
      </tags>
  </entry>
  <entry>
    <title>Xshell 7 - v7.0.0001 install</title>
    <url>/blog.github.io/2023/03/20/Xshell_7-V7_0_0001_install/</url>
    <content><![CDATA[

Xshell 7 - v7.0.0001 install (Cracked version)

安裝載點


將桌面右下角系統時間修改為 2018 年 否則會跳ERROR

 
 
 


點擊安裝檔安裝版本 v7.0.0001

 


安裝完成後並不能直接開啟,須覆蓋一隻檔案才能開啟

 


將包裡的 nslicense.dll 覆蓋至預設路徑 C:\Program Files (x86)\NetSarang\Xshell 7

 


關閉自動檢查更新工具 &gt; 選項 &gt; 更新
將天數改為最大值並取消勾勾


 
 


最後將時間條回來即可

 


查看金鑰已過的狀態

 



]]></content>
      <categories>
        <category>Xshell</category>
      </categories>
      <tags>
        <tag>Xshell</tag>
      </tags>
  </entry>
  <entry>
    <title>XenServer - 透過虛擬機做 NFS-Server &amp; 製作 xencenter 映像檔</title>
    <url>/blog.github.io/2022/08/12/XEN-%E9%80%8F%E9%81%8E%E8%99%9B%E6%93%AC%E6%A9%9F%E5%81%9ANFS-Server/</url>
    <content><![CDATA[

建立 nfs-server

安裝 nfs 依賴
yum -y install nfs-utils nfs-utils-lib



建立要做 nfs-server 的目錄,並給予權限
mkdir -p /data2/nfschmod 777 /data2/nfs



允許 172.16.0.0/16 網段的機器掛載 /data2/nfs
echo ‘data2/nfs 172.16.0.0/24(rw,sync,no_root_squash,no_all_squash)’ &gt;&gt; /etc/exportsservice nfs start



製作 174 的 xva 映像檔

使用 XenServer–170 匯出 174 的 xva映像檔
mkdir -p /data2/exportmount -t nfs 172.16.0.222:/data2/nfs /data2/export    xe vm-list name-label=174	(查看174的uuid)    xe vm-export filename=/data2/export/174.xva vm=8fa16dde-c06d-726c-56da-c0fe47cf3d06	(使用174的uuid 製作映像檔)



將 xva映像檔 匯入 新建的機器 XenServer–180
mkdir -p /data2/exportmount -t nfs 172.16.0.222:/data2/nfs /data2/export    xe vm-import filename=/data2/export/174.xva



匯入完成之後在 XenServer–180 底下會自動生成該 instance



]]></content>
      <categories>
        <category>XenCenter</category>
      </categories>
      <tags>
        <tag>XenCenter</tag>
      </tags>
  </entry>
  <entry>
    <title>Xshell 7 - 匯出及匯入</title>
    <url>/blog.github.io/2023/03/20/Xshell_7-%E5%8C%AF%E5%87%BA%E5%8F%8A%E5%8C%AF%E5%85%A5/</url>
    <content><![CDATA[

Xshell 7-匯出及匯入

將 工作階段 匯出成 xxx.xts




開啟 全新的 Xshell 將 .xts 匯入





]]></content>
      <categories>
        <category>Xshell</category>
      </categories>
      <tags>
        <tag>Xshell</tag>
      </tags>
  </entry>
  <entry>
    <title>Shell-Script - 偵測 mysql 服務是否正常運作</title>
    <url>/blog.github.io/2022/08/03/shell-script-%E5%81%B5%E6%B8%ACmysql%E6%9C%8D%E5%8B%99%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8%E9%81%8B%E4%BD%9C/</url>
    <content><![CDATA[

#!/bin/bashstep=2    #間隔的秒數TOKEN=&quot;XXX&quot; #LINE TOKENMESSAGE1=&quot;Mysql Connection Failed!! TCP:3306 offline.&quot;MESSAGE2=&quot;Mysql Connection Failed!! TCP:3307 offline.&quot;for (( i=0;i&lt;60;i=(i+step) )); do        echo &quot;quit&quot; | telnet 127.0.0.1 3306 | grep &quot;Escape character is&quot;        code1=&quot;$?&quot;        echo &quot;quit&quot; | telnet 127.0.0.1 3307 | grep &quot;Escape character is&quot;        code2=&quot;$?&quot;                if [ &quot;$code1&quot; -ne 0 ]; then                        echo &quot;`date +%H:%M:%S` - TCP:3306 offline.&quot; &gt;&gt; /root/line/mysql/mysql-error.txt                        curl -X POST https://notify-api.line.me/api/notify -H &quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; -d &quot;message=$&#123;MESSAGE1&#125;&quot;                                        elif [ &quot;$code2&quot; -ne 0 ]; then                        echo &quot;`date +%H:%M:%S` - TCP:3307 offline.&quot; &gt;&gt; /root/line/mysql/mysql-error.txt                        curl -X POST https://notify-api.line.me/api/notify -H &quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; -d &quot;message=$&#123;MESSAGE2&#125;&quot;                fi                      sleep $step    done         exit 0                           




]]></content>
      <categories>
        <category>Shell-Script</category>
      </categories>
      <tags>
        <tag>Shell-Script</tag>
      </tags>
  </entry>
  <entry>
    <title>Shell-Script - 偵測 telegraf 服務</title>
    <url>/blog.github.io/2022/08/03/shell-script-%E5%81%B5%E6%B8%ACtelegraf%E6%9C%8D%E5%8B%99/</url>
    <content><![CDATA[

step=2    #間隔的秒數TOKEN=&quot;XXX&quot;message=&quot;%0D%0A TEST-222 Telegraf offline&quot;l_process=`ps aux |grep telegraf |grep -v &#x27;grep&#x27;|awk &#x27;&#123;print $2&#125;&#x27;`curl -i -XPOST &#x27;http://localhost:8086/query?db=telegraf&#x27;   --data-urlencode &quot;q=drop series  FROM &quot;live&quot;  where &quot;host&quot;=&#x27;222&#x27; &quot;for (( i=0; i &lt; 60; i=(i+step) )); do        if [ ! -n &quot;$l_process&quot; ]; then            curl -i -XPOST &#x27;http://localhost:8086/write?db=telegraf&#x27;   --data-binary &#x27;live,host=222 value=0&#x27;            curl https://notify-api.line.me/api/notify -H &quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; -d &quot;message=$&#123;message&#125;&quot;        else            curl -i -XPOST &#x27;http://localhost:8086/write?db=telegraf&#x27;   --data-binary &#x27;live,host=222 value=1&#x27;        fi    sleep $stepdoneexit 0




]]></content>
      <categories>
        <category>Shell-Script</category>
      </categories>
      <tags>
        <tag>Shell-Script</tag>
      </tags>
  </entry>
  <entry>
    <title>Shell-Script - 建立 SVN-CO 排程並 sync 至雲端</title>
    <url>/blog.github.io/2022/10/03/shell-script-%E5%BB%BA%E7%AB%8BSVN-CO%E6%8E%92%E7%A8%8B/</url>
    <content><![CDATA[

#!/bin/bashSendLine()&#123;        LineToken=&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;        logdate=`date +%Y-%m-%d`        datee=`date +%Y/%m/%d-%H:%M:%S`	sourced=&quot;source &gt;&gt; Laurance-222&quot;	purposed=&quot;purpose &gt;&gt; hateformis&quot;	message=&quot;SVN-DUMP上傳成功&quot;	curl https://notify-api.line.me/api/notify -H &quot;Authorization: Bearer $&#123;LineToken&#125;&quot; -d &quot;message=%0D%0A$&#123;sourced&#125;%0D%0Ai$&#123;purposed&#125;%0D%0A$&#123;datee&#125;%0D%0A$&#123;message&#125;&quot; -d &quot;stickerPackageId=8525&quot; -d &quot;stickerId=16581290&quot;&#125;SDIR=/home/svn/blogtocloudNOWDATEE=`date +%Y-%m-%d`NOWTIME=`date +%Y/%m/%d-%H:%M:%S`PROJECT=nowblog-$NOWDATEESDIR2=$SDIR/nowblog-$NOWDATEEPROJECT2=public-$NOWDATEELOGFILE=$SDIR/cloud-svn.logPATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/binexport PATHdo_rclone()&#123;	rclone purge google-drive:$PROJECT	rclone mkdir google-drive:$PROJECT	rclone sync $SDIR/$PROJECT google-drive:$PROJECT	sleep 80	if [ $? -eq 0 ];then	    	    echo &quot; &quot; &gt;&gt; $LOGFILE	    echo &quot; &quot; &gt;&gt; $LOGFILE	    echo &quot;###########################&quot; &gt;&gt; $LOGFILE	    echo &quot;$PROJECT在$&#123;NOWTIME&#125;上傳成功&quot; &gt;&gt; $LOGFILE	else	    echo &quot; &quot; &gt;&gt; $LOGFILE            echo &quot; &quot; &gt;&gt; $LOGFILE            echo &quot;###########################&quot; &gt;&gt; $LOGFILE	    echo &quot;$PROJECT在$&#123;NOWTIME&#125;上傳失敗&quot; &gt;&gt; $LOGFILE	fi	rclone purge google-drive:$PROJECT2	rclone mkdir google-drive:$PROJECT2	rclone sync $SDIR2/$PROJECT2 google-drive:$PROJECT2	sleep 80	if [ $? -eq 0 ];then                        echo &quot; &quot; &gt;&gt; $LOGFILE            echo &quot; &quot; &gt;&gt; $LOGFILE            echo &quot;###########################&quot; &gt;&gt; $LOGFILE            echo &quot;$PROJECT2在$&#123;NOWTIME&#125;上傳成功&quot; &gt;&gt; $LOGFILE        else            echo &quot; &quot; &gt;&gt; $LOGFILE            echo &quot; &quot; &gt;&gt; $LOGFILE            echo &quot;###########################&quot; &gt;&gt; $LOGFILE            echo &quot;$PROJECT2在$&#123;NOWTIME&#125;上傳失敗&quot; &gt;&gt; $LOGFILE        fi&#125;do_rclonesleep 10SendLine

]]></content>
      <categories>
        <category>Shell-Script</category>
      </categories>
      <tags>
        <tag>Shell-Script</tag>
      </tags>
  </entry>
  <entry>
    <title>Shell-Script - 新增使用者</title>
    <url>/blog.github.io/2022/08/03/shell-script-%E5%BB%BA%E7%AB%8B%E6%96%B0%E5%A2%9E%E4%BD%BF%E7%94%A8%E8%80%85/</url>
    <content><![CDATA[

#!/bin/bash        while [ &quot;i&quot; != &quot;1&quot; ]    do    echo -n new user name:        read name        useradd $name        echo &quot;123456&quot; | passwd --stdin $name        echo finish new user name is:$name    done            sed -i &quot;s/GSSAPIAuthentication yes/GSSAPIAuthentication no/g&quot; /etc/ssh/sshd_config    sed -i &quot;s/#UseDNS yes/UseDNS no/g&quot; /etc/ssh/sshd_config    service sshd restart



]]></content>
      <categories>
        <category>Shell-Script</category>
      </categories>
      <tags>
        <tag>Shell-Script</tag>
      </tags>
  </entry>
  <entry>
    <title>Shell-Script - 抓 youtube 影片腳本</title>
    <url>/blog.github.io/2022/08/03/shell-script-%E6%8A%93youtube%E5%BD%B1%E7%89%87%E8%85%B3%E6%9C%AC/</url>
    <content><![CDATA[抓影片腳本 (youtube,pornhhub ……)#!/bin/bash#date=`date +%Y%m%d`binpath=&quot;/usr/bin&quot;savedpath=&quot;/home/videorecord&quot;youtubedl=&quot;$binpath/python $savedpath/youtube_dl/__main__.py&quot;while [ &quot;$anser&quot; != &quot;y&quot; -a &quot;$anser&quot; != &quot;Y&quot; ]do	while :	do		while :        do			while :			do				while :				do					echo &quot; &quot;    					read -p &quot;請輸入要下載或裁切影片的日期   ex:20230226: &quot; datee					echo $datee | egrep -q &#x27;^[[:digit:]]&#123;8&#125;$&#x27;					if [ &quot;$?&quot;:= &quot;0&quot; ]; then						break					else						echo &quot; &quot;						echo &quot;日期輸入錯誤 please try again...&quot;						echo &quot; &quot;					fi				done				if [ ! -f &quot;$&#123;datee&#125;NSV.mp4&quot; ]; then					echo &quot; &quot;					read -p &quot;請輸入要下載影片的 &quot;m3u8&quot; : &quot; m3u8					echo &quot; &quot;					$youtubedl -F $m3u8					if [ &quot;$?&quot; != &quot;0&quot; ];then						exit					fi					echo &quot; &quot;					read -p &quot;請輸入要下載影片的 format code : &quot; formatcode					echo &quot; &quot;					$youtubedl $m3u8 -f $formatcode -o $savedpath/$&#123;datee&#125;NSV.mp4					code3=&quot;$?&quot;				else					code3=&quot;666&quot;					echo &quot; &quot;					echo &quot;$&#123;datee&#125;NSV.mp4 已存在 , 準備裁切影片&quot;				fi			break			done			case $code3 in				&quot;0&quot;)					break					;;				&quot;666&quot;)					break					;;			*)				exit 1					;;			esac			done				echo &quot; &quot;                	read -p &quot;請輸入開始裁切時間   ex:00:00:00 : &quot; starting        	read -p &quot;請輸入結束裁切時間   ex:00:00:00 : &quot; ending        	echo $starting | egrep -q &#x27;^[[:digit:]]&#123;2&#125;\:[[:digit:]]&#123;2&#125;\:[[:digit:]]&#123;2&#125;$&#x27;        	code1=&quot;$?&quot;        	echo $ending | egrep -q &#x27;^[[:digit:]]&#123;2&#125;\:[[:digit:]]&#123;2&#125;\:[[:digit:]]&#123;2&#125;$&#x27;        	code2=&quot;$?&quot;#		echo &quot;$code1&quot;#		echo &quot;$code2&quot;        	if [ &quot;$code1&quot; -a &quot;$code2&quot;:= &quot;0&quot; ]; then			break        	else                	echo &quot; &quot;                	echo &quot;時間格式輸入錯誤 please try again...&quot;			continue        	fi        done	echo &quot; &quot;        echo &quot;===========================================&quot;        echo &quot;     請確認開始裁切時間為:   $starting&quot;        echo &quot;     請確認結束裁切時間為:   $ending&quot;        echo &quot;===========================================&quot;        echo &quot; &quot;        read -p &quot;are you sure [y or n] :&quot; anserdoneendd=$(date -d &quot;$ending&quot; +%s)startt=$(date -d &quot;$starting&quot; +%s)second=$(($endd-$startt))if [ &quot;$second&quot; -gt &quot;0&quot; ]; then	$binpath/ffmpeg -i $savedpath/$&#123;datee&#125;NSV.mp4 -ss $starting -t $second -c copy $savedpath/$&#123;datee&#125;TBL.mp4	echo -e &quot; &quot;	echo &quot;======================================================================&quot;	echo -e &quot; &quot;	echo -e &quot;請確認影片是否上傳: &quot;	echo -e &quot; &quot;	echo -e &quot;$VIDEOURL/$dateeTBL.mp4&quot;	echo -e &quot; &quot;	echo &quot;======================================================================&quot;	echo -e &quot; &quot;else	echo &quot; &quot;	echo &quot;錄製時間輸入錯誤 please try again...&quot;	echo &quot; &quot;	fi




]]></content>
      <categories>
        <category>Shell-Script</category>
      </categories>
      <tags>
        <tag>Shell-Script</tag>
      </tags>
  </entry>
  <entry>
    <title>testtest</title>
    <url>/blog.github.io/2024/09/17/testtest/</url>
    <content><![CDATA[😯😯😯😯😯😯😯😯😯😯😯😯😯😯  
😎😎😎😎😎😎😎😎😎😎😎😎😎😎  
😍😍😍😍😍😍😍😍😍😍😍😍😍😍  

]]></content>
  </entry>
  <entry>
    <title>Shell-Script - 計算時間差小工具</title>
    <url>/blog.github.io/2023/10/03/shell-script-%E8%A8%88%E7%AE%97%E6%99%82%E9%96%93%E5%B7%AE%E5%B0%8F%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[



#!/bin/bashlinee=&quot;--------------------------------------&gt;&gt;&gt;&quot;clearecho -e &quot;\n&quot;echo -e &quot;+---------------------------------------+&quot;echo -e &quot;|\e[34;1m  計算時間小工具   (請輸入日期或時間)  \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[33;1m    Start Time 必須小於  Finish Time   \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[35;1m        此小工具為 24 小時制           \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[35;1m        請勿輸入超過 24 小時           \e[0m|&quot;echo -e &quot;+---------------------------------------+&quot;echo -e &quot;\n&quot;echo -e &quot;$linee&quot;echo -e &quot;\n&quot;echo -e &quot;\e[32;1mStart Time  請輸入開始日期或時間 \e[0m&quot;echo -e &quot;\n&quot;echo -e &quot;\e[34;1mex:20230731 或 1615\e[0m \e[35;1m(不接受 2400) \e[0m&quot;echo -e &quot;\n&quot;echo -ne &quot;answer \e[32;5m:  \e[0m&quot;read -e starticlearecho -e &quot;\n&quot;echo -e &quot;+---------------------------------------+&quot;echo -e &quot;|\e[34;1m  計算時間小工具   (請輸入日期或時間)  \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[33;1m    Start Time 必須小於  Finish Time   \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[35;1m        此小工具為 24 小時制           \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[35;1m        請勿輸入超過 24 小時           \e[0m|&quot;echo -e &quot;+---------------------------------------+&quot;echo -e &quot;\n&quot;echo -e &quot;$linee&quot;echo -e &quot;\n&quot;echo -e &quot;\e[32;1mFinish Time  請輸入結束日期或時間 \e[0m&quot;echo -e &quot;\n&quot;echo -e &quot;\e[34;1mex:20230804 或 1920\e[0m \e[35;1m(不接受 2400)\e[0m&quot;echo -e &quot;\n&quot;echo -ne &quot;answer \e[32;5m:  \e[0m&quot;read -e finishiclearsleep 0.5echo -e &quot;\n&quot;echo -e &quot;+---------------------------------------+&quot;echo -e &quot;|\e[34;1m  計算時間小工具   (請輸入日期或時間)  \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[33;1m    Start Time 必須小於  Finish Time   \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[35;1m        此小工具為 24 小時制           \e[0m|&quot;echo -e &quot;|                                       |&quot;echo -e &quot;|\e[35;1m        請勿輸入超過 24 小時           \e[0m|&quot;echo -e &quot;+---------------------------------------+&quot;echo -e &quot;\n&quot;echo -e &quot;$linee&quot;echo -e &quot;\n&quot;case &quot;$&#123;starti&#125;&quot; in	[0-9][0-9][0-9][0-9][0][1-9][0-2][0-9])		startii=`date -d &quot;$&#123;starti&#125;&quot; &#x27;+%s&#x27;`		echo -e &quot;開始時間為     : \e[34;1m `date -d @$&#123;startii&#125; &#x27;+%Y-%m-%d&#x27;`\e[0m&quot;;;	[0-9][0-9][0-9][0-9][0][1-9][3][0-1])                startii=`date -d &quot;$&#123;starti&#125;&quot; &#x27;+%s&#x27;`                echo -e &quot;開始時間為     : \e[34;1m `date -d @$&#123;startii&#125; &#x27;+%Y-%m-%d&#x27;`\e[0m&quot;;;	[0-9][0-9][0-9][0-9][1][0-2][0-2][0-9])                startii=`date -d &quot;$&#123;starti&#125;&quot; &#x27;+%s&#x27;`                echo -e &quot;開始時間為     : \e[34;1m `date -d @$&#123;startii&#125; &#x27;+%Y-%m-%d&#x27;`\e[0m&quot;;;	[0-9][0-9][0-9][0-9][1][0-2][3][0-1])		startii=`date -d &quot;$&#123;starti&#125;&quot; &#x27;+%s&#x27;`		echo -e &quot;開始時間為     : \e[34;1m `date -d @$&#123;startii&#125; &#x27;+%Y-%m-%d&#x27;`\e[0m&quot;;;	[2][0-3][0-5][0-9])		startii=`date -d &quot;$&#123;starti&#125;&quot; &#x27;+%s&#x27;`		echo -e &quot;開始時間為     : \e[34;1m `date -d @$&#123;startii&#125; &#x27;+%H:%M&#x27;`\e[0m&quot;;;	[0-1][0-9][0-5][0-9])		startii=`date -d &quot;$&#123;starti&#125;&quot; &#x27;+%s&#x27;`		echo -e &quot;開始時間為     : \e[34;1m `date -d @$&#123;startii&#125; &#x27;+%H:%M&#x27;`\e[0m&quot;;;	*)		clear		echo -e &quot;\n&quot;		echo -e &quot;$linee&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[31;1m你輸入的開始時間為 \e[33;1m $&#123;starti&#125; \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[35;1m輸入錯誤 ERROR \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[32;1m月欄位不可大於 \e[34;1m     12 \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[32;1m日欄位不可大於 \e[34;1m     30 \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[32;1m小時欄位不可大於 \e[34;1m   24 \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[32;1m分鐘欄位不可大於 \e[34;1m   59 \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;$linee&quot;		echo -e &quot;\n&quot;		exit 1;;esacecho -e &quot;\n&quot;case &quot;$&#123;finishi&#125;&quot; in	[0-9][0-9][0-9][0-9][0][1-9][0-2][0-9])		finishii=`date -d &quot;$&#123;finishi&#125;&quot; &#x27;+%s&#x27;`		echo -e &quot;結束時間為     : \e[34;1m `date -d @$&#123;finishii&#125; &#x27;+%Y-%m-%d&#x27;`\e[0m&quot;;;        [0-9][0-9][0-9][0-9][0][1-9][3][0-1])                finishii=`date -d &quot;$&#123;finishi&#125;&quot; &#x27;+%s&#x27;`                echo -e &quot;結束時間為     : \e[34;1m `date -d @$&#123;finishii&#125; &#x27;+%Y-%m-%d&#x27;`\e[0m&quot;;;	[0-9][0-9][0-9][0-9][1][0-2][0-2][0-9])                finishii=`date -d &quot;$&#123;finishi&#125;&quot; &#x27;+%s&#x27;`                echo -e &quot;結束時間為     : \e[34;1m `date -d @$&#123;finishii&#125; &#x27;+%Y-%m-%d&#x27;`\e[0m&quot;;;	[0-9][0-9][0-9][0-9][1][0-2][3][0-1])		finishii=`date -d &quot;$&#123;finishi&#125;&quot; &#x27;+%s&#x27;`		echo -e &quot;開始時間為     : \e[34;1m `date -d @$&#123;finishii&#125; &#x27;+%Y-%m-%d&#x27;`\e[0m&quot;;;	[2][0-3][0-5][0-9])		finishii=`date -d &quot;$&#123;finishi&#125;&quot; &#x27;+%s&#x27;`		echo -e &quot;結束時間為     : \e[34;1m `date -d @$&#123;finishii&#125; &#x27;+%H:%M&#x27;`\e[0m&quot;;;	[0-1][0-9][0-5][0-9])		finishii=`date -d &quot;$&#123;finishi&#125;&quot; &#x27;+%s&#x27;`		echo -e &quot;結束時間為     : \e[34;1m `date -d @$&#123;finishii&#125; &#x27;+%H:%M&#x27;`\e[0m&quot;;;	*)		clear		echo -e &quot;\n&quot;		echo -e &quot;$linee&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[31;1m你輸入的開始時間為 \e[33;1m $&#123;starti&#125;  \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[31;1m你輸入的結束時間為 \e[33;1m $&#123;finishi&#125; \e[0m&quot;		echo -e &quot;\n&quot;                echo -e &quot;\e[35;1m輸入錯誤 ERROR \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[32;1m月欄位不可大於 \e[34;1m     12 \e[0m&quot;                echo -e &quot;\n&quot;		echo -e &quot;\e[32;1m日欄位不可大於 \e[34;1m     30 \e[0m&quot;		echo -e &quot;\n&quot;		echo -e &quot;\e[32;1m小時欄位不可大於 \e[34;1m   24 \e[0m&quot;                echo -e &quot;\n&quot;		echo -e &quot;\e[32;1m分鐘欄位不可大於 \e[34;1m   59 \e[0m&quot;                echo -e &quot;\n&quot;		echo -e &quot;$linee&quot;		echo -e &quot;\n&quot;                exit 1;;esacecho -e &quot;\n&quot;echo -e &quot;$linee&quot;time1=$(($(date -d &quot;$finishi&quot; +%s)-$(date -d &quot;$starti&quot; +%s)));if [ $(echo &quot;0 &lt; $time1&quot; | bc): 0 ]then        echo -e &quot;\n&quot;        echo -e &quot;\e[35;5mERROR !!! ERROR !!! ERROR !!!\e[0m&quot;        echo -e &quot;\n&quot;        echo -e &quot;\e[35;1m開始時間必須小於結束時間 !!! \e[0m&quot;        echo -e &quot;\n&quot;        echo -e &quot;$linee&quot;        echo -e &quot;\n&quot;        exit 1else        echo -e &quot;\n&quot;        echo -e &quot;兩者相差秒數為 : \e[31;1m $time1 秒\e[0m&quot;fi#time2=$(($time1 / 60));time2=`echo -e &quot;scale=0; $time1/60&quot;| bc`echo -e &quot;\n&quot;echo -e &quot;兩者相差分鐘為 : \e[31;1m $time2 分\e[0m&quot;#time3=$(($time1 / 60 / 60));time3=`echo -e &quot;scale=2; $time2/60&quot;| bc`if [ `echo -e &quot;$&#123;time3&#125;&quot;|egrep &quot;.00&quot;|wc -l`:= &quot;1&quot; ]then	time31=`echo -e &quot;$&#123;time3&#125;&quot;|sed &quot;s/.00//g&quot;`	echo -e &quot;\n&quot;	echo -e &quot;兩者相差小時為 : \e[31;1m $time31 時\e[0m&quot;else	echo -e &quot;\n&quot;	echo -e &quot;兩者相差小時為 : \e[31;1m $time3 時\e[0m&quot;fi#time4=$(($time1 / 60 / 60 / 24));time4=`echo -e &quot;scale=2; $time3/24&quot;| bc`if [ $(echo &quot;1 &lt; $time4&quot; | bc): 0 ]then        echo -e &quot;\n&quot;        echo -e &quot;兩者相差天數為 : \e[31;1m 0$time4 天\e[0m&quot;else	if [ `echo -e &quot;$&#123;time4&#125;&quot;|egrep &quot;.00&quot;|wc -l`:= &quot;1&quot; ]	then		time41=`echo -e &quot;$&#123;time4&#125;&quot;|sed &quot;s/.00//g&quot;`		echo -e &quot;\n&quot;		echo -e &quot;兩者相差天數為 : \e[31;1m $time41 天\e[0m&quot;	else		echo -e &quot;\n&quot;		echo -e &quot;兩者相差天數為 : \e[31;1m $time4 天\e[0m&quot;	fifiecho -e &quot;\n&quot;echo -e &quot;$linee&quot;echo -e &quot;\n&quot;




]]></content>
      <categories>
        <category>Shell-Script</category>
      </categories>
      <tags>
        <tag>Shell-Script</tag>
      </tags>
  </entry>
  <entry>
    <title>如何安裝 Python3.10 及 openssl-1.1.1q - on CentOS7</title>
    <url>/blog.github.io/2023/06/05/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%9DPython3_10%E5%8F%8Aopenssl-1_1_1q-CentOS7/</url>
    <content><![CDATA[

移除舊版本的 python 及 onpenssl
whereis python3 | xargs rm -frvwhereis openssl | xargs rm -frv



安裝依賴
yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gcc make python3-devel libevent-devel libffi-devel yum install perl-ExtUtils-CBuilder perl-ExtUtils-MakeMaker perl-CPAN perl-IPC-Cmd



安裝 openssl-1.1.1q
wget https://www.openssl.org/source/openssl-1.1.1q.tar.gztar zxvf openssl-1.1.1q.tar.gz cd openssl-1.1.1q/./config --prefix=/usr/local/openssl --openssldir=/usr/local/openssl shared zlibmakemake install



將 openssl lib 路徑寫入動態庫
echo &quot;/usr/local/openssl/lib&quot; &gt;&gt; /etc/ld.so.confldconfig -v



建立 link &amp;&amp; 查看版本
ln -s /usr/local/openssl/bin/openssl /usr/bin/opensslopenssl version



安裝 Python-3.10
wget https://www.python.org/ftp/python/3.10.5/Python-3.10.5.tgztar zxvf Python-3.10.5.tgzcd Python-3.10.5/./configure --prefix=/usr/local/python3 --with-openssl=/usr/local/openssl --with-openssl-rpath=auto --enable-optimizationsmake &amp;&amp; make install



建立 pyhon 、 pip link
ln -s /usr/local/python3/bin/pip3.10 /usr/bin/pip3 ln -s /usr/local/python3/bin/python3.10 /usr/bin/python3ln -s /usr/local/python3/bin/python3.10 /usr/local/bin/python3



將路徑寫入環境變數
echo &#x27;export PATH=/usr/local/python3/bin:$PATH&#x27; &gt;&gt; ~/.bashrcsource ~/.bashrc

查看 pip python 版本 &amp;&amp; 更新 pip
python3 -Vpip3 -Vpip -Vpython3 -m pip install --upgrade pip




]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Shell-Script - Linux 清除內部解析暫存</title>
    <url>/blog.github.io/2022/08/03/shell-script-%E6%B8%85%E9%99%A4%E5%85%A7%E9%83%A8%E8%A7%A3%E6%9E%90%E6%9A%AB%E5%AD%98/</url>
    <content><![CDATA[

  #!/bin/bash    rndc flush    service named restart    rndc flush




]]></content>
      <categories>
        <category>Shell-Script</category>
      </categories>
      <tags>
        <tag>Shell-Script</tag>
      </tags>
  </entry>
  <entry>
    <title>日常 - 更換插座紀錄</title>
    <url>/blog.github.io/2022/11/14/%E5%B0%8F%E7%99%BD_%E6%9B%B4%E6%8F%9B%E6%8F%92%E5%BA%A7%E7%B4%80%E9%8C%84/</url>
    <content><![CDATA[

步驟1. 斷電 (記得要將插座電閘與漏電電閘斷掉) ps. 插座電閘在下面,沒拍到


   


將插座面板拆下,圖為面板背面 (拆下需將一字起插進橫向插孔再將線拔出即可)


   


將舊的面板拆下後,換上新面板 (記得一定不要插錯位置,不然短路後果會很嚴重 !!!!!)


   


4. 一定確定沒插錯後,再將面板鎖回去,將插座電閘與漏電電閘打開


   


5. 插座面板: 短的帶電 (火線) 長的不帶電 (中性線)


  



]]></content>
  </entry>
</search>
